---
title: RequestStart Event
description: RequestStart Event
ms.assetid: ecfb9691-cbc4-48f5-8e26-a99389e85eed
ms.topic: article
ms.date: 05/31/2018
---

# RequestStart Event

\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Description**
</dt> <dd>

Occurs when the server begins a queued request.

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

**Sub** *agent***\_RequestStart** **(ByVal** *Request***)**



| Part      | Description                                            |
|-----------|--------------------------------------------------------|
| *Request* | Returns the [**Request**](/windows/desktop/lwef/the-request-object) object. |



 

</dd> </dl>

### Remarks

The event returns a [**Request**](/windows/desktop/lwef/the-request-object) object. Because requests are processed asynchronously, you can use this event to determine when the server begins processing a request (such as a [**Get**](get-method.md), [**Play**](play-method.md), or [**Speak**](speak-method.md) method) and thereby synchronize this with other actions generated by your application. The event is sent only to the client that created the reference to the **Request** object and only if you defined a global variable for the request reference:


```
   Dim MyRequest 
   Dim Genie 

   Sub window_Onload
   
   Agent1.Characters.Load "Genie", _
      "https://agent.microsoft.com/characters/v2/genie/genie.acf"   

   Set Genie = Agent1.Characters("Genie")

   ' This syntax will generate RequestStart and RequestComplete events.
   Set MyRequest = Genie.Get("state", "Showing")

   ' This syntax will not generate RequestStart and RequestComplete events.
   Genie.Get ("state", "Hiding")

   End Sub

   Sub Agent1_RequestStart(ByVal Request)

   If Request = MyRequest Then
      Status = "Loading the Showing animation"

   End Sub
```



The [**Status**](status-property.md) returns 4 (request in progress) for the [**Request**](/windows/desktop/lwef/the-request-object) object returned.

Because animation [**Request**](/windows/desktop/lwef/the-request-object) objects don't get assigned until the server processes the request, make sure that the **Request** object exists before you attempt to evaluate it. For example, in Visual Basic, if you use a conditional to test whether a specific request was completed, you can use the **Nothing** keyword:


```
   Sub Agent1_RequestStart (ByVal Request)

   If Not (MyRequest Is Nothing) Then
      If Request = MyRequest Then
      '-- Do whatever
      End If
   End If

   End Sub
```



> [!Note]  
> In VBScript 1.0, this event fires even if you don't define references to a [**Request**](/windows/desktop/lwef/the-request-object) object. This has been fixed in VBScript 2.0.

 

### See Also

[**RequestComplete event**](requestcomplete-event.md)


 

 
