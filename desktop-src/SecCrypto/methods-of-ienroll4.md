---
description: The following methods are defined by the IEnroll4 interface or are methods the IEnroll4 interface inherits from IEnroll and IEnroll2.
ms.assetid: e4107c7b-3ec6-4a4b-bf18-13a082221f67
title: Methods of IEnroll4
ms.topic: article
ms.date: 05/31/2018
---

# Methods of IEnroll4

The following methods are defined by the [**IEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-ienroll4) interface or are methods the **IEnroll4** interface inherits from [**IEnroll**](/windows/desktop/api/Xenroll/nn-xenroll-ienroll) and [**IEnroll2**](/windows/desktop/api/Xenroll/nn-xenroll-ienroll2). The property access methods are not shown here. To see the properties for **IEnroll4**, see [Properties of IEnroll4](properties-of-ienroll4.md).



| Method                                                                                                | Description                                                                                                                                                                                                                                                                                           |
|-------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**acceptFilePKCS7WStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr)                                           | Accepts and processes a PKCS \#7 message containing a certificate, then stores the message to a file.                                                                                                                                                                                                 |
| [**acceptFileResponseWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr)                                     | Accepts delivery of the credentials issued in response to an earlier call to [**createFileRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createfilerequestwstr) and places the credentials in the appropriate store.                                                                                                     |
| [**acceptPKCS7Blob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-acceptpkcs7blob)                                                   | Accepts and processes a PKCS \#7 message containing a certificate. The PKCS \#7 is input as a parameter.                                                                                                                                                                                              |
| [**acceptResponseBlob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-acceptresponseblob)                                             | Accepts delivery of the credentials issued in response to an earlier call to [**IEnroll4::createRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createrequestwstr) and places the credentials in the appropriate store.                                                                                                   |
| [**addAttributeToRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-addattributetorequestwstr)                               | Adds an attribute to the certificate request.                                                                                                                                                                                                                                                         |
| [**AddAuthenticatedAttributesToPKCS7Request**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-addauthenticatedattributestopkcs7request) | Adds authenticated attributes to a PKCS \#7 certificate request.                                                                                                                                                                                                                                      |
| [**addBlobPropertyToCertificateWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr)                 | Adds a BLOB property to a certificate.                                                                                                                                                                                                                                                                |
| [**AddCertTypeToRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr)                                 | Adds a certificate template to a request (used to support the enterprise certification authority (CA)).                                                                                                                                                                                               |
| [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex)                             | Adds a certificate template (or "certificate type") to a request.                                                                                                                                                                                                                                     |
| [**AddExtensionsToRequest**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-addextensionstorequest)                                     | Adds extensions to the certificate request.                                                                                                                                                                                                                                                           |
| [**addExtensionToRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr)                               | Adds an extension to the request.                                                                                                                                                                                                                                                                     |
| [**addNameValuePairToRequestWStr**](/windows/win32/api/xenroll/nf-xenroll-ienroll4-addnamevaluepairtorequestwstr)                       | Adds a name-value string pair to the request.                                                                                                                                                                                                                                                         |
| [**AddNameValuePairToSignatureWStr**](/windows/win32/api/xenroll/nf-xenroll-ienroll-addnamevaluepairtosignaturewstr)                   | Adds the name and value pair of an attribute to the request. It is up to the CA to interpret the meaning of the name-value pair.                                                                                                                                                                      |
| [**binaryBlobToString**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-binaryblobtostring)                                             | Converts a binary data BLOB to a string.                                                                                                                                                                                                                                                              |
| [**createFilePFXWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createfilepfxwstr)                                               | Saves the accepted certificate chain and private key in a file in PFX format.                                                                                                                                                                                                                         |
| [**createFilePKCS10WStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-createfilepkcs10wstr)                                         | Creates a base64-encoded PKCS \#10 certificate request and saves it in a file.                                                                                                                                                                                                                        |
| [**createFileRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createfilerequestwstr)                                       | Creates a PKCS \#10 certificate request, a PKCS \#7 request, or a Full CMC certificate request and stores it in a file.                                                                                                                                                                               |
| [**createPFXWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createpfxwstr)                                                       | Saves the accepted certificate chain and private key in a Personal Information Exchange (PFX) format string. The PFX format is also known as PKCS \#12.                                                                                                                                               |
| [**createPKCS10WStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-createpkcs10wstr)                                                 | Creates a base64-encoded PKCS \#10 certificate request.                                                                                                                                                                                                                                               |
| [**CreatePKCS7RequestFromRequest**](/windows/win32/api/xenroll/nf-xenroll-ienroll-createpkcs7requestfromrequest)                       | Creates a PKCS \#7 request from an existing certificate request.                                                                                                                                                                                                                                      |
| [**createRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-createrequestwstr)                                               | Creates a PKCS \#10, PKCS \#7, or Full CMC format certificate request and stores it in a string.                                                                                                                                                                                                      |
| [**EnumAlgs**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-enumalgs)                                                                 | Retrieves the IDs of cryptographic algorithms in a given algorithm class that are supported by the current CSP.                                                                                                                                                                                       |
| [**enumContainersWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-enumcontainerswstr)                                             | Retrieves the names of the containers for the CSP specified by the [**ProviderNameWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-get_providernamewstr) property.                                                                                                                                                                    |
| [**enumPendingRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-enumpendingrequestwstr)                                     | Enumerates pending certificate requests and retrieves a specified property from each.                                                                                                                                                                                                                 |
| [**enumProvidersWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-enumproviderswstr)                                               | Retrieves the names of the available cryptographic service providers (CSPs) specified by the [**ProviderType**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-get_providertype) property.                                                                                                                                                  |
| [**freeRequestInfoBlob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-freerequestinfoblob)                                           | Deletes a certificate context.                                                                                                                                                                                                                                                                        |
| [**GetAlgNameWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-getalgnamewstr)                                                     | Retrieves the name of a cryptographic algorithm given its ID. The values retrieved by this method depend on the current CSP.                                                                                                                                                                          |
| [**getCAStore**](/windows/win32/api/xenroll/nf-xenroll-ienroll-getcastore)                                                             | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**getCertContextFromFileResponseWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr)             | Retrieves the certificate from a file containing a response from a CA.                                                                                                                                                                                                                                |
| [**getCertContextFromPKCS7**](/windows/win32/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7)                                   | Retrieves the certificate, contained in a PKCS \#7 message, that was issued in response to a PKCS \#10 certificate request.                                                                                                                                                                           |
| [**getCertContextFromResponseBlob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob)                     | Retrieves the certificate from a CA's response.                                                                                                                                                                                                                                                       |
| [**GetKeyLen**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-getkeylen)                                                               | Retrieves the minimum and maximum key lengths for the signature and exchange keys.                                                                                                                                                                                                                    |
| [**GetKeyLenEx**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-getkeylenex)                                                           | Retrieves size information for the signature and exchange keys.                                                                                                                                                                                                                                       |
| [**getMyStore**](/windows/win32/api/xenroll/nf-xenroll-ienroll-getmystore)                                                             | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**GetPrivateKeyArchiveCertificate**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate)                   | Retrieves the certificate used to archive the private key.                                                                                                                                                                                                                                            |
| [**getProviderTypeWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-getprovidertypewstr)                                           | Retrieves the type of the specified CSP.                                                                                                                                                                                                                                                              |
| [**getROOTHStore**](/windows/win32/api/xenroll/nf-xenroll-ienroll-getroothstore)                                                       | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**GetSupportedKeySpec**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-getsupportedkeyspec)                                           | Retrieves information regarding the CSP's support for signature or exchange keys.                                                                                                                                                                                                                     |
| [**InstallPKCS7Blob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-installpkcs7blob)                                                 | Processes a certificate or chain of certificates, placing them into the appropriate certificate stores. This method differs from the [**acceptPKCS7Blob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll-acceptpkcs7blob) method in that [**InstallPKCS7Blob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-installpkcs7blob) does not receive a request certificate. |
| [**InstallPKCS7BlobEx**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-installpkcs7blobex)                                             | Extends [**InstallPKCS7Blob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-installpkcs7blob) by returning the number of certificates actually installed in local stores.                                                                                                                                                             |
| [**removePendingRequestWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-removependingrequestwstr)                                 | Removes a pending request from the client's request store.                                                                                                                                                                                                                                            |
| [**Reset**](/windows/win32/api/xenroll/nf-xenroll-ienroll2-reset)                                                                       | Returns the certificate enrollment control object to its initial state.                                                                                                                                                                                                                               |
| [**resetAttributes**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-resetattributes)                                                   | Removes all attributes from the request.                                                                                                                                                                                                                                                              |
| [**resetExtensions**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-resetextensions)                                                   | Removes all extensions from the request.                                                                                                                                                                                                                                                              |
| [**SetHStoreCA**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-sethstoreca)                                                           | Specifies the handle to use for the CA store.                                                                                                                                                                                                                                                         |
| [**SetHStoreMy**](/windows/win32/api/xenroll/nf-xenroll-ienroll2-sethstoremy)                                                           | Specifies the handle to use for the MY store.                                                                                                                                                                                                                                                         |
| [**SetHStoreRequest**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-sethstorerequest)                                                 | Specifies the handle to use for the request store.                                                                                                                                                                                                                                                    |
| [**SetHStoreROOT**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll2-sethstoreroot)                                                       | Specifies the handle to use for the ROOT store.                                                                                                                                                                                                                                                       |
| [**setPendingRequestInfoWStr**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-setpendingrequestinfowstr)                               | Sets properties for a pending request.                                                                                                                                                                                                                                                                |
| [**SetPrivateKeyArchiveCertificate**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate)                   | Specifies the certificate used to archive the private key.                                                                                                                                                                                                                                            |
| [**SetSignerCertificate**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-setsignercertificate)                                         | Specifies the signer's certificate.                                                                                                                                                                                                                                                                   |
| [**stringToBinaryBlob**](/windows/desktop/api/Xenroll/nf-xenroll-ienroll4-stringtobinaryblob)                                             | Converts a string to a binary data BLOB.                                                                                                                                                                                                                                                              |



 

 

 
