---
description: Suggested alternatives to using CAPICOM in Windows.
ms.assetid: 8f74ff84-6165-46a3-976b-36c7f70546be
title: Alternatives to Using CAPICOM
ms.topic: article
ms.date: 07/15/2024
---

# Alternatives to Using CAPICOM

> [!NOTE]
> CAPICOM is a 32-bit only component that was available in the [Windows SDK](https://developer.microsoft.com/windows/downloads/windows-sdk/) for use in the following operating systems: Windows Server 2008, Windows Vista, Windows XP. Instead, use .NET or .NET Framework to implement security features. For more information, see the alternatives listed below.

> [!IMPORTANT]
> None of the alternatives to CAPICOM offer a solution for scripts; therefore, you must write your own ActiveX control. For more information, see [ActiveX Controls](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa751968(v=vs.85)).

- [Certificate Store Objects](#certificate-store-objects)
- [Digital Signature Objects](#digital-signature-objects)
- [Enveloped Data Objects](#enveloped-data-objects)
- [Data Encryption Objects](#data-encryption-objects)
- [Auxiliary Objects](#auxiliary-objects)

## Certificate Store Objects

We suggest the following alternatives for working with [*certificate stores*](../secgloss/c-gly.md) and the certificates in those stores.

| Object | Alternative |
|--------|-------------|
| [**Certificate**](certificate.md) | The [**Certificate**](certificate.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Certificate2 Class**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**CertificatePolicies**](certificatepolicies.md) | The [**CertificatePolicies**](certificatepolicies.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to retrieve the certificate policies. |
| [**Certificates**](certificates.md) | The [**Certificates**](certificates.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Certificate2Collection Class**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2collection) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**CertificateStatus**](certificatestatus.md) | The [**CertificateStatus**](certificatestatus.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509ChainStatus Structure**](/dotnet/api/system.security.cryptography.x509certificates.x509chainstatus) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**Chain**](chain.md) | The [**Chain**](chain.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Chain Class**](/dotnet/api/system.security.cryptography.x509certificates.x509chain) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**ExtendedProperties**](extendedproperties.md) | The [**ExtendedProperties**](extendedproperties.md) object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API function [**CertGetCertificateContextProperty**](/windows/win32/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty) and obtain the properties. For information about PInvoke, see [Platform Invoke (P/Invoke)](/dotnet/standard/native-interop/pinvoke). The [.NET and CryptoAPI via P/Invoke: Part 1](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5) and [.NET and CryptoAPI via P/Invoke: Part 2](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6) subsections of [Extending .NET Cryptography with CAPICOM and P/Invoke](/previous-versions/ms867087(v=msdn.10)) may also be helpful. |
| [**ExtendedProperty**](extendedproperty.md) | The [**ExtendedProperty**](extendedproperty.md) object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API function [**CertGetCertificateContextProperty**](/windows/win32/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty) and obtain the properties. For information about PInvoke, see [Platform Invoke (P/Invoke)](/dotnet/standard/native-interop/pinvoke). The [.NET and CryptoAPI via P/Invoke: Part 1](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5) and [.NET and CryptoAPI via P/Invoke: Part 2](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6) subsections of [Extending .NET Cryptography with CAPICOM and P/Invoke](/previous-versions/ms867087(v=msdn.10)) may also be helpful. |
| [**Extension**](extension.md) | The [**Extension**](extension.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**Extensions**](extensions.md) | The [**Extensions**](extensions.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509ExtensionCollection Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**PrivateKey**](privatekey.md) | The [**PrivateKey**](privatekey.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Certificate2.PrivateKey Property**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.privatekey) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**PublicKey**](publickey.md) | The [**PublicKey**](publickey.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Certificate2.PublicKey Property**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.publickey) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**Store**](store.md) | The [**Store**](store.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Store Class**](/previous-versions/windows/embedded/hh424027(v=msdn.10)) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**Template**](template.md) | The [**Template**](template.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Template to retrieve the certificate extension template. |

## Digital Signature Objects

We suggest the following alternatives to digitally sign data and to verify digital signatures.

| Object | Alternative |
|--------|-------------|
| [**SignedCode**](signedcode.md) | The [**SignedCode**](signedcode.md) object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API [**SignerSignEx**](signersignex.md), [**SignerTimeStampEx**](signertimestampex.md), and [**WinVerifyTrust**](/windows/win32/api/Wintrust/nf-wintrust-winverifytrust) functions to sign content with an Authenticode digital signature. For information about PInvoke, see [Platform Invoke (P/Invoke)](/dotnet/standard/native-interop/pinvoke). The [.NET and CryptoAPI via P/Invoke: Part 1](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5) and [.NET and CryptoAPI via P/Invoke: Part 2](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6) subsections of [Extending .NET Cryptography with CAPICOM and P/Invoke](/previous-versions/ms867087(v=msdn.10)) may also be helpful. |
| [**SignedData**](signeddata.md) | The [**SignedData**](signeddata.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**SignedCms Class**](/dotnet/api/system.security.cryptography.pkcs.signedcms) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |
| [**Signer**](signer.md) | The [**Signer**](signer.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**CmsSigner Class**](/dotnet/api/system.security.cryptography.pkcs.cmssigner) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |
| [**Signers**](signers.md) | The [**Signers**](signers.md) object is available for use in the operating systems specified in the Requirements section. Instead, use a collection of CmsSigner objects. For more information, see the [**CmsSigner Class**](/dotnet/api/system.security.cryptography.pkcs.cmssigner) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |

## Enveloped Data Objects

We suggest the following alternatives to create enveloped data messages for privacy and to decrypt data in enveloped messages.

| Object | Description |
|--------|-------------|
| [**EnvelopedData**](envelopeddata.md) | The [**EnvelopedData**](envelopeddata.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**EnvelopedCms Class**](/dotnet/api/system.security.cryptography.pkcs.envelopedcms) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |
| [**Recipients**](recipients.md) | The [**Recipients**](recipients.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**CmsRecipientCollection Class**](/dotnet/api/system.security.cryptography.pkcs.cmsrecipientcollection) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |

## Data Encryption Objects

We suggest the following alternatives to encrypt arbitrary data for privacy and to decrypt encrypted data.

| Object | Description |
|--------|-------------|
| [**EncryptedData**](encrypteddata.md) | The [**EncryptedData**](encrypteddata.md) object is available for use in the operating systems specified in the Requirements section. Instead, use Platform Invocation Services (PInvoke) to call the Win32 API functions [**CryptEncryptMessage**](/windows/win32/api/Wincrypt/nf-wincrypt-cryptencryptmessage) and [**CryptDecryptMessage**](/windows/win32/api/Wincrypt/nf-wincrypt-cryptdecryptmessage) to encrypt and decrypt messages. For information about PInvoke, see [Platform Invoke (P/Invoke)](/dotnet/standard/native-interop/pinvoke). The [.NET and CryptoAPI via P/Invoke: Part 1](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5) and [.NET and CryptoAPI via P/Invoke: Part 2](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6) subsections of [Extending .NET Cryptography with CAPICOM and P/Invoke](/previous-versions/ms867087(v=msdn.10)) may also be helpful. |

## Auxiliary Objects

We suggest the following alternatives to change default behaviors of other objects and to manage certificates, certificate stores, and messages.

| Object | Description |
|--------|-------------|
| [**Algorithm**](algorithm.md) | The [**Algorithm**](algorithm.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**AlgorithmIdentifier Class**](/dotnet/api/system.security.cryptography.pkcs.algorithmidentifier) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs) namespace. |
| [**Attribute**](attribute.md) | The [**Attribute**](attribute.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**CryptographicAttributeObject Class**](/dotnet/api/system.security.cryptography.cryptographicattributeobject) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**Attributes**](attributes.md) | The [**Attributes**](attributes.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**CryptographicAttributeObjectCollection Class**](/dotnet/api/system.security.cryptography.cryptographicattributeobjectcollection) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**BasicConstraints**](basicconstraints.md) | The [**BasicConstraints**](basicconstraints.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509BasicConstraintsExtension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509basicconstraintsextension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**EKU**](eku.md) | The [**EKU**](eku.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509EnhancedKeyUsageExtension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**EKUs**](ekus.md) | The [**EKUs**](ekus.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509ExtensionCollection Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**EncodedData**](encodeddata.md) | The [**EncodedData**](encodeddata.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**AsnEncodedData Class**](/dotnet/api/system.security.cryptography.asnencodeddata) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**ExtendedKeyUsage**](extendedkeyusage.md) | The [**ExtendedKeyUsage**](extendedkeyusage.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509EnhancedKeyUsageExtension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**HashedData**](hasheddata.md) | The [**HashedData**](hasheddata.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**HashAlgorithm Class**](/previous-versions/windows/) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**KeyUsage**](keyusage.md) | The [**KeyUsage**](keyusage.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509EnhancedKeyUsageExtension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace. |
| [**NoticeNumbers**](noticenumbers.md) | The [**NoticeNumbers**](noticenumbers.md) object is available for use in the operating systems specified in the Requirements section. For more information, see [**Qualifier**](qualifier.md). |
| [**OID**](oid.md) | The [**OID**](oid.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**Oid Class**](/dotnet/api/system.security.cryptography.oid) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**OIDs**](oids.md) | The [**OIDs**](oids.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**OidCollection Class**](/dotnet/api/system.security.cryptography.oidcollection) in the [**System.Security.Cryptography**](/previous-versions/windows/) namespace. |
| [**PolicyInformation**](policyinformation.md) | The [**PolicyInformation**](policyinformation.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process policy information in the Certificate policies extension. |
| [**Qualifier**](qualifier.md) | The [**Qualifier**](qualifier.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process qualifiers that are part of the policy information in the Certificate Policies extension. |
| [**Qualifiers**](qualifiers.md) | The [**Qualifiers**](qualifiers.md) object is available for use in the operating systems specified in the Requirements section. Instead, use the [**X509Extension Class**](/dotnet/api/system.security.cryptography.x509certificates.x509extension) in the [**System.Security.Cryptography.X509Certificates**](/previous-versions/windows/) namespace by calling the constructor that takes an OID as a parameter, and then use the OID for Certificate Policies to process qualifiers that are part of the policy information in the Certificate Policies extension. |
| [**Settings**](settings.md) | No alternative is available. |
| [**Utilities**](utilities.md) | No alternative is available. |
