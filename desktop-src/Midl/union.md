---
title: union attribute
description: The union keyword appears in functions that relate to discriminated unions.
ms.assetid: 135a6581-e03e-4b90-9fd8-15690820dbd0
keywords:
- union attribute MIDL
topic_type:
- apiref
api_name:
- union
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
---

# union attribute

The **union** keyword appears in functions that relate to discriminated unions.

``` syntax
/* Encapsulated union*/
typedef [[ [type-attribute-list] ]] union [[ struct-name ]] switch (switch-type switch-name) [[ union-name ]] 
{
  C-style-case-list 
  [[ [ field-attribute-list <> ] ]] type-specifier <> declarator-list <>;

        ...
}

/* Non-encapsulated union*/
typedef [switch_type(switch-type) [[ , type-attr-list ]] ] union [[ tag ]] 
{ 
    [ case ( limited-expr-list) ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  [[ [ default ]
  [[ [ field-attribute-list ] ]] type-specifier declarator-list;
  ]]
}
```

## Parameters

<dl> <dt>

*type-attribute-list* 
</dt> <dd>

Specifies zero or more attributes that apply to the union type. Valid type attributes include **\[**[**handle**](handle.md)**\]**, **\[**[**transmit\_as**](transmit-as.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]**, or **\[**[**ptr**](ptr.md)**\]**; and the usage attributes **\[**[**context\_handle**](context-handle.md)**\]** and **\[**[**ignore**](ignore.md)**\]**. Encapsulated unions can also have the **\[**[**ref**](ref.md)**\]** pointer type attribute. Separate multiple attributes with commas.

</dd> <dt>

*struct-name* 
</dt> <dd>

Specifies an optional tag that names the structure generated by the MIDL compiler.

</dd> <dt>

*switch-type* 
</dt> <dd>

Specifies an [**int**](int.md), [**char**](char-idl.md), [**enum**](enum.md) type, or an identifier that resolves to one of these types.

</dd> <dt>

*switch-name* 
</dt> <dd>

Specifies the name of the variable of type *switch-type* that acts as the union discriminant.

</dd> <dt>

*union-name* 
</dt> <dd>

Specifies an optional identifier that names the union in the structure, generated by the MIDL compiler, that contains the union and the discriminant.

</dd> <dt>

*C-style-case-list* 
</dt> <dd>

List of "**case** *const-expr* :"

</dd> <dt>

*limited-expression-list* 
</dt> <dd>

Specifies one or more C-language expressions. The MIDL compiler supports conditional expressions, logical expressions, relational expressions, and arithmetic expressions. MIDL does not allow function invocations in expressions and does not allow increment and decrement operators. Individual expressions in the list should be separated by a comma.

</dd> <dt>

*field-attribute-list* 
</dt> <dd>

Specifies zero or more field attributes that apply to the union member. Valid field attributes include **\[**[**first\_is**](first-is.md)**\]**, **\[**[**last\_is**](last-is.md)**\]**, **\[**[**length\_is**](length-is.md)**\]**, **\[**[**max\_is**](max-is.md)**\]**, **\[**[**size\_is**](size-is.md)**\]**; the usage attributes **\[**[**string**](string.md)**\]**, **\[**[**ignore**](ignore.md)**\]**, and **\[**[**context\_handle**](context-handle.md)**\]**; the pointer attribute **\[**[**unique**](unique.md)**\]** or **\[**[**ptr**](ptr.md)**\]**; and, for members that are nonencapsulated unions, the union attribute **\[**[**switch\_type**](switch-type.md)**\]**. Nonencapsulated unions can also use the **\[**[**ref**](ref.md)**\]** pointer field attribute. Separate multiple field attributes with commas.

</dd> <dt>

*type-specifier* 
</dt> <dd>

Specifies a [base type](midl-base-types.md), [**struct**](struct.md), **union**, [**enum**](enum.md) type, or type identifier. An optional storage specification can precede *type-specifier*.

</dd> <dt>

*declarator-list* 
</dt> <dd>

One or more standard C declarators, such as identifiers, pointer declarators, and array declarators. (Function declarators and bit-field declarations are not allowed in unions that are transmitted in remote procedure calls. Except when you use the MIDL compiler switch [**/osf**](-osf.md), these declarators are allowed in unions that are not transmitted.) Separate multiple declarators with commas.

</dd> <dt>

*tag* 
</dt> <dd>

Specifies an optional tag.

</dd> </dl>

## Remarks

MIDL supports two types of discriminated unions: [encapsulated unions](encapsulated-unions.md) and [nonencapsulated unions](nonencapsulated-unions.md). The encapsulated union is compatible with previous implementations of RPC (NCA version 1). The nonencapsulated union eliminates some of the restrictions of the encapsulated union and provides a more visible discriminant than the encapsulated union.

The encapsulated union is identified by the [**switch**](switch.md) keyword and the absence of other union-related keywords.

The nonencapsulated union, also known as a union, is identified by the presence of the **\[**[**switch\_is**](switch-is.md)**\]** and **\[**[**switch\_type**](switch-type.md)**\]** keywords, which identify the discriminant and its type.

When you use **\[**[**in**](in.md), [**out**](out-idl.md)**\]** unions, be aware that changing the value of the union switch during the call can make the remote call behave differently from a local call. On return, the stubs copy the **\[in**, **out\]** parameter into memory that is already present on the client. When the remote procedure modifies the value of the union switch and consequently changes the data object's size, the stubs can overwrite valid memory with the **\[out\]** value. When the union switch changes the data object from a base type to a pointer type, the stubs can overwrite valid memory when they copy the pointer referent into the memory location indicated by the **\[in\]** value of a base type.

The shape of unions must be identical across platforms to ensure interconnectivity.

## See also

<dl> <dt>

[Encapsulated Unions](encapsulated-unions.md)
</dt> <dt>

[Interface Definition (IDL) File](interface-definition-idl-file.md)
</dt> <dt>

[**in**](in.md)
</dt> <dt>

[Nonencapsulated Unions](nonencapsulated-unions.md)
</dt> <dt>

[**out**](out-idl.md)
</dt> <dt>

[**switch\_is**](switch-is.md)
</dt> <dt>

[**switch\_type**](switch-type.md)
</dt> </dl>

 

 




