---
title: oleautomation attribute
description: MIDL oleautomation attribute and compatibility with Automation.
ms.assetid: 4a1c9a02-d637-4595-87b3-5fe903149357
keywords:
- oleautomation attribute MIDL
topic_type:
- apiref
api_name:
- oleautomation
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
---

# oleautomation attribute

The **oleautomation** attribute indicates that an interface is compatible with Automation.

``` syntax
[ 
    oleautomation, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
    ...
}
```

## Parameters

<dl> <dt>

*string-uuid* 
</dt> <dd>

Specifies a UUID string generated by the Uuidgen utility.

</dd> <dt>

*interface-attribute-list* 
</dt> <dd>

Specifies other attributes that apply to the interface as a whole.

</dd> <dt>

*interface-name* 
</dt> <dd>

Specifies the name of the interface.

</dd> <dt>

*base-interface* 
</dt> <dd>

Specifies the name of an Automation interface from which this derived interface inherits member functions, status codes, and interface attributes. All Automation interfaces are derived from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) or [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).

</dd> </dl>

## Remarks

The parameters and return types specified for the members of an **\[oleautomation\]** interface must be Automation-compatible, as listed in the following table.



| Type                                            | Description                                                                                                                                                                                                   |
|-------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **boolean**                                     | Data item that can have the value VARIANT\_TRUE or VARIANT\_FALSE. The size corresponds to VARIANT\_BOOL.                                                                                                     |
| **unsigned char**                               | 8-bit unsigned data item.                                                                                                                                                                                     |
| **double**                                      | 64-bit IEEE floating-point number.                                                                                                                                                                            |
| **float**                                       | 32-bit IEEE floating-point number.                                                                                                                                                                            |
| **int**                                         | Signed integer, whose size is system dependent. On 32-bit platforms, MIDL treats [**int**](int.md) as a 32-bit signed integer.                                                                               |
| **long**                                        | 32-bit signed integer.                                                                                                                                                                                        |
| **short**                                       | 16-bit signed integer.                                                                                                                                                                                        |
| **BSTR**                                        | Length-prefixed string, as described in the Automation topic [BSTR](/previous-versions/windows/desktop/automat/bstr).                                                                                                    |
| **CURRENCY**                                    | 8-byte, fixed floating-point number.                                                                                                                                                                          |
| **DATE**                                        | 64-bit, floating point fractional number of days since December 30, 1899.                                                                                                                                     |
| **SCODE**                                       | For 16-bit systems–built-in error type that corresponds to VT\_ERROR.                                                                                                                                         |
| **Typedef enum**Â *myenum*                      | Signed integer, whose size is system dependent.                                                                                                                                                               |
| **Interface IDispatch \***                      | Pointer to the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface (VT\_DISPATCH).                                                                                                                |
| **Interface IUnknown \***                       | Pointer to an interface that does not derive from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_UNKNOWN). (Any OLE interface can be represented by its [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface.) |
| **dispinterface**Â *Typename \**                | Pointer to an interface derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_DISPATCH).                                                                                                    |
| **Coclass**Â *Typename \**                      | Pointer to a coclass name (VT\_UNKNOWN).                                                                                                                                                                      |
| **\[oleautomation\] interface**Â  *Typename \** | Pointer to an interface that derives from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).                                                                                                                                      |
| **SAFEARRAY**(*TypeName*)                       | *TypeName* is any of the above types. Array of these types.                                                                                                                                                   |
| **TypeName \***                                 | *TypeName* is any of the above types. Pointer to a type.                                                                                                                                                      |
| **Decimal**                                     | 96-bit unsigned binary integer scaled by a variable power of 10. A decimal data type that provides a size and a scale for a number (as in coordinates).                                                       |



 

A parameter is compatible with Automation if its type is an Automation-compatible type, a pointer to an Automation-compatible type, or a SAFEARRAY of an Automation-compatible type.

A return type is compatible with Automation if its type is an HRESULT, SCODE or [**void**](void.md). However, MIDL requires that interface methods return either HRESULT or SCODE. Returning **void** generates a compiler error.

A member is compatible with Automation if its return type and all its parameters are Automation compatible.

An interface is compatible with Automation if it is derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) or [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), it has the **\[oleautomation\]** attribute, and all of its VTBL entries are Automation compatible. For 32-bit platforms, the calling convention for all methods in the interface must be STDCALL. For 16-bit systems, all methods must have the CDECL calling convention.

Every [**dispinterface**](dispinterface.md) is implicitly Automation-compatible. Therefore you should not use the **\[oleautomation\]** attribute on **dispinterface**.

The **\[oleautomation\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.

### Flags

TYPEFLAG\_FOLEAUTOMATION

## Examples

``` syntax
library Hello
{
    importlib("stdole32.tlb");
    [
        uuid(12345678-1234-1234-1234-123456789ABC),
        helpstring("Application object for the Hello application."),
        oleautomation,
        dual
    ]
    interface IHello : IDispatch
    {
        // Interface definition statements.
    }

    // Other library definition statements.
}
```

## See also

<dl> <dt>

[Interface Definition (IDL) File](interface-definition-idl-file.md)
</dt> <dt>

[Generating a Type Library With MIDL](generating-a-type-library-with-midl-2.md)
</dt> <dt>

[ODL File Example](/previous-versions/windows/desktop/automat/odl-file-example)
</dt> <dt>

[ODL File Syntax](/previous-versions/windows/desktop/automat/odl-file-syntax)
</dt> <dt>

[**/osf**](-osf.md)
</dt> <dt>

[**uuid**](uuid.md)
</dt> </dl>

 

 