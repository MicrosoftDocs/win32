---
description: IRTC::Connect method - The Connect method connects the NPP to the network by using a specified NIC and provides configuration information for the connection.
ms.assetid: d017c2a3-a832-4084-b21b-0cca428c5360
title: IRTC::Connect method (Netmon.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type: 
- APIRef
- kbSyntax
api_name: 
- IRTC.Connect
api_type: 
- COM
api_location: 
- Ndisnpp.dll
- Rmtnpp.dll
---

# IRTC::Connect method

The **Connect** method connects the NPP to the network by using a specified NIC and provides configuration information for the connection.

## Syntax


```C++
HRESULT STDMETHODCALLTYPE Connect(
  [in]  HBLOB  hInputBlob,
  [in]  LPVOID StatusCallbackProc,
  [in]  LPVOID FramesCallbackProc,
  [in]  LPVOID UserContext,
  [out] HBLOB  hErrorBlob
);
```



## Parameters

<dl> <dt>

*hInputBlob* \[in\]
</dt> <dd>

Handle to the BLOB that specifies the NIC that you are connecting to and the configuration information for that connection.

</dd> <dt>

*StatusCallbackProc* \[in\]
</dt> <dd>

Address of the user's status callback function, which receives status updates such as triggers. This parameter can be set to **NULL**.

</dd> <dt>

*FramesCallbackProc* \[in\]
</dt> <dd>

Address of the user's frame callback function, which is used to receive status updates such as triggers. This parameter can be set to **NULL**.

</dd> <dt>

*UserContext* \[in\]
</dt> <dd>

Value passed when the user's status and frame callback function is called. If both callback functions are specified, they must use the same user-context value. The value of this parameter is typically either HWND or a 'this' pointer.

</dd> <dt>

*hErrorBlob* \[out\]
</dt> <dd>

Handle to an error BLOB that contains additional error information. See Remarks at the bottom of this topic for information about what is in the error BLOB.

</dd> </dl>

## Return value

If this method is successful, the return value is NMERR\_SUCCESS.

If the method is unsuccessful, the return value is one of the following error codes (which include those errors returned by the internal **IRTC::Configure** call):



| Return code                                                                                                         | Description                                                                                                                                                                                                                                                                                  |
|---------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**NMERR\_ALREADY\_CONNECTED**</dt> </dl>            | This instance of the NPP COM object is already connected to the network.<br/>                                                                                                                                                                                                          |
| <dl> <dt>**NMERR\_BLOB\_CONVERSION\_ERROR**</dt> </dl>       | The configuration BLOB is corrupt. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                                       |
| <dl> <dt>**NMERR\_BLOB\_ENTRY\_DOES\_NOT\_EXIST**</dt> </dl> | The input BLOB specified by the *hInputBlob* parameter lacks an entry needed to perform this operation. This error may be generated by the **IRTC::Connect** or **IRTC::Configure** call. Look at the error BLOB returned by *hErrorBlob* to determine which entry was not found.<br/> |
| <dl> <dt>**NMERR\_BLOB\_NOT\_INITIALIZED**</dt> </dl>        | The **CreateBlob** function has not been called. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                         |
| <dl> <dt>**NMERR\_BLOB\_STRING\_INVALID**</dt> </dl>         | The string is not null-terminated. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                                       |
| <dl> <dt>**NMERR\_ILLEGAL\_TRIGGER**</dt> </dl>              | The trigger portion of the input BLOB is corrupt. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                        |
| <dl> <dt>**NMERR\_INVALID\_BLOB**</dt> </dl>                 | The object specified in *hInputBlob* is not a BLOB. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                      |
| <dl> <dt>**NMERR\_OUT\_OF\_MEMORY**</dt> </dl>               | The memory needed to perform this operation is unavailable. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                              |
| <dl> <dt>**NMERR\_TIMEOUT**</dt> </dl>                       | The request has timed out. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                                                               |
| <dl> <dt>**NMERR\_UPLEVEL\_BLOB**</dt> </dl>                 | The version number of the BLOB specified in *hInputBlob* is incorrect. This error is generated by the **IRTC::Configure** call.<br/>                                                                                                                                                   |



 

## Remarks

When the **Connect** method is called, the NPP automatically calls the **IRTC::Configure** method by using the BLOB provided by *hInputBlob*. Note that any error codes returned by the call to **IRTC::Configure** are passed back and returned by the **IRTC::Connect** call.

This method must be called before you can start capturing frames. Note that when you connect to the network using this method, you must continue to use the **IRTC** interface to capture frames.

When calling this function, you must specify a status or frame callback function, even if it only acts as a placeholder.

The input BLOB specified by *hInputBlob* can be obtained by calling the **GetNPPBlobFromUI**, **GetNPPBlobTable**, and **SelectNPPBlobFromTable** methods.

The error BLOB returned in *hErrorBlob* contains error information that the developer or the application can use for troubleshooting. The error BLOB returned by *hErrorBlob* contains entries that Network Monitor could not understand or find in the input BLOB specified in *hInputBlob*. For example, if NMERR\_BLOB\_ENTRY\_DOES\_NOT\_EXIST is returned, the entry Network Monitor could not find is included in the returned error BLOB.



| For information about                          | See                                                                          |
|------------------------------------------------|------------------------------------------------------------------------------|
| Obtaining the input BLOB that represents a NIC | [Selecting a Network Interface Card](selecting-a-network-interface-card.md) |



 

## Requirements



| Requirement | Value |
|-------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Minimum supported client<br/> | Windows 2000 Professional \[desktop apps only\]<br/>                                                                                               |
| Minimum supported server<br/> | Windows 2000 Server \[desktop apps only\]<br/>                                                                                                     |
| Header<br/>                   | <dl> <dt>Netmon.h</dt> </dl>                                                                      |
| DLL<br/>                      | <dl> <dt>Ndisnpp.dll; </dt> <dt>Rmtnpp.dll</dt> </dl> |



## See also

<dl> <dt>

[IRTC](irtc.md)
</dt> <dt>

[IRTC::Configure](irtc-configure.md)
</dt> <dt>

[IRTC::Disconnect](irtc-disconnect.md)
</dt> <dt>

[IRTC::Start](irtc-start.md)
</dt> </dl>

 

 




