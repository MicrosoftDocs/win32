---
description: The Global Logger event tracing session records events that occur early in the operating system boot process.
ms.assetid: 1462bbef-ef32-4053-9930-5b4a0ab46b47
title: Configuring and Starting the Global Logger Session
ms.topic: article
ms.date: 05/31/2018
---

# Configuring and Starting the Global Logger Session

The Global Logger event tracing session records events that occur early in the operating system boot process. Applications and device drivers can use the Global Logger session to capture traces before the user logs in. Note that some device drivers, such as disk device drivers, are not loaded at the time the Global Logger session begins.

> [!Note]  
> If you are creating a Global Logger session on Windows Vista, you should consider creating an [AutoLogger session](configuring-and-starting-an-autologger-session.md) instead.

 

You use the registry to configure the Global Logger session. Add the **GlobalLogger** key to the following registry key, if it is not already present:

```
HKEY_LOCAL_MACHINE
   \SYSTEM
      \CurrentControlSet
         \Control
            \WMI
```

The following table describes the values that you can define for the **GlobalLogger** key. You must have administrator privileges to specify these registry values. The registry values affect all providers that log events to the Global Logger session. The **Start** value is the only value required to start the Global Logger session; all other values have default settings that are used if the value is not present in the registry. Typically, you should use the default values. If you specify a value that ETW cannot support, ETW will override the value.




| Value | Type | Description | 
|-------|------|-------------|
| <strong>Start</strong> | <strong>REG_DWORD</strong> | Set this value to 1 (on) to start the Global Logger session the next time the system starts. To stop the session from starting, set this value to 0 (off). <br /> | 
| <strong>BufferSize</strong> | <strong>REG_DWORD</strong> | The size of each buffer, in kilobytes. This value should be less than one megabyte. ETW uses the size of physical memory to calculate this value. <br /> | 
| <strong>ClockType</strong> | <strong>REG_DWORD</strong> | The timer to use when logging the time stamp for each event.<ul><li>1 = Performance counter value (high resolution)</li><li>2 = System timer</li><li>3 = CPU cycle counter</li></ul>For a description of each clock type, see the <strong>ClientContext</strong> member of <a href="wnode-header.md"><strong>WNODE_HEADER</strong></a>.<br /> The default value is 1 (performance counter value) on Windows Vista and later. Prior to Windows Vista, the default value is 2 (system timer).<br /> | 
| <strong>EnableKernelFlags</strong> | <strong>REG_BINARY</strong> | Use this value to enable one or more kernel providers. If you enable kernel providers, the Global Logger session will rename itself to NT Kernel Logger when it starts. For possible values, see the <strong>EnableFlags</strong> member of <a href="/windows/win32/api/evntrace/ns-evntrace-event_trace_properties"><strong>EVENT_TRACE_PROPERTIES</strong></a>.<br /> | 
| <strong>FileCounter</strong> | <strong>REG_DWORD</strong> | The number of event trace log files generated by Global Logger sessions. The system increments this value until it reaches the value of <strong>FileMax</strong>. Then, it resets the value to 0. This counter prevents the system from overwriting a Global Logger trace log file. <br /> | 
| <strong>FileMax</strong> | <strong>REG_DWORD</strong> | The maximum number of event trace log files permitted on the system. When the number of trace logs reaches the specified maximum, the system begins to overwrite the logs, beginning with the oldest. <br /> If the log file specified in <strong>FileName</strong> exists, ETW appends the <strong>FileCounter</strong> value to the file name. For example, if the default log file name is used, the form is %SystemRoot%\System32\LogFiles\WMI\GlobalLogger.etl.NNNN. <br /> The default value is 0, meaning that there is no maximum. <br /> | 
| <strong>FileName</strong> | <strong>REG_SZ</strong> | Fully qualified path of the log file. The path to this file must exist. The log file is a sequential log file. Note that all providers writing events to the Global Logger session write events to this log file. The path is limited to 1024 characters.If <strong>FileName</strong> is not specified, events are written to %SystemRoot%\System32\LogFiles\WMI\GlobalLogger.etl. <strong>Prior to Windows Vista:</strong> The default file is %SystemRoot%\System32\LogFiles\WMI\Trace.log.<br /><br /> | 
| <strong>FlushTimer</strong> | <strong>REG_DWORD</strong> | How often, in seconds, the trace buffers are forcibly flushed. The minimum flush time is 1 second. This forced flush is in addition to the automatic flush that occurs when a buffer is full and when the trace session stops. <br /> For the case of a real-time logger, a value of zero (the default value) means that the flush time will be set to 1 second. A real-time logger is when <strong>LogFileMode</strong> is set to <strong>EVENT_TRACE_REAL_TIME_MODE</strong>.<br /> The default value is 0. By default, buffers are flushed only when they are full. <br /> | 
| <strong>LogFileMode</strong> | <strong>REG_DWORD</strong> | Specifies log session options. For values, see <a href="logging-mode-constants.md">Logging Mode Constants</a>. This values is supported on Windows Vista and later. <br /> | 
| <strong>MaximumBuffers</strong> | <strong>REG_DWORD</strong> | The maximum number of buffers to allocate. Typically, this value is the minimum number of buffers plus twenty. ETW uses the buffer size and the size of physical memory to calculate this value. This value must be greater than or equal to the value for <strong>MinimumBuffers</strong>.<br /> | 
| <strong>MaxFileSize</strong> | <strong>REG_DWORD</strong> | The maximum size, in megabytes, of the event trace log file. By default, there is no maximum file size.<br /> | 
| <strong>MinimumBuffers</strong> | <strong>REG_DWORD</strong> | The minimum number of buffers to allocate when the Global Logger session starts. The minimum number of buffers that you can specify is two buffers per processor. For example, on a single processor computer, the minimum number of buffers is two. <br /> The default value on a single-processor system is 0x3.<br /> | 
| <strong>Status</strong> | <strong>REG_DWORD</strong> | The startup status of the Global Logger. If the Global Logger failed to start, the value of this key is the appropriate Win32 error code. If the Global Logger successfully started, the value of this key is ERROR_SUCCESS (0).<br /> | 




 

After the registry has been modified and the computer restarted, the Global Logger session starts automatically and is used like any other session with one exception: You use the WMI\_GLOBAL\_LOGGER\_ID constant handle (defined in Wmistr.h) to reference the Global Logger session. This constant may be used as an argument to any event tracing function that accepts a session handle. In functions that accept a session name, use GLOBAL\_LOGGER\_NAME.

The Global Logger controller does not call the [**EnableTrace**](/windows/win32/api/evntrace/nf-evntrace-enabletrace) function to enable providers. The provider is responsible for determining if the Global Logger session is started and then enabling itself.

To determine if the Global Logger session is started, you can call the [**ControlTrace**](/windows/win32/api/evntrace/nf-evntrace-controltracea) function, setting *SessionHandle* to WMI\_GLOBAL\_LOGGER\_ID and *ControlCode* to **EVENT\_TRACE\_CONTROL\_QUERY**. If the **ControlTrace** call is successful, the Global Logger session exists and the provider can enable itself and log events to the Global Logger session (the **ControlTrace** function returns ERROR\_WMI\_INSTANCE\_NOT\_FOUND if the Global Logger is not active).

Typically, the controller is responsible for passing the enable flags and level to the provider when it enables the provider, but because the Global Logger controller does not enable the provider, it is the provider's responsibility to pass this information to itself, if needed.

The Global Logger session is a limited resource and should be used sparingly. Services that want to capture information during the boot process should consider adding controller logic to itself instead of using the Global Logger session.

For details on starting an event tracing session, see [Configuring and Starting an Event Tracing Session](configuring-and-starting-an-event-tracing-session.md).

For details on starting a private logger session, see [Configuring and Starting a Private Logger Session](configuring-and-starting-a-private-logger-session.md).

For details on starting an NT Kernel Logger session, see [Configuring and Starting the NT Kernel Logger Session](configuring-and-starting-the-nt-kernel-logger-session.md).

