---
description: Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used.
ms.assetid: ebbf871b-cf78-4a90-8f27-e44699c17178
title: Windows-Format Metafiles
ms.topic: article
ms.date: 05/31/2018
---

# Windows-Format Metafiles

Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used. The Windows-format functions are supported to maintain backward compatibility with applications that were written to run as 16 bit Windows-based applications. Instead, you should use the enhanced-format functions.

A *Windows-format metafile* is used by 16-bit Windows-based applications. The format consists of a header and an array of metafile records.

The following are the limitations of this format:

- A Windows-format metafile is application and device dependent. Changes in the application's mapping modes or the device resolution affect the appearance of metafiles created in this format.
- A Windows-format metafile does not contain a comprehensive header that describes the original picture dimensions, the resolution of the device on which the picture was created, an optional text description, or an optional palette.
- A Windows-format metafile does not support the new curve, path, and transformation functions. See the list of supported functions in the table that follows.
- Some Windows-format metafile records cannot be scaled.
- The metafile device context associated with a Windows-format metafile cannot be queried (that is, an application cannot retrieve device-resolution data, font metrics, and so on).

The following are the only functions that are supported by Windows-format metafiles.

| &nbsp; | &nbsp; | &nbsp; |
|-|-|-|
| [**AnimatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-animatepalette)[**Arc**](/windows/desktop/api/Wingdi/nf-wingdi-arc)<br/> [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt)<br/> [**Chord**](/windows/desktop/api/Wingdi/nf-wingdi-chord)<br/> [**CreateBrushIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createbrushindirect)<br/> [**CreateDIBPatternBrush**](/windows/desktop/api/Wingdi/nf-wingdi-createdibpatternbrush)<br/> [**CreateFontIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createfontindirecta)<br/> [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette)<br/> [**CreatePatternBrush**](/windows/desktop/api/Wingdi/nf-wingdi-createpatternbrush)<br/> [**CreatePenIndirect**](/windows/desktop/api/Wingdi/nf-wingdi-createpenindirect)<br/> [**DeleteObject**](/windows/desktop/api/Wingdi/nf-wingdi-deleteobject)<br/> [**Ellipse**](/windows/desktop/api/Wingdi/nf-wingdi-ellipse)<br/> [**Escape**](/windows/win32/api/wingdi/nf-wingdi-escape)<br/> [**ExcludeClipRect**](/windows/desktop/api/Wingdi/nf-wingdi-excludecliprect)<br/> [**ExtFloodFill**](/windows/desktop/api/Wingdi/nf-wingdi-extfloodfill)<br/> [**ExtTextOut**](/windows/desktop/api/Wingdi/nf-wingdi-exttextouta)<br/> [**FillRgn**](/windows/desktop/api/Wingdi/nf-wingdi-fillrgn)<br/> [**FloodFill**](/windows/desktop/api/Wingdi/nf-wingdi-floodfill)<br/> [**FrameRgn**](/windows/desktop/api/Wingdi/nf-wingdi-framergn)<br/> [**IntersectClipRect**](/windows/desktop/api/Wingdi/nf-wingdi-intersectcliprect)<br/> [**InvertRgn**](/windows/desktop/api/Wingdi/nf-wingdi-invertrgn)<br/> | [**LineTo**](/windows/desktop/api/Wingdi/nf-wingdi-lineto)[**MoveToEx**](/windows/desktop/api/Wingdi/nf-wingdi-movetoex)<br/> [**OffsetClipRgn**](/windows/desktop/api/Wingdi/nf-wingdi-offsetcliprgn)<br/> [**OffsetViewportOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-offsetviewportorgex)<br/> [**OffsetWindowOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-offsetwindoworgex)<br/> [**PaintRgn**](/windows/desktop/api/Wingdi/nf-wingdi-paintrgn)<br/> [**PatBlt**](/windows/desktop/api/Wingdi/nf-wingdi-patblt)<br/> [**Pie**](/windows/desktop/api/Wingdi/nf-wingdi-pie)<br/> [**Polygon**](/windows/desktop/api/Wingdi/nf-wingdi-polygon)<br/> [**Polyline**](/windows/desktop/api/Wingdi/nf-wingdi-polyline)<br/> [**PolyPolygon**](/windows/desktop/api/Wingdi/nf-wingdi-polypolygon)<br/> [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette)<br/> [**Rectangle**](/windows/desktop/api/Wingdi/nf-wingdi-rectangle)<br/> [**ResizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-resizepalette)<br/> [**RestoreDC**](/windows/desktop/api/Wingdi/nf-wingdi-restoredc)<br/> [**RoundRect**](/windows/desktop/api/Wingdi/nf-wingdi-roundrect)<br/> [**SaveDC**](/windows/desktop/api/Wingdi/nf-wingdi-savedc)<br/> [**ScaleViewportExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-scaleviewportextex)<br/> [**ScaleWindowExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-scalewindowextex)<br/> [**SelectClipRgn**](/windows/desktop/api/Wingdi/nf-wingdi-selectcliprgn)<br/> [**SelectObject**](/windows/desktop/api/Wingdi/nf-wingdi-selectobject)<br/> | [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette)[**SetBkColor**](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor)<br/> [**SetBkMode**](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode)<br/> [**SetDIBitsToDevice**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice)<br/> [**SetMapMode**](/windows/desktop/api/Wingdi/nf-wingdi-setmapmode)<br/> [**SetMapperFlags**](/windows/desktop/api/Wingdi/nf-wingdi-setmapperflags)<br/> [**SetPaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-setpaletteentries)<br/> [**SetPixel**](/windows/desktop/api/Wingdi/nf-wingdi-setpixel)<br/> [**SetPolyFillMode**](/windows/desktop/api/Wingdi/nf-wingdi-setpolyfillmode)<br/> [**SetROP2**](/windows/desktop/api/Wingdi/nf-wingdi-setrop2)<br/> [**SetStretchBltMode**](/windows/desktop/api/Wingdi/nf-wingdi-setstretchbltmode)<br/> [**SetTextAlign**](/windows/desktop/api/Wingdi/nf-wingdi-settextalign)<br/> [**SetTextCharacterExtra**](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra)<br/> [**SetTextColor**](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor)<br/> [**SetTextJustification**](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification)<br/> [**SetViewportOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-setviewportorgex)<br/> [**SetWindowExtEx**](/windows/desktop/api/Wingdi/nf-wingdi-setwindowextex)<br/> [**SetWindowOrgEx**](/windows/desktop/api/Wingdi/nf-wingdi-setwindoworgex)<br/> [**StretchBlt**](/windows/desktop/api/Wingdi/nf-wingdi-stretchblt)<br/> [**StretchDIBits**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits)<br/> [**TextOut**](/windows/desktop/api/Wingdi/nf-wingdi-textouta)<br/>|

> [!NOTE]
> To convert a Windows-format metafile to an enhanced-format metafile, call the [**GetMetaFileBitsEx**](/windows/desktop/api/Wingdi/nf-wingdi-getmetafilebitsex) function to retrieve the data from the Windows-format metafile and then call the [**SetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setwinmetafilebits) function to convert this data into an enhanced-format metafile. To convert an enhanced-format record into a Windows-format record, call the [**GetWinMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getwinmetafilebits) function.
