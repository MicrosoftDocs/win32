---
title: ShellProc callback function (Windows)
TOCTitle: ShellProc callback function
ms:assetid: VS|winui|~\winui\windowsuserinterface\windowing\hooks\hookreference\hookfunctions\shellproc.htm
ms:mtpsurl: https://msdn.microsoft.com/en-us/library/ms644991(v=VS.85)
ms:contentKeyID: 5641730
ms.date: 03/30/2018
mtps_version: v=VS.85
f1_keywords:
- ShellProc
- HSHELL_ACCESSIBILITYSTATE
- HSHELL_GETMINRECT
- HSHELL_LANGUAGE
- HSHELL_APPCOMMAND
- HSHELL_ACTIVATESHELLWINDOW
- HSHELL_WINDOWACTIVATED
- HSHELL_WINDOWREPLACED
- HSHELL_REDRAW
- HSHELL_WINDOWCREATED
- winuser/ShellProc
- HSHELL_WINDOWDESTROYED
- HSHELL_TASKMAN
dev_langs:
- C++
- C
api_location:
- Winuser.h
api_name:
- ShellProc
api_type:
- UserDefined
product:
- Windows
topic_type:
- apiref
- kbSyntax
product_family_name: VS
ROBOTS: INDEX,FOLLOW
---

# ShellProc callback function

An application-defined or library-defined callback function used with the [**SetWindowsHookExA**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)/[**SetWindowsHookExW**](/windows/win32/api/winuser/nf-winuser-setwindowshookexw) function. The function receives notifications of Shell events from the system.

The **HOOKPROC** type defines a pointer to this callback function. *ShellProc* is a placeholder for the application-defined or library-defined function name.

## Syntax

``` c++
LRESULT CALLBACK ShellProc(
  _In_ int    nCode,
  _In_ WPARAM wParam,
  _In_ LPARAM lParam
);
```

## Parameters

  - *nCode* \[in\]  
    Type: **int**
    
    The hook code. If *nCode* is less than zero, the hook procedure must pass the message to the [**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex) function without further processing and should return the value returned by **CallNextHookEx**. This parameter can be one of the following values.
    
    <table>
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th>Value</th>
    <th>Meaning</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><span id="HSHELL_ACCESSIBILITYSTATE"></span><span id="hshell_accessibilitystate"></span>
    <strong>HSHELL_ACCESSIBILITYSTATE</strong>
    11</td>
    <td><p>The accessibility state has changed.</p></td>
    </tr>
    <tr class="even">
    <td><span id="HSHELL_ACTIVATESHELLWINDOW"></span><span id="hshell_activateshellwindow"></span>
    <strong>HSHELL_ACTIVATESHELLWINDOW</strong>
    3</td>
    <td><p>The shell should activate its main window.</p></td>
    </tr>
    <tr class="odd">
    <td><span id="HSHELL_APPCOMMAND"></span><span id="hshell_appcommand"></span>
    <strong>HSHELL_APPCOMMAND</strong>
    12</td>
    <td><p>The user completed an input event (for example, pressed an application command button on the mouse or an application command key on the keyboard), and the application did not handle the <a href="/windows/win32/inputdev/wm-appcommand"><strong>WM_APPCOMMAND</strong></a> message generated by that input.</p>
    <p>If the Shell procedure handles the <a href="/windows/win32/menurc/wm-command"><strong>WM_COMMAND</strong></a> message, it should not call <a href="/windows/win32/api/winuser/nf-winuser-callnexthookex"><strong>CallNextHookEx</strong></a>. See the Return Value section for more information.</p></td>
    </tr>
    <tr class="even">
    <td><span id="HSHELL_GETMINRECT"></span><span id="hshell_getminrect"></span>
    <strong>HSHELL_GETMINRECT</strong>
    5</td>
    <td><p>A window is being minimized or maximized. The system needs the coordinates of the minimized rectangle for the window.</p></td>
    </tr>
    <tr class="odd">
    <td><span id="HSHELL_LANGUAGE"></span><span id="hshell_language"></span>
    <strong>HSHELL_LANGUAGE</strong>
    8</td>
    <td><p>Keyboard language was changed or a new keyboard layout was loaded.</p></td>
    </tr>
    <tr class="even">
    <td><span id="HSHELL_REDRAW"></span><span id="hshell_redraw"></span>
    <strong>HSHELL_REDRAW</strong>
    6</td>
    <td><p>The title of a window in the task bar has been redrawn.</p></td>
    </tr>
    <tr class="odd">
    <td><span id="HSHELL_TASKMAN"></span><span id="hshell_taskman"></span>
    <strong>HSHELL_TASKMAN</strong>
    7</td>
    <td><p>The user has selected the task list. A shell application that provides a task list should return <strong>TRUE</strong> to prevent Windows from starting its task list.</p></td>
    </tr>
    <tr class="even">
    <td><span id="HSHELL_WINDOWACTIVATED"></span><span id="hshell_windowactivated"></span>
    <strong>HSHELL_WINDOWACTIVATED</strong>
    4</td>
    <td><p>The activation has changed to a different top-level, unowned window.</p></td>
    </tr>
    <tr class="odd">
    <td><span id="HSHELL_WINDOWCREATED"></span><span id="hshell_windowcreated"></span>
    <strong>HSHELL_WINDOWCREATED</strong>
    1</td>
    <td><p>A top-level, unowned window has been created. The window exists when the system calls this hook.</p></td>
    </tr>
    <tr class="even">
    <td><span id="HSHELL_WINDOWDESTROYED"></span><span id="hshell_windowdestroyed"></span>
    <strong>HSHELL_WINDOWDESTROYED</strong>
    2</td>
    <td><p>A top-level, unowned window is about to be destroyed. The window still exists when the system calls this hook.</p></td>
    </tr>
    <tr class="odd">
    <td><span id="HSHELL_WINDOWREPLACED"></span><span id="hshell_windowreplaced"></span>
    <strong>HSHELL_WINDOWREPLACED</strong>
    13</td>
    <td><p>A top-level window is being replaced. The window exists when the system calls this hook.</p></td>
    </tr>
    </tbody>
    </table>
    
     

  - *wParam* \[in\]  
    Type: **WPARAM**
    
    This parameter depends on the value of the *nCode* parameter, as shown in the following table.
    
    <table>
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th><em>nCode</em></th>
    <th><em>wParam</em></th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><strong>HSHELL_ACCESSIBILITYSTATE</strong></td>
    <td>Indicates which accessibility feature has changed state. This value is one of the following: <strong>ACCESS_FILTERKEYS</strong>, <strong>ACCESS_MOUSEKEYS</strong>, or <strong>ACCESS_STICKYKEYS</strong>.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_APPCOMMAND</strong></td>
    <td>Indicates where the <a href="/windows/win32/inputdev/wm-appcommand"><strong>WM_APPCOMMAND</strong></a> message was originally sent; for example, the handle to a window. For more information, see <em>cmd</em> parameter in <strong>WM_APPCOMMAND</strong>.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_GETMINRECT</strong></td>
    <td>A handle to the minimized or maximized window.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_LANGUAGE</strong></td>
    <td>A handle to the window.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_REDRAW</strong></td>
    <td>A handle to the redrawn window.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_WINDOWACTIVATED</strong></td>
    <td>A handle to the activated window.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_WINDOWCREATED</strong></td>
    <td>A handle to the created window.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_WINDOWDESTROYED</strong></td>
    <td>A handle to the destroyed window.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_WINDOWREPLACED</strong></td>
    <td>A handle to the window being replaced.
    <p><strong>Windows 2000:  </strong>Not supported.</p></td>
    </tr>
    </tbody>
    </table>
    
     

  - *lParam* \[in\]  
    Type: **LPARAM**
    
    This parameter depends on the value of the *nCode* parameter, as shown in the following table.
    
    <table>
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th><em>nCode</em></th>
    <th><em>lParam</em></th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td><strong>HSHELL_APPCOMMAND</strong></td>
    <td><p><code>GET_APPCOMMAND_LPARAM(lParam)</code> is the application command corresponding to the input event.</p>
    <p><code>GET_DEVICE_LPARAM(lParam)</code> indicates what generated the input event; for example, the mouse or keyboard. For more information, see the <em>uDevice</em> parameter description under <a href="/windows/win32/inputdev/wm-appcommand"><strong>WM_APPCOMMAND</strong></a>.</p>
    <p><code>GET_FLAGS_LPARAM(lParam)</code> depends on the value of <em>cmd</em> in <a href="/windows/win32/inputdev/wm-appcommand"><strong>WM_APPCOMMAND</strong></a>. For example, it might indicate which virtual keys were held down when the <strong>WM_APPCOMMAND</strong> message was originally sent. For more information, see the <em>dwCmdFlags</em> description parameter under <strong>WM_APPCOMMAND</strong>.</p></td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_GETMINRECT</strong></td>
    <td>A pointer to a <a href="/previous-versions//dd162897(v=vs.85)"><strong>RECT</strong></a> structure.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_LANGUAGE</strong></td>
    <td>A handle to a keyboard layout.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_MONITORCHANGED</strong></td>
    <td>A handle to the window that moved to a different monitor.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_REDRAW</strong></td>
    <td>The value is <strong>TRUE</strong> if the window is flashing, or <strong>FALSE</strong> otherwise.</td>
    </tr>
    <tr class="even">
    <td><strong>HSHELL_WINDOWACTIVATED</strong></td>
    <td>The value is <strong>TRUE</strong> if the window is in full-screen mode, or <strong>FALSE</strong> otherwise.</td>
    </tr>
    <tr class="odd">
    <td><strong>HSHELL_WINDOWREPLACED</strong></td>
    <td>A handle to the new window.
    <p><strong>Windows 2000:  </strong>Not supported.</p></td>
    </tr>
    </tbody>
    </table>
    
     

## Return value

Type: ****

Type: LRESULT

The return value should be zero unless the value of *nCode* is **HSHELL\_APPCOMMAND** and the shell procedure handles the [**WM\_COMMAND**](https://msdn.microsoft.com/en-us/library/ms647591\(v=vs.85\)) message. In this case, the return should be nonzero.

## Remarks

Install this hook procedure by specifying the [**WH\_SHELL**](https://msdn.microsoft.com/en-us/library/ms644959\(v=vs.85\)) hook type and a pointer to the hook procedure in a call to the [**SetWindowsHookExA**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)/[**SetWindowsHookExW**](/windows/win32/api/winuser/nf-winuser-setwindowshookexw) function.

## Requirements

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>Minimum supported client</p></td>
<td><p>Windows 2000 Professional [desktop apps only]</p></td>
</tr>
<tr class="even">
<td><p>Minimum supported server</p></td>
<td><p>Windows 2000 Server [desktop apps only]</p></td>
</tr>
<tr class="odd">
<td><p>Header</p></td>
<td>Winuser.h (include Windows.h)</td>
</tr>
</tbody>
</table>


## See also

**Reference**

[**CallNextHookEx**](/windows/win32/api/winuser/nf-winuser-callnexthookex)

[**SendMessage**](https://msdn.microsoft.com/en-us/library/ms644950\(v=vs.85\))

[**SetWindowsHookExA**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)/[**SetWindowsHookExW**](/windows/win32/api/winuser/nf-winuser-setwindowshookexw)

[**WM\_APPCOMMAND**](https://msdn.microsoft.com/en-us/library/ms646275\(v=vs.85\))

**Conceptual**

[Hooks](https://msdn.microsoft.com/en-us/library/ms632589\(v=vs.85\))