---
title: Creating a Control Access Right
description: To add a control access right to an Active Directory server, create a controlAccessRight object in the Extended-Rights container of the Configuration partition.
audience: developer
author: REDMOND\\markl
manager: REDMOND\\mbaldwin
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.prod: windows-server-dev
ms.technology: active-directory-domain-services
ms.tgt_platform: multiple
keywords:
- Creating a Control Access Right AD
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Creating a Control Access Right

To add a control access right to an Active Directory server, create a [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) object in the Extended-Rights container of the Configuration partition. For more information and a code example, see [Example Code for Creating a Control Access Right](example-code-for-creating-a-control-access-right.md). To use the control access right, you must complete a few more steps, depending on whether the control access right is for a special operation or a property set.

If you define a control access right for a property set, use the **rightsGUID** of the [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) object to identify the properties in the set. Every property is defined by an [**attributeSchema**](https://msdn.microsoft.com/library/ms680969) object in the Active Directory schema. The [**attributeSecurityGUID**](https://msdn.microsoft.com/library/ms675235) property of an **attributeSchema** object identifies the property set, if any, that the property belongs to. Be aware that the **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).

If you define a control access right to place restrictions on access to a particular operation, your application must perform the access check when a user attempts the operation.

**To set up access check**

1.  Create a control access right that defines the type of access to the application or service. For more information, see the following code example.
2.  Create an Active Directory Domain Services object that represents the application, service, or resource that you are protecting.
3.  Add object ACEs to the DACL in the object security descriptor to grant or deny users or groups the control access right on that object. For more information, see [Setting a Control Access Right ACE in an Object's ACL](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).
4.  When a user attempts to perform the operation, verify the user rights by passing the object security descriptor and the user access token to the [**AccessCheckByTypeResultList**](https://msdn.microsoft.com/library/windows/desktop/aa374836) function. For more information, see [Checking a Control Access Right in an Object's ACL](checking-a-control-access-right-in-an-objectampaposs-acl.md).

Based on the result of the access check on the object, the application or service can allow or deny the user access to the application or service.

When you create a [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) object, set the attributes, listed in the following table, to make the object a legal control access right that is recognized by Active Directory Domain Services and the Windows security systems.



| Attribute                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**cn**](https://msdn.microsoft.com/library/ms675449)                       | A single-valued property that is the object's relative distinguished name (RDN) in the Extended-Rights container. The **cn** is the name of the access control right in Active Directory Domain Services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**appliesTo**](https://msdn.microsoft.com/library/ms675225)         | A multi-valued property that lists the object classes that the access control right applies to. For example, the [**Send-As**](https://msdn.microsoft.com/library/ms684406) access control right lists the [**user**](https://msdn.microsoft.com/library/ms683980) and [**computer**](https://msdn.microsoft.com/library/ms680987) object classes in its **appliesTo** property. In the list, each object class is identified by the [**schemaIDGUID**](https://msdn.microsoft.com/library/ms679645) of its [**classSchema**](https://msdn.microsoft.com/library/ms680982) object. The GUIDs are stored as strings of the form produced by the [**StringFromGUID2**](https://msdn.microsoft.com/en-us/library/ms683893(v=VS.85).aspx) function in the COM library but without the starting and terminating braces ({ }). For example, the following GUID is the **schemaIDGUID** for the [**computer**](https://msdn.microsoft.com/library/ms680987) class: bf967a86-0de6-11d0-a285-00aa003049e2.<br/> Be aware that the [**schemaIDGUID**](https://msdn.microsoft.com/library/ms679645) property of a [**classSchema**](https://msdn.microsoft.com/library/ms680982) object is stored as a binary GUID using the octet string syntax. To convert this octet string format to the string format used in the [**appliesTo**](https://msdn.microsoft.com/library/ms675225) property, use the [**StringFromGUID2**](https://msdn.microsoft.com/en-us/library/ms683893(v=VS.85).aspx) function and remove the braces from the returned string.<br/> For more information about the [**schemaIDGUID**](https://msdn.microsoft.com/library/ms679645) property of one of the predefined object classes, such as [**user**](https://msdn.microsoft.com/library/ms683980) or [**computer**](https://msdn.microsoft.com/library/ms680987), see the class reference page in the Active Directory Schema Reference in the [Active Directory Domain Services Reference](active-directory-domain-services-reference.md). For more information and a code example that retrieves a **schemaIDGUID** from a classSchema object, see [Reading attributeSchema and classSchema Objects](reading-attributeschema-and-classschema-objects.md).<br/> |
| [**displayName**](https://msdn.microsoft.com/library/ms675514)     | The string used to display the access control right in user interfaces such as the **Security** property page and other places in the Active Directory Users and Computers MMC snap-in.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**rightsGuid**](https://msdn.microsoft.com/library/ms679464)       | A GUID that identifies the control access right in an ACE. The GUID is stored as a string of the form produced by the [**StringFromGUID2**](https://msdn.microsoft.com/en-us/library/ms683893(v=VS.85).aspx) function, but without the starting and terminating braces. Use Uuidgen.exe for some other utility to generate a GUID for the control access right.If you define a new property set, you use the [**rightsGuid**](https://msdn.microsoft.com/library/ms679464) of the [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) object to identify the properties in the set. For each property in the property set, set the property's [**attributeSecurityGUID**](https://msdn.microsoft.com/library/ms675235) value to the value of the property set's **rightsGUID**. A property's **attributeSecurityGUID** value is stored in the property's [**attributeSchema**](https://msdn.microsoft.com/library/ms680969) definition in the Active Directory schema. The **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**objectClass**](https://msdn.microsoft.com/library/ms679012)     | This attribute specifies [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) as the object class.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**validAccesses**](https://msdn.microsoft.com/library/ms680891) | For property sets, set this attribute to 0x30 (**ADS\_RIGHT\_DS\_READ\_PROP** \| **ADS\_RIGHT\_DS\_WRITE\_PROP**). For control access rights, set this attribute to 0x100 (**ADS\_RIGHT\_DS\_CONTROL\_ACCESS**). The security property page recognizes control access rights only if the [**validAccesses**](https://msdn.microsoft.com/library/ms680891) attribute is set to the appropriate value. If zero, the control access right is ignored or not displayed by the security property page.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

Be aware that the predefined schema classes use the **localizationDisplayId** attribute of a [**controlAccessRight**](https://msdn.microsoft.com/library/ms681001) object to specify a message identifier used to retrieve a localized display name from Dssec.dll. Do not set the **localizationDisplayId** attribute if you define a new **controlAccessRight** object.

 

 





