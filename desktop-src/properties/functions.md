---
description: This section describes the Windows Property System functions.
ms.assetid: ce8336cd-d9aa-4b93-ab47-30edd7518dab
title: Functions (Windows Property System)
ms.topic: article
ms.date: 05/31/2018
---

# Functions (Windows Property System)

This section describes the Windows Property System functions.



| Topic                                                                                                | Contents                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [PROPVARIANT and VARIANT Functions](./functions-propvarutil.md)                                     | This section describes a set of Windows Property System conversion and helper functions used with [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) and [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) types.                                                                                                                                                                                                          |
| [Property Bag Functions](property-bag-functions.md)                                                 | This section describes a set of Windows helper functions used with [**IPropertyBag**](/windows/win32/api/oaidl/nn-oaidl-ipropertybag) objects.                                                                                                                                                                                                                                                                             |
| [**PifMgr\_CloseProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_closeproperties)                                            | Closes application properties that were opened with [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties).<br/>                                                                                                                                                                                                                                                                                      |
| [**PifMgr\_GetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_getproperties)                                                | Returns a specified block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties)                                              | Opens the .pif file associated with a Microsoft MS-DOS application, and returns a handle to the application's properties.<br/>                                                                                                                                                                                                                                                                         |
| [**PifMgr\_SetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_setproperties)                                                | Assigns values to a block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PSCoerceToCanonicalValue**](/windows/win32/api/propsys/nf-propsys-pscoercetocanonicalvalue)                                       | Converts the value of a property to the canonical value, according to the property description.<br/>                                                                                                                                                                                                                                                                                                   |
| [**PSCreateAdapterFromPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreateadapterfrompropertystore)                       | Creates an adapter from an [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSCreateDelayedMultiplexPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatedelayedmultiplexpropertystore)             | Creates a read-only, delayed-binding property store that contains multiple property stores.<br/>                                                                                                                                                                                                                                                                                                       |
| [**PSCreateMemoryPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatememorypropertystore)                                 | Creates an in-memory property store.<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [**PSCreateMultiplexPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatemultiplexpropertystore)                           | Creates a read-only property store that contains multiple property stores, each of which must support either [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) or [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage).<br/>                                                                                                                                                                                    |
| [**PSCreatePropertyChangeArray**](/windows/win32/api/propsys/nf-propsys-pscreatepropertychangearray)                                 | Creates a container for a set of [**IPropertyChange**](/windows/win32/api/propsys/nn-propsys-ipropertychange) objects. This container can be used with [**IFileOperation**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileoperation) to apply a set of property changes to a set of files.<br/>                                                                                                                                                                           |
| [**PSCreatePropertyStoreFromObject**](/windows/win32/api/propsys/nf-propsys-pscreatepropertystorefromobject)                         | Accepts the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface of an object that supports [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) or [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage). If the object supports **IPropertySetStorage**, it is wrapped so that it supports **IPropertyStore**.<br/>                                                                                                             |
| [**PSCreatePropertyStoreFromPropertySetStorage**](/windows/win32/api/propsys/nf-propsys-pscreatepropertystorefrompropertysetstorage) | Wraps an [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) interface in an [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.<br/>                                                                                                                                                                                                                                                                 |
| [**PSCreateSimplePropertyChange**](/windows/win32/api/propsys/nf-propsys-pscreatesimplepropertychange)                               | Creates a simple property change.<br/>                                                                                                                                                                                                                                                                                                                                                                 |
| [**PSEnumeratePropertyDescriptions**](/windows/win32/api/propsys/nf-propsys-psenumeratepropertydescriptions)                         | A wrapper API that calls the schema subsystem's [**IPropertySystem::EnumeratePropertyDescriptions**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-enumeratepropertydescriptions). This function retrieves an instance of the subsystem object that implements [**IPropertyDescriptionList**](/windows/win32/api/propsys/nn-propsys-ipropertydescriptionlist), to obtain either the entire list or a partial list of property descriptions in the system.<br/> |
| [**PSFormatForDisplay**](/windows/win32/api/propsys/nf-propsys-psformatfordisplay)                                                   | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure. The caller is responsible for allocating the output buffer.<br/>                                                                                                                                                                                                         |
| [**PSFormatForDisplayAlloc**](/windows/win32/api/propsys/nf-propsys-psformatfordisplayalloc)                                         | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure. This function allocates memory for the output string.<br/>                                                                                                                                                                                                               |
| [**PSFormatPropertyValue**](/windows/win32/api/propsys/nf-propsys-psformatpropertyvalue)                                             | Gets a formatted, Unicode string representation of a property value stored in a property store. This function allocates memory for the output string.<br/>                                                                                                                                                                                                                                             |
| [**PSGetImageReferenceForValue**](/windows/win32/api/propsys/nf-propsys-psgetimagereferenceforvalue)                                 | Gets an instance of a property description interface for a specified property.<br/>                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandler**](/windows/win32/api/propsys/nf-propsys-psgetitempropertyhandler)                                       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandlerWithCreateObject**](/windows/win32/api/propsys/nf-propsys-psgetitempropertyhandlerwithcreateobject)       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetNamedPropertyFromPropertyStorage**](/windows/win32/api/propsys/nf-propsys-psgetnamedpropertyfrompropertystorage)             | Gets a value from serialized property storage by property name.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSGetNameFromPropertyKey**](/windows/win32/api/propsys/nf-propsys-psgetnamefrompropertykey)                                       | Retrieves the canonical name of the property, given its [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey).<br/>                                                                                                                                                                                                                                                                                                     |
| [**PSGetPropertyDescription**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescription)                                       | Gets an instance of a property description interface for a property specified by a [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey) structure.<br/>                                                                                                                                                                                                                                                                |
| [**PSGetPropertyDescriptionByName**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescriptionbyname)                           | Gets an instance of a property description interface for a specified property name.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSGetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescriptionlistfromstring)           | Gets an instance of a property description list interface for a specified property list.<br/>                                                                                                                                                                                                                                                                                                          |
| [**PSGetPropertyFromPropertyStorage**](/windows/win32/api/propsys/nf-propsys-psgetpropertyfrompropertystorage)                       | Gets the value of a property as stored in serialized property storage.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyKeyFromName**](/windows/win32/api/propsys/nf-propsys-psgetpropertykeyfromname)                                       | Gets the property key for a canonical property name.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSGetPropertySystem**](/windows/win32/api/propsys/nf-propsys-psgetpropertysystem)                                                 | Gets an instance of the subsystem object that implements [**IPropertySystem**](/windows/win32/api/propsys/nn-propsys-ipropertysystem).<br/>                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyValue**](/windows/win32/api/propsys/nf-propsys-psgetpropertyvalue)                                                   | Gets a property value from a property store.<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**PSLookupPropertyHandlerCLSID**](/windows/win32/api/propsys/nf-propsys-pslookuppropertyhandlerclsid)                               | Gets the class identifier (CLSID) of a per-computer, registered file property handler.<br/>                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_Delete**](/windows/win32/api/propsys/nf-propsys-pspropertybag_delete)                                              | Deletes a property from a property bag.<br/>                                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadBOOL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readbool)                                          | Reads the **BOOL** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadBSTR**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readbstr)                                          | Reads a **BSTR** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadDWORD**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readdword)                                        | Reads a **DWORD** data value from property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadGUID**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readguid)                                          | Reads the GUID data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadInt**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readint)                                            | Reads a **int** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readlong)                                          | Reads a **long** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadPOINTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpointl)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPOINTS**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpoints)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPropertyKey**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpropertykey)                            | Reads the property key of a property in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**PSPropertyBag\_ReadRECTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readrectl)                                        | Retrieves the coordinates of a rectangle stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_ReadSHORT**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readshort)                                        | Reads the **SHORT** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSPropertyBag\_ReadStr**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstr)                                            | Reads the string data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadStrAlloc**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstralloc)                                  | Retrieves details about the allocation or releasing of memory for a string that is stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadStream**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstream)                                      | Reads the data stream stored in a given property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadType**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readtype)                                          | Reads the type of data value of a property that is stored in a property bag.<br/>                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadULONGLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readulonglong)                                | Reads a **ULONGLONG** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**PSPropertyBag\_ReadUnknown**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readunknown)                                    | Reads a given property of an unknown data value in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WriteBOOL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writebool)                                        | Sets the **BOOL** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteBSTR**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writebstr)                                        | Sets the **BSTR** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteDWORD**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writedword)                                      | Sets the **DWORD** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteGUID**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeguid)                                        | Sets the GUID value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_WriteInt**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeint)                                          | Sets the **int** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_WriteLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writelong)                                        | Sets the **long** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WritePOINTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepointl)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePOINTS**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepoints)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePropertyKey**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepropertykey)                          | Sets the property key value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_WriteRECTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writerectl)                                      | Stores the coordinates of a rectangle in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteSHORT**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeshort)                                      | Sets the **SHORT** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteStr**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writestr)                                          | Sets the string value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteStream**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writestream)                                    | Writes a data stream to a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_WriteULONGLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeulonglong)                              | Sets the **ULONGLONG** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_WriteUnknown**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeunknown)                                  | Reads a property of an unknown data value in a property bag. <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyKeyFromString**](/windows/win32/api/propsys/nf-propsys-pspropertykeyfromstring)                                         | Converts a string to a [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey) structure.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSRefreshPropertySchema**](/windows/win32/api/propsys/nf-propsys-psrefreshpropertyschema)                                         | Not currently supported.<br/>                                                                                                                                                                                                                                                                                                                                                                          |
| [**PSRegisterPropertySchema**](/windows/win32/api/propsys/nf-propsys-psregisterpropertyschema)                                       | Informs the schema subsystem of the addition of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSSetPropertyValue**](/windows/win32/api/propsys/nf-propsys-pssetpropertyvalue)                                                   | Sets the value of a property in a property store.<br/>                                                                                                                                                                                                                                                                                                                                                 |
| [**PSStringFromPropertyKey**](/windows/win32/api/propsys/nf-propsys-psstringfrompropertykey)                                         | Creates a string that identifies a property from that property's key.<br/>                                                                                                                                                                                                                                                                                                                             |
| [**PSUnregisterPropertySchema**](/windows/win32/api/propsys/nf-propsys-psunregisterpropertyschema)                                   | Informs the schema subsystem of the removal of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                                |
| [**SHAddDefaultPropertiesByExt**](/windows/desktop/api/Shobjidl/nf-shobjidl-shadddefaultpropertiesbyext)                                   | Adds default properties to the property store as registered for the specified file extension.<br/>                                                                                                                                                                                                                                                                                                     |
| [**SHGetPropertyStoreForWindow**](/windows/desktop/api/Shellapi/nf-shellapi-shgetpropertystoreforwindow)                                   | Retrieves an object that represents a specific window's collection of properties, which allows those properties to be queried or set.<br/>                                                                                                                                                                                                                                                             |
| [**SHGetPropertyStoreFromIDList**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromidlist)                                 | Retrieves an object that supports [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) or related interfaces from a pointer to an item identifier list (PIDL).<br/>                                                                                                                                                                                                                                              |
| [**SHGetPropertyStoreFromParsingName**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromparsingname)                       | Returns a property store for an item, given a path or parsing name.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**SHPropStgCreate**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgcreate)                                                           | Ensures proper handling of code page retrieval or assignment for the requested property set operation.<br/>                                                                                                                                                                                                                                                                                            |
| [**SHPropStgReadMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgreadmultiple)                                               | Wraps the [**IPropertyStorage::ReadMultiple**](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                        |
| [**SHPropStgWriteMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgwritemultiple)                                             | Wraps the [**IPropertyStorage::WriteMultiple**](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-writemultiple) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                      |



 

## Related topics

<dl> <dt>

[Windows Properties](props.md)
</dt> <dt>

[Property Description Schema](property-description-schema.md)
</dt> <dt>

[Property Sets](property-sets.md)
</dt> <dt>

[Interfaces](interfaces.md)
</dt> <dt>

[Structures](structures.md)
</dt> <dt>

[Constants, Enumerations, and Flags](constants--enumerations--and-flags.md)
</dt> </dl>

 

 
