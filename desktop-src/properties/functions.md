---
Description: This section describes the Windows Property System functions.
ms.assetid: ce8336cd-d9aa-4b93-ab47-30edd7518dab
title: Functions
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Functions

This section describes the Windows Property System functions.



| Topic                                                                                                | Contents                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [PROPVARIANT and VARIANT Functions](https://msdn.microsoft.com/library/Bb762286(v=VS.85).aspx)                                     | This section describes a set of Windows Property System conversion and helper functions used with [**PROPVARIANT**](https://msdn.microsoft.com/en-us/library/Aa380072(v=VS.85).aspx) and [**VARIANT**](https://msdn.microsoft.com/en-us/library/ms221627(v=VS.71).aspx) types.                                                                                                                                                                                                          |
| [Property Bag Functions](property-bag-functions.md)                                                 | This section describes a set of Windows helper functions used with [**IPropertyBag**](https://msdn.microsoft.com/library/Aa768196(v=VS.85).aspx) objects.                                                                                                                                                                                                                                                                             |
| [**PifMgr\_CloseProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_closeproperties)                                            | Closes application properties that were opened with [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties).<br/>                                                                                                                                                                                                                                                                                      |
| [**PifMgr\_GetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_getproperties)                                                | Returns a specified block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties)                                              | Opens the .pif file associated with a Microsoft MS-DOS application, and returns a handle to the application's properties.<br/>                                                                                                                                                                                                                                                                         |
| [**PifMgr\_SetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_setproperties)                                                | Assigns values to a block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PSCoerceToCanonicalValue**](https://msdn.microsoft.com/library/Bb776486(v=VS.85).aspx)                                       | Converts the value of a property to the canonical value, according to the property description.<br/>                                                                                                                                                                                                                                                                                                   |
| [**PSCreateAdapterFromPropertyStore**](https://msdn.microsoft.com/library/Bb776487(v=VS.85).aspx)                       | Creates an adapter from an [**IPropertyStore**](https://msdn.microsoft.com/library/Bb761474(v=VS.85).aspx).<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSCreateDelayedMultiplexPropertyStore**](https://msdn.microsoft.com/library/Bb776488(v=VS.85).aspx)             | Creates a read-only, delayed-binding property store that contains multiple property stores.<br/>                                                                                                                                                                                                                                                                                                       |
| [**PSCreateMemoryPropertyStore**](https://msdn.microsoft.com/library/Bb776489(v=VS.85).aspx)                                 | Creates an in-memory property store.<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [**PSCreateMultiplexPropertyStore**](https://msdn.microsoft.com/library/Bb776490(v=VS.85).aspx)                           | Creates a read-only property store that contains multiple property stores, each of which must support either [**IPropertyStore**](https://msdn.microsoft.com/library/Bb761474(v=VS.85).aspx) or [**IPropertySetStorage**](https://msdn.microsoft.com/en-us/library/Aa379840(v=VS.85).aspx).<br/>                                                                                                                                                                                    |
| [**PSCreatePropertyChangeArray**](https://msdn.microsoft.com/library/Bb776491(v=VS.85).aspx)                                 | Creates a container for a set of [**IPropertyChange**](https://msdn.microsoft.com/library/Bb775244(v=VS.85).aspx) objects. This container can be used with [**IFileOperation**](https://msdn.microsoft.com/en-us/library/Bb775771(v=VS.85).aspx) to apply a set of property changes to a set of files.<br/>                                                                                                                                                                           |
| [**PSCreatePropertyStoreFromObject**](https://msdn.microsoft.com/library/Bb776492(v=VS.85).aspx)                         | Accepts the [**IUnknown**](https://msdn.microsoft.com/en-us/library/ms680509(v=VS.85).aspx) interface of an object that supports [**IPropertyStore**](https://msdn.microsoft.com/library/Bb761474(v=VS.85).aspx) or [**IPropertySetStorage**](https://msdn.microsoft.com/en-us/library/Aa379840(v=VS.85).aspx). If the object supports **IPropertySetStorage**, it is wrapped so that it supports **IPropertyStore**.<br/>                                                                                                             |
| [**PSCreatePropertyStoreFromPropertySetStorage**](https://msdn.microsoft.com/library/Bb776493(v=VS.85).aspx) | Wraps an [**IPropertySetStorage**](https://msdn.microsoft.com/en-us/library/Aa379840(v=VS.85).aspx) interface in an [**IPropertyStore**](https://msdn.microsoft.com/library/Bb761474(v=VS.85).aspx) interface.<br/>                                                                                                                                                                                                                                                                 |
| [**PSCreateSimplePropertyChange**](https://msdn.microsoft.com/library/Bb776494(v=VS.85).aspx)                               | Creates a simple property change.<br/>                                                                                                                                                                                                                                                                                                                                                                 |
| [**PSEnumeratePropertyDescriptions**](https://msdn.microsoft.com/library/Bb776495(v=VS.85).aspx)                         | A wrapper API that calls the schema subsystem's [**IPropertySystem::EnumeratePropertyDescriptions**](https://msdn.microsoft.com/library/Bb761426(v=VS.85).aspx). This function retrieves an instance of the subsystem object that implements [**IPropertyDescriptionList**](https://msdn.microsoft.com/library/Bb761511(v=VS.85).aspx), to obtain either the entire list or a partial list of property descriptions in the system.<br/> |
| [**PSFormatForDisplay**](https://msdn.microsoft.com/library/Bb776496(v=VS.85).aspx)                                                   | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](https://msdn.microsoft.com/en-us/library/Aa380072(v=VS.85).aspx) structure. The caller is responsible for allocating the output buffer.<br/>                                                                                                                                                                                                         |
| [**PSFormatForDisplayAlloc**](https://msdn.microsoft.com/library/Bb776497(v=VS.85).aspx)                                         | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](https://msdn.microsoft.com/en-us/library/Aa380072(v=VS.85).aspx) structure. This function allocates memory for the output string.<br/>                                                                                                                                                                                                               |
| [**PSFormatPropertyValue**](https://msdn.microsoft.com/library/Bb776498(v=VS.85).aspx)                                             | Gets a formatted, Unicode string representation of a property value stored in a property store. This function allocates memory for the output string.<br/>                                                                                                                                                                                                                                             |
| [**PSGetImageReferenceForValue**](https://msdn.microsoft.com/library/Ee845048(v=VS.85).aspx)                                 | Gets an instance of a property description interface for a specified property.<br/>                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandler**](https://msdn.microsoft.com/library/Bb776499(v=VS.85).aspx)                                       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandlerWithCreateObject**](https://msdn.microsoft.com/library/Bb776500(v=VS.85).aspx)       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetNamedPropertyFromPropertyStorage**](https://msdn.microsoft.com/library/Bb776501(v=VS.85).aspx)             | Gets a value from serialized property storage by property name.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSGetNameFromPropertyKey**](https://msdn.microsoft.com/library/Bb776502(v=VS.85).aspx)                                       | Retrieves the canonical name of the property, given its [**PROPERTYKEY**](https://msdn.microsoft.com/library/Bb773381(v=VS.85).aspx).<br/>                                                                                                                                                                                                                                                                                                     |
| [**PSGetPropertyDescription**](https://msdn.microsoft.com/library/Bb776503(v=VS.85).aspx)                                       | Gets an instance of a property description interface for a property specified by a [**PROPERTYKEY**](https://msdn.microsoft.com/library/Bb773381(v=VS.85).aspx) structure.<br/>                                                                                                                                                                                                                                                                |
| [**PSGetPropertyDescriptionByName**](https://msdn.microsoft.com/library/Bb776504(v=VS.85).aspx)                           | Gets an instance of a property description interface for a specified property name.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSGetPropertyDescriptionListFromString**](https://msdn.microsoft.com/library/Bb762079(v=VS.85).aspx)           | Gets an instance of a property description list interface for a specified property list.<br/>                                                                                                                                                                                                                                                                                                          |
| [**PSGetPropertyFromPropertyStorage**](https://msdn.microsoft.com/library/Bb762080(v=VS.85).aspx)                       | Gets the value of a property as stored in serialized property storage.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyKeyFromName**](https://msdn.microsoft.com/library/Bb762081(v=VS.85).aspx)                                       | Gets the property key for a canonical property name.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSGetPropertySystem**](https://msdn.microsoft.com/library/Bb762082(v=VS.85).aspx)                                                 | Gets an instance of the subsystem object that implements [**IPropertySystem**](https://msdn.microsoft.com/library/Bb761437(v=VS.85).aspx).<br/>                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyValue**](https://msdn.microsoft.com/library/Bb762083(v=VS.85).aspx)                                                   | Gets a property value from a property store.<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**PSLookupPropertyHandlerCLSID**](https://msdn.microsoft.com/library/Bb762084(v=VS.85).aspx)                               | Gets the class identifier (CLSID) of a per-computer, registered file property handler.<br/>                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_Delete**](https://msdn.microsoft.com/library/Ee845049(v=VS.85).aspx)                                              | Deletes a property from a property bag.<br/>                                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadBOOL**](https://msdn.microsoft.com/library/Ee845050(v=VS.85).aspx)                                          | Reads the **BOOL** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadBSTR**](https://msdn.microsoft.com/library/Ee845051(v=VS.85).aspx)                                          | Reads a **BSTR** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadDWORD**](https://msdn.microsoft.com/library/Ee845052(v=VS.85).aspx)                                        | Reads a **DWORD** data value from property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadGUID**](https://msdn.microsoft.com/library/Ee845053(v=VS.85).aspx)                                          | Reads the GUID data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadInt**](https://msdn.microsoft.com/library/Ee845054(v=VS.85).aspx)                                            | Reads a **int** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadLONG**](https://msdn.microsoft.com/library/Ee845055(v=VS.85).aspx)                                          | Reads a **long** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadPOINTL**](https://msdn.microsoft.com/library/Ee845056(v=VS.85).aspx)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPOINTS**](https://msdn.microsoft.com/library/Ee845057(v=VS.85).aspx)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPropertyKey**](https://msdn.microsoft.com/library/Ee845058(v=VS.85).aspx)                            | Reads the property key of a property in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**PSPropertyBag\_ReadRECTL**](https://msdn.microsoft.com/library/Ee845059(v=VS.85).aspx)                                        | Retrieves the coordinates of a rectangle stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_ReadSHORT**](https://msdn.microsoft.com/library/Ee845060(v=VS.85).aspx)                                        | Reads the **SHORT** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSPropertyBag\_ReadStr**](https://msdn.microsoft.com/library/Ee845061(v=VS.85).aspx)                                            | Reads the string data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadStrAlloc**](https://msdn.microsoft.com/library/Ee845062(v=VS.85).aspx)                                  | Retrieves details about the allocation or releasing of memory for a string that is stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadStream**](https://msdn.microsoft.com/library/Ee845063(v=VS.85).aspx)                                      | Reads the data stream stored in a given property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadType**](https://msdn.microsoft.com/library/Ee845064(v=VS.85).aspx)                                          | Reads the type of data value of a property that is stored in a property bag.<br/>                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadULONGLONG**](https://msdn.microsoft.com/library/Ee845065(v=VS.85).aspx)                                | Reads a **ULONGLONG** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**PSPropertyBag\_ReadUnknown**](https://msdn.microsoft.com/library/Ee845066(v=VS.85).aspx)                                    | Reads a given property of an unknown data value in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WriteBOOL**](https://msdn.microsoft.com/library/Ee845067(v=VS.85).aspx)                                        | Sets the **BOOL** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteBSTR**](https://msdn.microsoft.com/library/Ee845068(v=VS.85).aspx)                                        | Sets the **BSTR** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteDWORD**](https://msdn.microsoft.com/library/Ee845069(v=VS.85).aspx)                                      | Sets the **DWORD** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteGUID**](https://msdn.microsoft.com/library/Ee845070(v=VS.85).aspx)                                        | Sets the GUID value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_WriteInt**](https://msdn.microsoft.com/library/Ee845071(v=VS.85).aspx)                                          | Sets the **int** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_WriteLONG**](https://msdn.microsoft.com/library/Ee845072(v=VS.85).aspx)                                        | Sets the **long** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WritePOINTL**](https://msdn.microsoft.com/library/Ee845073(v=VS.85).aspx)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePOINTS**](https://msdn.microsoft.com/library/Ee845074(v=VS.85).aspx)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePropertyKey**](https://msdn.microsoft.com/library/Ee845075(v=VS.85).aspx)                          | Sets the property key value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_WriteRECTL**](https://msdn.microsoft.com/library/Ee845076(v=VS.85).aspx)                                      | Stores the coordinates of a rectangle in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteSHORT**](https://msdn.microsoft.com/library/Ee845077(v=VS.85).aspx)                                      | Sets the **SHORT** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteStr**](https://msdn.microsoft.com/library/Ee845078(v=VS.85).aspx)                                          | Sets the string value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteStream**](https://msdn.microsoft.com/library/Ee845079(v=VS.85).aspx)                                    | Writes a data stream to a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_WriteULONGLONG**](https://msdn.microsoft.com/library/Ee845080(v=VS.85).aspx)                              | Sets the **ULONGLONG** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_WriteUnknown**](https://msdn.microsoft.com/library/Ee845081(v=VS.85).aspx)                                  | Reads a property of an unknown data value in a property bag. <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyKeyFromString**](https://msdn.microsoft.com/library/Bb762085(v=VS.85).aspx)                                         | Converts a string to a [**PROPERTYKEY**](https://msdn.microsoft.com/library/Bb773381(v=VS.85).aspx) structure.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSRefreshPropertySchema**](https://msdn.microsoft.com/library/Bb762086(v=VS.85).aspx)                                         | Not currently supported.<br/>                                                                                                                                                                                                                                                                                                                                                                          |
| [**PSRegisterPropertySchema**](https://msdn.microsoft.com/library/Bb762087(v=VS.85).aspx)                                       | Informs the schema subsystem of the addition of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSSetPropertyValue**](https://msdn.microsoft.com/library/Bb762088(v=VS.85).aspx)                                                   | Sets the value of a property in a property store.<br/>                                                                                                                                                                                                                                                                                                                                                 |
| [**PSStringFromPropertyKey**](https://msdn.microsoft.com/library/Bb762089(v=VS.85).aspx)                                         | Creates a string that identifies a property from that property's key.<br/>                                                                                                                                                                                                                                                                                                                             |
| [**PSUnregisterPropertySchema**](https://msdn.microsoft.com/library/Bb762090(v=VS.85).aspx)                                   | Informs the schema subsystem of the removal of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                                |
| [**SHAddDefaultPropertiesByExt**](/windows/desktop/api/Shobjidl/nf-shobjidl-shadddefaultpropertiesbyext)                                   | Adds default properties to the property store as registered for the specified file extension.<br/>                                                                                                                                                                                                                                                                                                     |
| [**SHGetPropertyStoreForWindow**](/windows/desktop/api/Shellapi/nf-shellapi-shgetpropertystoreforwindow)                                   | Retrieves an object that represents a specific window's collection of properties, which allows those properties to be queried or set.<br/>                                                                                                                                                                                                                                                             |
| [**SHGetPropertyStoreFromIDList**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromidlist)                                 | Retrieves an object that supports [**IPropertyStore**](https://msdn.microsoft.com/library/Bb761474(v=VS.85).aspx) or related interfaces from a pointer to an item identifier list (PIDL).<br/>                                                                                                                                                                                                                                              |
| [**SHGetPropertyStoreFromParsingName**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromparsingname)                       | Returns a property store for an item, given a path or parsing name.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**SHPropStgCreate**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgcreate)                                                           | Ensures proper handling of code page retrieval or assignment for the requested property set operation.<br/>                                                                                                                                                                                                                                                                                            |
| [**SHPropStgReadMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgreadmultiple)                                               | Wraps the [**IPropertyStorage::ReadMultiple**](https://msdn.microsoft.com/en-us/library/Aa379975(v=VS.85).aspx) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                        |
| [**SHPropStgWriteMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgwritemultiple)                                             | Wraps the [**IPropertyStorage::WriteMultiple**](https://msdn.microsoft.com/en-us/library/Aa379985(v=VS.85).aspx) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                      |



 

## Related topics

<dl> <dt>

[Windows Properties](props.md)
</dt> <dt>

[Property Description Schema](property-description-schema.md)
</dt> <dt>

[Property Sets](property-sets.md)
</dt> <dt>

[Interfaces](interfaces.md)
</dt> <dt>

[Structures](structures.md)
</dt> <dt>

[Constants, Enumerations, and Flags](constants--enumerations--and-flags.md)
</dt> </dl>

 

 




