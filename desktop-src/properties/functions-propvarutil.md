---
Description: This section describes a set of Windows Shell conversion and helper functions used with PROPVARIANT and VARIANT types.
ms.assetid: 683fffb7-e8e8-4f7c-8312-5baef9b20641
title: PROPVARIANT and VARIANT Functions
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# PROPVARIANT and VARIANT Functions

This section describes a set of Windows Shell conversion and helper functions used with [**PROPVARIANT**](stg.propvariant) and [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) types.



| Topic                                                                                      | Contents                                                                                                                                                                                                                                          |
|--------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [ClearPropVariantArray](shell.ClearPropVariantArray)                                       | Frees the memory and references used by an array of [**PROPVARIANT**](stg.propvariant) structures stored in an array.                                                                                                                             |
| [ClearVariantArray](shell.ClearVariantArray)                                               | Frees the memory and references used by an array of [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structures stored in an array.                                                                                                            |
| [FreePropVariantArray](shell.FreePropVariantArray)                                         | Frees the memory and references used by an array of [**PROPVARIANT**](stg.propvariant) structures.                                                                                                                                                |
| [InitPropVariantFromBoolean](shell.InitPropVariantFromBoolean)                             | Initializes a given [**PROPVARIANT**](stg.propvariant) structure as a **VT\_BOOL** using a specified Boolean value.                                                                                                                               |
| [InitPropVariantFromBooleanVector](shell.InitPropVariantFromBooleanVector)                 | Initializes a [**PROPVARIANT**](stg.propvariant) structure from a specified Boolean vector.                                                                                                                                                       |
| [InitPropVariantFromBuffer](InitPropVariantFromBuffer)                                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure using the contents of a buffer.                                                                                                                                                        |
| [InitPropVariantFromCLSID](shell.InitPropVariantFromCLSID)                                 | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a class identifier (CLSID).                                                                                                                                                   |
| [InitPropVariantFromDouble](shell.InitPropVariantFromDouble)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified **double** value.                                                                                                                                                 |
| [InitPropVariantFromDoubleVector](shell.InitPropVariantFromDoubleVector)                   | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified vector of **double** values.                                                                                                                                      |
| [InitPropVariantFromFileTime](shell.InitPropVariantFromFileTime)                           | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on information stored in a [**FILETIME**](base.filetime_str) structure.                                                                                                          |
| [InitPropVariantFromFileTimeVector](shell.InitPropVariantFromFileTimeVector)               | Initializes a [**PROPVARIANT**](stg.propvariant) structure from a specified vector of [**FILETIME**](base.filetime_str) values.                                                                                                                   |
| [InitPropVariantFromGUIDAsBuffer](/windows/win32/Propvarutil/nf-propvarutil-initpropvariantfromguidasbuffer?branch=master)                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a **GUID**. The structure is initialized as **VT\_VECTOR** \| **VT\_UI1**.                                                                                                    |
| [InitPropVariantFromGUIDAsString](/windows/win32/Propvarutil/nf-propvarutil-initpropvariantfromguidasstring?branch=master)                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a **GUID**. The structure is initialized as **VT\_LPWSTR**.                                                                                                                   |
| [InitPropVariantFromInt16](shell.InitPropVariantFromInt16)                                 | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 16-bit integer value.                                                                                                                                                       |
| [InitPropVariantFromInt16Vector](shell.InitPropVariantFromInt16Vector)                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified vector of 16-bit integer values.                                                                                                                                  |
| [InitPropVariantFromInt32](shell.InitPropVariantFromInt32)                                 | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 32-bit integer value.                                                                                                                                                       |
| [InitPropVariantFromInt32Vector](shell.InitPropVariantFromInt32Vector)                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a vector of 32-bit integer values.                                                                                                                                            |
| [InitPropVariantFromInt64](shell.InitPropVariantFromInt64)                                 | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified **Int64** value.                                                                                                                                                  |
| [InitPropVariantFromInt64Vector](shell.InitPropVariantFromInt64Vector)                     | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a vector of **Int64** values.                                                                                                                                                 |
| [InitPropVariantFromPropVariantVectorElem](shell.InitPropVariantFromPropVariantVectorElem) | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified **PROPVARIANT** vector element.                                                                                                                                   |
| [InitPropVariantFromResource](shell.InitPropVariantFromResource)                           | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a string resource embedded in an executable file.                                                                                                                             |
| [InitPropVariantFromString](shell.InitPropVariantFromString)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified string.                                                                                                                                                           |
| [InitPropVariantFromStringAsVector](shell.InitPropVariantFromStringAsVector)               | Initializes a [**PROPVARIANT**](stg.propvariant) structure from a specified string. The string is parsed as a semi-colon delimited list (for example: "A;B;C").                                                                                   |
| [InitPropVariantFromStringVector](shell.InitPropVariantFromStringVector)                   | Initializes a [**PROPVARIANT**](stg.propvariant) structure from a specified string vector.                                                                                                                                                        |
| [InitPropVariantFromStrRet](shell.InitPropVariantFromStrRet)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a string stored in a [**STRRET**](shell.STRRET) structure.                                                                                                                    |
| [InitPropVariantFromUInt16](shell.InitPropVariantFromUInt16)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 16-bit unsigned integer value.                                                                                                                                              |
| [InitPropVariantFromUInt16Vector](shell.InitPropVariantFromUInt16Vector)                   | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a vector of 16-bit unsigned integer values.                                                                                                                                   |
| [InitPropVariantFromUInt32](shell.InitPropVariantFromUInt32)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 32-bit unsigned integer value.                                                                                                                                              |
| [InitPropVariantFromUInt32Vector](shell.InitPropVariantFromUInt32Vector)                   | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a vector of 32-bit unsigned integer values.                                                                                                                                   |
| [InitPropVariantFromUInt64](shell.InitPropVariantFromUInt16)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure with a 64-bit unsigned integer value.                                                                                                                                                  |
| [InitPropVariantFromUInt64Vector](shell.InitPropVariantFromUInt64Vector)                   | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a vector of 64-bit unsigned integers.                                                                                                                                         |
| [InitPropVariantVectorFromPropVariant](shell.InitPropVariantVectorFromPropVariant)         | Initializes a vector element in a [**PROPVARIANT**](stg.propvariant) structure with a value stored in another **PROPVARIANT**.                                                                                                                    |
| [InitVariantFromBoolean](shell.InitVariantFromBoolean)                                     | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a Boolean value.                                                                                                                                                 |
| [InitVariantFromBooleanArray](shell.InitVariantFromBooleanArray)                           | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure from an array of Boolean values.                                                                                                                                      |
| [InitVariantFromBuffer](shell.InitVariantFromBuffer)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with the contents of a buffer.                                                                                                                                        |
| [InitVariantFromDispatch](shell.InitVariantFromDispatch)                                   | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure based on an instance of an [**IDispatch**](ebbff4bc-36b2-4861-9efa-ffa45e013eb5) object.                                                                              |
| [InitVariantFromDosDateTime](shell.InitVariantFromDosDateTime)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a date and time given in the format used by Microsoft MS-DOS. The date and time values are converted to the format used to store date and time in a **VARIANT**. |
| [InitVariantFromDouble](shell.InitVariantFromDouble)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a value of type **DOUBLE**.                                                                                                                                      |
| [InitVariantFromDoubleArray](shell.InitVariantFromDoubleArray)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of values of type **DOUBLE**.                                                                                                                           |
| [InitVariantFromFileTime](shell.InitVariantFromFileTime)                                   | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with the contents of a [**FILETIME**](base.filetime_str) structure.                                                                                                   |
| [InitVariantFromFileTimeArray](shell.InitVariantFromFileTimeArray)                         | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of [**FILETIME**](base.filetime_str) structures.                                                                                                        |
| [InitVariantFromGUIDAsBuffer](shell.InitVariantFromGUIDAsBuffer)                           | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure based on a **GUID**. The structure is initialized as **VT\_ARRAY** \| **VT\_UI1**.                                                                                    |
| [InitVariantFromInt16](shell.InitVariantFromInt16)                                         | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 16-bit integer value.                                                                                                                                                       |
| [InitVariantFromInt16Array](shell.InitVariantFromInt16Array)                               | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of 16-bit integer values.                                                                                                                               |
| [InitVariantFromInt32](shell.InitVariantFromInt32)                                         | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 32-bit integer value.                                                                                                                                                       |
| [InitVariantFromInt32Array](shell.InitVariantFromInt32Array)                               | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of 32-bit integer values.                                                                                                                               |
| [InitVariantFromInt64](shell.InitVariantFromInt64)                                         | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a 64-bit integer value.                                                                                                                                          |
| [InitVariantFromInt64Array](shell.InitVariantFromInt64Array)                               | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of 64-bit integer values.                                                                                                                               |
| [InitVariantFromResource](shell.InitVariantFromResource)                                   | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure based on a string resource imbedded in an executable file.                                                                                                            |
| [InitVariantFromString](shell.InitVariantFromString)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a string.                                                                                                                                                        |
| [InitVariantFromStringArray](shell.InitVariantFromStringArray)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of strings.                                                                                                                                             |
| [InitVariantFromStrRet](shell.InitVariantFromStrRet)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a string stored in a [**STRRET**](shell.STRRET) structure.                                                                                                       |
| [InitVariantFromUInt16](shell.InitVariantFromUInt16)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an unsigned 16-bit integer value.                                                                                                                                |
| [InitVariantFromUInt16Array](shell.InitVariantFromUInt16Array)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of unsigned 16-bit integer values.                                                                                                                      |
| [InitVariantFromUInt32](shell.InitVariantFromUInt32)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an unsigned 32-bit integer value.                                                                                                                                |
| [InitVariantFromUInt32Array](shell.InitVariantFromUInt32Array)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an array of unsigned 32-bit integer values.                                                                                                                      |
| [InitVariantFromUInt64](shell.InitVariantFromUInt64)                                       | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an unsigned 64-bit integer value.                                                                                                                                |
| [InitVariantFromUInt64Array](shell.InitVariantFromUInt16Array)                             | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with an unsigned 64-bit integer value.                                                                                                                                |
| [InitVariantFromVariantArrayElem](shell.InitVariantFromVariantArrayElem)                   | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure with a value stored in another **VARIANT** structure.                                                                                                                 |
| [IsPropVariantString](shell.IsPropVariantString)                                           | Specifies whether a specified [**PROPVARIANT**](stg.propvariant) structure is a string type.                                                                                                                                                      |
| [IsPropVariantVector](shell.IsPropVariantVector)                                           | Specifies whether a [**PROPVARIANT**](stg.propvariant) structure has a vector type.                                                                                                                                                               |
| [IsVariantArray](shell.IsVariantArray)                                                     | Specifies whether a variant is an array.                                                                                                                                                                                                          |
| [IsVariantString](shell.IsVariantString)                                                   | Specifies whether a variant is a string.                                                                                                                                                                                                          |
| [IsVarTypeFloat](shell.IsVarTypeFloat)                                                     | Returns whether a [**VARTYPE**](317b911b-1805-402d-a9cb-159546bc88b4) is a float.                                                                                                                                                                 |
| [IsVarTypeInteger](shell.IsVarTypeInteger)                                                 | Returns whether a [**VARTYPE**](317b911b-1805-402d-a9cb-159546bc88b4) is an integer.                                                                                                                                                              |
| [IsVarTypeNumber](shell.IsVarTypeNumber)                                                   | Specifies whether [**VARTYPE**](317b911b-1805-402d-a9cb-159546bc88b4) is a number.                                                                                                                                                                |
| [IsVarTypeSignedInteger](shell.IsVarTypeSignedInteger)                                     | Returns whether a [**VARTYPE**](317b911b-1805-402d-a9cb-159546bc88b4) is a signed integer.                                                                                                                                                        |
| [IsVarTypeUnsignedInteger](shell.IsVarTypeUnsignedInteger)                                 | Returns whether a [**VARTYPE**](317b911b-1805-402d-a9cb-159546bc88b4) is an unsigned integer.                                                                                                                                                     |
| [PropVariantChangeType](shell.PropVariantChangeType)                                       | Coerces a value stored as a [**PROPVARIANT**](stg.propvariant) structure to an equivalent value of a different variant type.                                                                                                                      |
| [PropVariantClear](shell.PropVariantClear)                                                 | Clears a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                                            |
| [PropVariantCompare](shell.PropVariantCompare)                                             | Compares two [**PROPVARIANT**](stg.propvariant) structures, based on default comparison units and settings.                                                                                                                                       |
| [PropVariantCompareEx](shell.PropVariantCompareEx)                                         | Extends [**PropVariantCompare**](shell.PropVariantCompare) by allowing the caller to compare two [**PROPVARIANT**](stg.propvariant) structures based on specified comparison units and flags.                                                     |
| [PropVariantCopy](shell.PropVariantCopy)                                                   | Creates a copy of a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                                 |
| [PropVariantGetBooleanElem](shell.PropVariantGetBooleanElem)                               | Extracts a single Boolean element from a [**PROPVARIANT**](stg.propvariant) structure of type `VT_BOOL`, `VT_VECTOR | VT_BOOL`, or `VT_ARRAY | VT_BOOL`.                                                                                          |
| [PropVariantGetDoubleElem](shell.PropVariantGetDoubleElem)                                 | Extracts a single **double** element from a [**PROPVARIANT**](stg.propvariant) structure of type `VT_R8`, `VT_VECTOR | VT_R8`, or `VT_ARRAY | VT_R8`.                                                                                             |
| [PropVariantGetElem](shell.PropVariantGetElem)                                             | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a specified element in another **PROPVARIANT** structure.                                                                                                                     |
| [PropVariantGetElementCount](shell.PropVariantGetElementCount)                             | Retrieves the element count of a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                    |
| [PropVariantGetFileTimeElem](shell.PropVariantGetFileTimeElem)                             | Extracts a single [**FILETIME**](base.filetime_str) element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_FILETIME, VT\_VECTOR \| VT\_FILETIME, or VT\_ARRAY \| VT\_FILETIME.                                                   |
| [PropVariantGetInt16Elem](shell.PropVariantGetInt16Elem)                                   | Extracts a single Int16 element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_I2, VT\_VECTOR \| VT\_I2, or VT\_ARRAY \| VT\_I2.                                                                                                 |
| [PropVariantGetInt32Elem](shell.PropVariantGetInt32Elem)                                   | Extracts a single Int32 element from a [**PROPVARIANT**](stg.propvariant) of type VT\_I4, VT\_VECTOR \| VT\_I4, or VT\_ARRAY \| VT\_I4.                                                                                                           |
| [PropVariantGetInt64Elem](shell.PropVariantGetInt64Elem)                                   | Extracts a single **Int64** element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_I8, VT\_VECTOR \| VT\_I8, or VT\_ARRAY \| VT\_I8.                                                                                             |
| [PropVariantGetStringElem](shell.PropVariantGetStringElem)                                 | Extracts a single Unicode string element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_LPWSTR, VT\_BSTR, VT\_VECTOR \| VT\_LPWSTR, VT\_VECTOR \| VT\_BSTR, or VT\_ARRAY \| VT\_BSTR.                                            |
| [PropVariantGetUInt16Elem](shell.PropVariantGetUInt16Elem)                                 | Extracts a single unsigned Int16 element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_U12, VT\_VECTOR \| VT\_U12, or VT\_ARRAY \| VT\_U12.                                                                                     |
| [PropVariantGetUInt32Elem](shell.PropVariantGetUInt32Elem)                                 | Extracts a single unsigned Int32 element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_UI4, VT\_VECTOR \| VT\_UI4, or VT\_ARRAY \| VT\_UI4.                                                                                     |
| [PropVariantGetUInt64Elem](shell.PropVariantGetUInt64Elem)                                 | Extracts a single unsigned **Int64** element from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_UI8, VT\_VECTOR \| VT\_UI8, or VT\_ARRAY \| VT\_UI8.                                                                                 |
| [PropVariantToBoolean](shell.PropVariantToBoolean)                                         | Extracts a Boolean property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                              |
| [PropVariantToBooleanVector](shell.PropVariantToBooleanVector)                             | Extracts a Boolean vector from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                    |
| [PropVariantToBooleanVectorAlloc](shell.PropVariantToBooleanVectorAlloc)                   | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly allocated Boolean vector.                                                                                                                                          |
| [PropVariantToBooleanWithDefault](shell.PropVariantToBooleanWithDefault)                   | Extracts the Boolean property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then the specified default value is returned.                                                                                          |
| [PropVariantToBSTR](shell.PropVariantToBSTR)                                               | Extracts the BSTR property value of a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                               |
| [PropVariantToBuffer](shell.PropVariantToBuffer)                                           | Extracts the buffer value from a [**PROPVARIANT**](stg.propvariant) structure of type VT\_VECTOR \| VT\_UI1 or VT\_ARRRAY \| VT\_UI1.                                                                                                             |
| [PropVariantToCLSID](shell.PropVariantToCLSID)                                             | Extracts CLSID property value of a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                  |
| [PropVariantToDouble](shell.PropVariantToDouble)                                           | Extracts double value from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                        |
| [PropVariantToDoubleVector](shell.PropVariantToDoubleVector)                               | Extracts a vector of doubles from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                 |
| [PropVariantToDoubleVectorAlloc](shell.PropVariantToDoubleVectorAlloc)                     | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated double vector.                                                                                                                                           |
| [PropVariantToDoubleWithDefault](shell.PropVariantToDoubleWithDefault)                     | Extracts a double property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then the specified default value is returned.                                                                                             |
| [PropVariantToFileTime](shell.PropVariantToFileTime)                                       | Extracts the [**FILETIME**](base.filetime_str) structure from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                     |
| [PropVariantToFileTimeVector](shell.PropVariantToFileTimeVector)                           | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a FILETIME vector.                                                                                                                                                         |
| [PropVariantToFileTimeVectorAlloc](shell.PropVariantToFileTimeVectorAlloc)                 | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated FILETIME vector.                                                                                                                                         |
| [PropVariantToGUID](shell.PropVariantToGUID)                                               | Extracts a GUID value from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                        |
| [PropVariantToInt16](shell.PropVariantToInt16)                                             | Extracts an **Int16** property value of a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                           |
| [PropVariantToInt16Vector](shell.PropVariantToInt16Vector)                                 | Extracts a vector of **Int16** values from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                        |
| [PropVariantToInt16VectorAlloc](shell.PropVariantToInt16VectorAlloc)                       | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly allocated **Int16** vector.                                                                                                                                        |
| [PropVariantToInt16WithDefault](shell.PropVariantToInt16WithDefault)                       | Extracts the **Int16** property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value currently exists, then specified default value is returned.                                                                                  |
| [PropVariantToInt32](shell.PropVariantToInt32)                                             | Extracts the **Int32** property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                          |
| [PropVariantToInt32Vector](shell.PropVariantToInt32Vector)                                 | Extracts a vector of **long** values from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                         |
| [PropVariantToInt32VectorAlloc](shell.PropVariantToInt32VectorAlloc)                       | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated **Int32** vector.                                                                                                                                        |
| [PropVariantToInt32WithDefault](shell.PropVariantToInt32WithDefault)                       | Extracts a **ULONG** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then a specified default value is returned.                                                                                                   |
| [PropVariantToInt64](shell.PropVariantToInt64)                                             | Extracts a **LONGLONG** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                                |
| [PropVariantToInt64Vector](shell.PropVariantToInt64Vector)                                 | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into an **Int64** vector.                                                                                                                                                       |
| [PropVariantToInt64VectorAlloc](shell.PropVariantToInt64VectorAlloc)                       | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated **LONGLONG** vector.                                                                                                                                     |
| [PropVariantToInt64WithDefault](shell.PropVariantToInt64WithDefault)                       | Extracts the **Int64** property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then specified default value is returned.                                                                                            |
| [PropVariantToString](shell.PropVariantToString)                                           | Extracts a string value from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                      |
| [PropVariantToStringAlloc](shell.PropVariantToStringAlloc)                                 | Extracts a string property value from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                             |
| [PropVariantToStringVector](shell.PropVariantToStringVector)                               | Extracts a vector of strings from a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                                                                                 |
| [PropVariantToStringVectorAlloc](shell.PropVariantToStringVectorAlloc)                     | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly allocated strings in a newly allocated vector.                                                                                                                     |
| [PropVariantToStringWithDefault](shell.PropVariantToStringWithDefault)                     | Extracts the string property value of a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then the specified default value is returned.                                                                                           |
| [PropVariantToStrRet](shell.PropVariantToStrRet)                                           | Extracts a string from a [**PROPVARIANT**](stg.propvariant) structure and places it into a [**STRRET**](shell.STRRET) structure.                                                                                                                  |
| [PropVariantToUInt16](shell.PropVariantToUInt16)                                           | Extracts a **unsigned short** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                          |
| [PropVariantToUInt16Vector](shell.PropVariantToUInt16Vector)                               | Initializes a [**PROPVARIANT**](stg.propvariant) structure based on a 16-bit unsigned integer value.                                                                                                                                              |
| [PropVariantToUInt16VectorAlloc](shell.PropVariantToUInt16VectorAlloc)                     | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into an **unsigned short** vector.                                                                                                                                              |
| [PropVariantToUInt16WithDefault](shell.PropVariantToUInt16WithDefault)                     | Extracts an **unsigned short** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then the specified default value is returned.                                                                                       |
| [PropVariantToUInt32](shell.PropVariantToUInt32)                                           | Extracts an **ULONG** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                                  |
| [PropVariantToUInt32Vector](shell.PropVariantToUInt32Vector)                               | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into an **ULONG** vector.                                                                                                                                                       |
| [PropVariantToUInt32VectorAlloc](shell.PropVariantToUInt32VectorAlloc)                     | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated **ULONG** vector.                                                                                                                                        |
| [PropVariantToUInt32WithDefault](shell.PropVariantToUInt32WithDefault)                     | Extracts a **ULONG** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then a specified default value is returned.                                                                                                   |
| [PropVariantToUInt64](shell.PropVariantToUInt64)                                           | Extracts a **UInt64** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value can be extracted, then a default value is assigned.                                                                                                  |
| [PropVariantToUInt64Vector](shell.PropVariantToUInt64Vector)                               | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a **ULONGLONG** vector.                                                                                                                                                    |
| [PropVariantToUInt64VectorAlloc](shell.PropVariantToUInt64VectorAlloc)                     | Extracts data from a [**PROPVARIANT**](stg.propvariant) structure into a newly-allocated **ULONGLONG** vector.                                                                                                                                    |
| [PropVariantToUInt64WithDefault](shell.PropVariantToUInt64WithDefault)                     | Extracts **ULONGLONG** value from a [**PROPVARIANT**](stg.propvariant) structure. If no value exists, then the specified default value is returned.                                                                                               |
| [PropVariantToVariant](shell.PropVariantToVariant)                                         | Converts the contents of a [**PROPVARIANT**](stg.propvariant) structure to a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure.                                                                                                       |
| [StgDeserializePropVariant](shell.StgDeserializePropVariant)                               | Deserializes a specified [**SERIALIZEDPROPERTYVALUE**](shell.SERIALIZEDPROPERTYVALUE) structure, creating a [**PROPVARIANT**](stg.propvariant) structure.                                                                                         |
| [StgSerializePropVariant](shell.StgSerializePropVariant)                                   | Serializes a specified [**PROPVARIANT**](stg.propvariant) structure, creating a [**SERIALIZEDPROPERTYVALUE**](shell.SERIALIZEDPROPERTYVALUE) structure.                                                                                           |
| [VariantCompare](shell.VariantCompare)                                                     | Compares two variant structures, based on default comparison rules.                                                                                                                                                                               |
| [VariantGetBooleanElem](shell.VariantGetBooleanElem)                                       | Extracts a single Boolean element from a variant structure.                                                                                                                                                                                       |
| [VariantGetDoubleElem](shell.VariantGetDoubleElem)                                         | Extracts one **double** element from a variant structure.                                                                                                                                                                                         |
| [VariantGetElem](shell.VariantGetElem)                                                     | Initializes a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure from a specified variant element.                                                                                                                                     |
| [VariantGetElementCount](shell.VariantGetElementCount)                                     | Retrieves the element count of a variant structure.                                                                                                                                                                                               |
| [VariantGetInt16Elem](shell.VariantGetInt16Elem)                                           | Extracts a single **Int16** element from a variant structure.                                                                                                                                                                                     |
| [VariantGetInt32Elem](shell.VariantGetInt32Elem)                                           | Extracts a single **Int32** element from a variant structure.                                                                                                                                                                                     |
| [VariantGetInt64Elem](shell.VariantGetInt64Elem)                                           | Extracts a single **Int64** element from a variant structure.                                                                                                                                                                                     |
| [VariantGetStringElem](shell.VariantGetStringElem)                                         | Extracts a single wide string element from a variant structure.                                                                                                                                                                                   |
| [VariantGetUInt16Elem](shell.VariantGetUInt16Elem)                                         | Extracts a single unsigned **Int16** element from a variant structure.                                                                                                                                                                            |
| [VariantGetUInt32Elem](shell.VariantGetUInt32Elem)                                         | Extracts a single unsigned **Int32** element from a variant structure.                                                                                                                                                                            |
| [VariantGetUInt64Elem](shell.VariantGetUInt64Elem)                                         | Extracts a single unsigned **Int64** element from a variant structure.                                                                                                                                                                            |
| [VariantToBoolean](shell.VariantToBoolean)                                                 | Extracts the value of a Boolean property from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure. If no value can be extracted, then a default value is assigned.                                                                    |
| [VariantToBooleanArray](shell.VariantToBooleanArray)                                       | Extracts an array of Boolean values from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure.                                                                                                                                         |
| [VariantToBooleanArrayAlloc](shell.VariantToBooleanArrayAlloc)                             | Allocates an array of **BOOL** values then extracts data from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure into that array.                                                                                                    |
| [VariantToBooleanWithDefault](shell.VariantToBooleanWithDefault)                           | Extracts a **BOOL** value from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure. If no value exists, then the specified default value is returned.                                                                                 |
| [VariantToBuffer](shell.VariantToBuffer)                                                   | Extracts the contents of a buffer stored in a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure of type VT\_ARRRAY \| VT\_UI1.                                                                                                        |
| [VariantToDosDateTime](shell.VariantToDosDateTime)                                         | Extracts a date and time value in MS-DOS format from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure.                                                                                                                             |
| [VariantToDouble](shell.VariantToDouble)                                                   | Extracts a **DOUBLE** value from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure. If no value can be extracted, then a default value is assigned.                                                                                 |
| [VariantToDoubleArray](shell.VariantToDoubleArray)                                         | Extracts an array of **DOUBLE** values from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure.                                                                                                                                      |
| [VariantToDoubleArrayAlloc](shell.VariantToDoubleArrayAlloc)                               | Allocates an array of **DOUBLE** values then extracts data from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure into that array.                                                                                                  |
| [VariantToDoubleWithDefault](shell.VariantToDoubleWithDefault)                             | Extracts a **DOUBLE** value from a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure. If no value exists, then the specified default value is returned.                                                                               |
| [VariantToFileTime](shell.VariantToFileTime)                                               | Extracts a [**FILETIME**](base.filetime_str) structure from a variant structure.                                                                                                                                                                  |
| [VariantToGUID](shell.VariantToGUID)                                                       | Extracts a **GUID** property value of a variant structure.                                                                                                                                                                                        |
| [VariantToInt16](shell.VariantToInt16)                                                     | Extracts an unsigned **Int16** property value of a variant structure. If no value can be extracted, then a default value is assigned by this function.                                                                                            |
| [VariantToInt16Array](shell.VariantToInt16Array)                                           | Extracts data from a vector structure into an **Int16** array.                                                                                                                                                                                    |
| [VariantToInt16ArrayAlloc](shell.VariantToInt16ArrayAlloc)                                 | Extracts data from a vector structure into a newly-allocated **Int16** array.                                                                                                                                                                     |
| [VariantToInt16WithDefault](shell.VariantToInt16WithDefault)                               | Extracts an **Int16** property value of a variant structure. If no value exists, then the specified default value is returned.                                                                                                                    |
| [VariantToInt32](shell.VariantToInt32)                                                     | Extracts an **Int32** property value of a variant structure. If no value can be extracted, then a default value is assigned.                                                                                                                      |
| [VariantToInt32Array](shell.VariantToInt32Array)                                           | Extracts data from a vector structure into an **Int32** array.                                                                                                                                                                                    |
| [VariantToInt32ArrayAlloc](shell.VariantToInt32ArrayAlloc)                                 | Extracts data from a vector structure into a newly-allocated **Int32** array.                                                                                                                                                                     |
| [VariantToInt32WithDefault](shell.VariantToInt32WithDefault)                               | Extracts an **Int32** property value of a variant structure. If no value exists, then the specified default value is returned.                                                                                                                    |
| [VariantToInt64](shell.VariantToInt64)                                                     | Extracts an **Int64** property value of a variant structure. If no value can be extracted, then a default value is assigned.                                                                                                                      |
| [VariantToInt64Array](shell.VariantToInt64Array)                                           | Extracts data from a vector structure into an **Int64** array.                                                                                                                                                                                    |
| [VariantToInt64ArrayAlloc](shell.VariantToInt64ArrayAlloc)                                 | Extracts data from a vector structure into a newly-allocated **Int64** array.                                                                                                                                                                     |
| [VariantToInt64WithDefault](shell.VariantToInt64WithDefault)                               | Extracts an **Int64** property value of a variant structure. If no value exists, then the specified default value is returned.                                                                                                                    |
| [VariantToPropVariant](shell.VariantToPropVariant)                                         | Copies the contents of a [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) structure to a [**PROPVARIANT**](stg.propvariant) structure.                                                                                                         |
| [VariantToString](shell.VariantToString)                                                   | Extracts the variant value of a variant structure to a string. If no value can be extracted, then a default value is assigned.                                                                                                                    |
| [VariantToStringAlloc](shell.VariantToStringAlloc)                                         | Extracts the variant value of a variant structure to a newly-allocated string. If no value can be extracted, then a default value is assigned.                                                                                                    |
| [VariantToStringArray](shell.VariantToStringArray)                                         | Extracts data from a vector structure into a string array.                                                                                                                                                                                        |
| [VariantToStringArrayAlloc](shell.VariantToStringArrayAlloc)                               | Extracts data from a vector structure into a newly-allocated string array.                                                                                                                                                                        |
| [VariantToStringWithDefault](shell.VariantToStringWithDefault)                             | Extracts the string property value of a variant structure. If no value exists, then the specified default value is returned.                                                                                                                      |
| [VariantToStrRet](shell.VariantToStrRet)                                                   | If the source variant is a **VT\_BSTR**, extracts string and places it into a [**STRRET**](shell.STRRET) structure.                                                                                                                               |
| [VariantToUInt16](shell.VariantToUInt16)                                                   | Extracts an unsigned **Int16** property value of a variant structure. If no value can be extracted, then a default value is assigned by this function.                                                                                            |
| [VariantToUInt16Array](shell.VariantToUInt16Array)                                         | Extracts data from a vector structure into an unsigned **Int16** array.                                                                                                                                                                           |
| [VariantToUInt16ArrayAlloc](shell.VariantToUInt16ArrayAlloc)                               | Extracts data from a vector structure into a newly-allocated unsigned **Int16** array.                                                                                                                                                            |
| [VariantToUInt16WithDefault](shell.VariantToUInt16WithDefault)                             | Extracts an unsigned **Int16** property value of a variant structure. If no value exists, then the specified default value is returned.                                                                                                           |
| [VariantToUInt32](shell.VariantToUInt32)                                                   | Extracts unsigned **Int32** property value of a variant structure. If no value can be extracted, then a default value is assigned.                                                                                                                |
| [VariantToUInt32Array](shell.VariantToUInt32Array)                                         | Extracts data from a vector structure into an unsigned **Int32** array.                                                                                                                                                                           |
| [VariantToUInt32ArrayAlloc](shell.VariantToUInt32ArrayAlloc)                               | Extracts data from a vector structure into a newly-allocated unsigned **Int32** array.                                                                                                                                                            |
| [VariantToUInt32WithDefault](shell.VariantToUInt32WithDefault)                             | Extracts an unsigned **Int32** property value of a variant structure. If no value currently exists, then the specified default value is returned.                                                                                                 |
| [VariantToUInt64](shell.VariantToUInt64)                                                   | Extracts unsigned **Int64** property value of a variant structure. If no value can be extracted, then a default value is assigned.                                                                                                                |
| [VariantToUInt64Array](shell.VariantToUInt64Array)                                         | Extracts data from a vector structure into an unsigned **Int64** array.                                                                                                                                                                           |
| [VariantToUInt64ArrayAlloc](shell.VariantToUInt64ArrayAlloc)                               | Extracts data from a vector structure into a newly-allocated unsigned **Int64** array.                                                                                                                                                            |
| [VariantToUInt64WithDefault](shell.VariantToUInt64WithDefault)                             | Extracts an unsigned **Int64** property value of a variant structure. If no value currently exists, then the specified default value is returned.                                                                                                 |





## Related topics

<dl> <dt>

[Property Bag Functions](property-bag-functions.md)
</dt> <dt>

[Functions](functions.md)
</dt> </dl>







