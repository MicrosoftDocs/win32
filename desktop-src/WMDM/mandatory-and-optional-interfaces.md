---
title: Mandatory and Optional Interfaces
description: Mandatory and Optional Interfaces
ms.assetid: '582c9dd5-f8ab-48df-afb3-fba931ee0dea'
keywords: ["Windows Media Device Manager,interfaces", "Device Manager,interfaces", "programming guide,interfaces", "service providers,interfaces", "creating service providers,interfaces", "interfaces"]
---

# Mandatory and Optional Interfaces

The following table describes the mandatory and optional interfaces and methods for service providers to implement. All the interfaces with one or more mandatory methods must be implemented. A mandatory method cannot return WMDM\_E\_NOTSUPPORTED or E\_NOTIMPL.



| Interface and method                                                                                                                  | Implementation option                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMDServiceProvider::EnumDevices**](imdserviceprovider-enumdevices.md)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider::GetDeviceCount**](imdserviceprovider-getdevicecount.md)                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider2::CreateDevice**](imdserviceprovider2-createdevice.md)                                                         | Optional. This method must be implemented for PnP and Windows Explorer support.                                                                                                                                                                    |
| [**IMDSPDevice::EnumStorage**](imdspdevice-enumstorage.md)                                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetDeviceIcon**](imdspdevice-getdeviceicon.md)                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetFormatSupport**](imdspdevice-getformatsupport.md)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetManufacturer**](imdspdevice-getmanufacturer.md)                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetName**](imdspdevice-getname.md)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetPowerSource**](imdspdevice-getpowersource.md)                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::GetSerialNumber**](imdspdevice-getserialnumber.md)                                                                   | Optional. For protected content transfer, Windows Media Device Manager uses **IMDSPStorageGlobals::GetSerialNumber**.                                                                                                                              |
| [**IMDSPDevice::GetStatus**](imdspdevice-getstatus.md)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetType**](imdspdevice-gettype.md)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetVersion**](imdspdevice-getversion.md)                                                                             | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::SendOpaqueCommand**](imdspdevice-sendopaquecommand.md)                                                               | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetCanonicalName**](imdspdevice2-getcanonicalname.md)                                                               | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetFormatSupport2**](imdspdevice2-getformatsupport2.md)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice2::GetSpecifyPropertyPages**](imdspdevice2-getspecifypropertypages.md)                                                 | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetStorage**](imdspdevice2-getstorage.md)                                                                           | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDeviceControl Interface**](imdspdevicecontrol.md)                                                                            | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPEnumDevice::Clone**](imdspenumdevice-clone.md)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Next**](imdspenumdevice-next.md)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Reset**](imdspenumdevice-reset.md)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Skip**](imdspenumdevice-skip.md)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Clone**](imdspenumstorage-clone.md)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Next**](imdspenumstorage-next.md)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Reset**](imdspenumstorage-reset.md)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Skip**](imdspenumstorage-skip.md)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Close**](imdspobject-close.md)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Delete**](imdspobject-delete.md)                                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Move**](imdspobject-move.md)                                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Open**](imdspobject-open.md)                                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Read**](imdspobject-read.md)                                                                                         | Mandatory (if Windows Media Player support is desired).                                                                                                                                                                                            |
| [**IMDSPObject::Rename**](imdspobject-rename.md)                                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Seek**](imdspobject-seek.md)                                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Write**](imdspobject-write.md)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObjectInfo Interface**](imdspobjectinfo.md)                                                                                  | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPRevoked Interface**](imdsprevoked.md)                                                                                        | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::CreateStorage**](imdspstorage-createstorage.md)                                                                     | Mandatory only if *dwAttributes* is WMDM\_FILE\_ATTR\_FILE.                                                                                                                                                                                        |
| [**IMDSPStorage::EnumStorage**](imdspstorage-enumstorage.md)                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetAttributes**](imdspstorage-getattributes.md)                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetDate**](imdspstorage-getdate.md)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetName**](imdspstorage-getname.md)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetRights**](imdspstorage-getrights.md)                                                                             | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::GetSize**](imdspstorage-getsize.md)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetStorageGlobals**](imdspstorage-getstorageglobals.md)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::SendOpaqueCommands**](imdspstorage-sendopaquecommands.md)                                                           | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::SetAttributes**](imdspstorage-setattributes.md)                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::CreateStorage2**](imdspstorage2-createstorage2.md)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetAttributes2**](imdspstorage2-getattributes2.md)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetStorage**](imdspstorage2-getstorage.md)                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::SetAttributes2**](imdspstorage2-setattributes2.md)                                                                 | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage3 Interface**](imdspstorage3.md)                                                                                      | Optional. However, if the device parameter *UseMetadataViews* is set to 1, this interface must be implemented, and **IMDSPStorage3::GetMetadata** becomes mandatory, although **IMDSPStorage3::SetMetadata** is still optional.                    |
| [**IMDSPStorageGlobals::GetCapabilities**](imdspstorageglobals-getcapabilities.md)                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetDevice**](imdspstorageglobals-getdevice.md)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetRootStorage**](imdspstorageglobals-getrootstorage.md)                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetSerialNumber**](imdspstorageglobals-getserialnumber.md)                                                   | Mandatory for PDDRM only. Optional otherwise.                                                                                                                                                                                                      |
| [**IMDSPStorageGlobals::GetStatus**](imdspstorageglobals-getstatus.md)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalBad**](imdspstorageglobals-gettotalbad.md)                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalFree**](imdspstorageglobals-gettotalfree.md)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalSize**](imdspstorageglobals-gettotalsize.md)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::Initialize**](imdspstorageglobals-initialize.md)                                                             | Optional. This method should be implemented if the device supports this functionality. If this method is not implemented, **IMDSPStorageGlobals::GetCapabilites** must return WMDM\_STORAGECAP\_NOT\_INITIALIZABLE in addition to any other flags. |
| [**IMDSPDevice3**](imdspdevice3.md)[**IMDSPObject2**](imdspobject2.md)<br/> [**IMDSPStorage4**](imdspstorage4.md)<br/> | Required to support automatic synchronization with Windows Media Player                                                                                                                                                                            |



 

## Related topics

<dl> <dt>

[**Creating a Service Provider**](creating-a-service-provider.md)
</dt> </dl>

 

 





