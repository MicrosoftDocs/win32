---
description: There have been significant changes to the services model to improve performance, reliability, security, management, and administration of services.
ms.assetid: b1c09468-51e1-4ffd-bf07-6faa9f9336dd
title: Service Changes for Windows Vista
ms.topic: article
ms.date: 05/31/2018
---

# Service Changes for Windows Vista

There have been significant changes to the services model to improve performance, reliability, security, management, and administration of services.

The following table summarizes the enhancements to services for Windows Vista.



| Enhancement                                                                                                                                                                                                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="Delayed_Auto-Start"></span><span id="delayed_auto-start"></span><span id="DELAYED_AUTO-START"></span>Delayed Auto-Start<br/>                                                                 | Delayed auto-start services are started shortly after the system has started. This improves system startup performance while still providing automatic startup for these services. To set the delayed auto-start flag, call the [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) function with **SERVICE\_CONFIG\_DELAYED\_AUTO\_START\_INFO**.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span id="Failure_Detection_and_Recovery"></span><span id="failure_detection_and_recovery"></span><span id="FAILURE_DETECTION_AND_RECOVERY"></span>Failure Detection and Recovery<br/>                 | If a service fails, the service control manager (SCM) can perform a failure action, such as restarting the service in an attempt to recover from that failure. To configure a failure action, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_FAILURE\_ACTIONS**.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span id="Preshutdown_Notifications"></span><span id="preshutdown_notifications"></span><span id="PRESHUTDOWN_NOTIFICATIONS"></span>Preshutdown Notifications<br/>                                     | A service can register to receive a **SERVICE\_CONTROL\_PRESHUTDOWN** notification in its [*HandlerEx*](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex) function before it receives the actual shutdown notification. This provides services with a lengthy shutdown procedure more time to shut down gracefully. To set the time-out value, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_PRESHUTDOWN\_INFO**.<br/>                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span id="Restricted_Network_Access"></span><span id="restricted_network_access"></span><span id="RESTRICTED_NETWORK_ACCESS"></span>Restricted Network Access<br/>                                     | You can use service SIDs to restrict access to ports, protocols, or the direction of network traffic. To restrict a service's access to the network, use the [**INetFwServiceRestriction**](/windows/desktop/api/netfw/nn-netfw-inetfwservicerestriction) interface.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span id="Running_with_Least_Privilege"></span><span id="running_with_least_privilege"></span><span id="RUNNING_WITH_LEAST_PRIVILEGE"></span>Running with Least Privilege<br/>                         | Services can run under any account that contains the required privileges (LocalService, NetworkService, LocalSystem, a domain account, or a local account) and indicate the required privileges by calling [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_REQUIRED\_PRIVILEGES\_INFO**. The SCM removes any privileges that are not required.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="Service_Isolation"></span><span id="service_isolation"></span><span id="SERVICE_ISOLATION"></span>Service Isolation<br/>                                                                     | A service can isolate objects, such as files or registry keys, for its exclusive use by securing them with an access control entry that contains a service SID. After this SID has been assigned to a service, the service owner can modify the objects' access control lists to grant access to the SID. This enables a service to access specific objects without running under a high-privilege account or lowering the security on the objects. To set the service SID, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_SERVICE\_SID\_INFO**.<br/>                                                                                                                                                                                                                                     |
| <span id="Service_State_Change_Notifications"></span><span id="service_state_change_notifications"></span><span id="SERVICE_STATE_CHANGE_NOTIFICATIONS"></span>Service State Change Notifications<br/> | Services can register to be notified when a service is created, deleted, or has a change in status by using the [**NotifyServiceStatusChange**](/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea) function. This is more efficient than calling the [**QueryServiceStatusEx**](/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex) function in a loop to poll for status.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span id="Session_0_Isolation"></span><span id="session_0_isolation"></span><span id="SESSION_0_ISOLATION"></span>Session 0 Isolation<br/>                                                             | Services have always run in session 0. Before Windows Vista, the first user to log on was also assigned to session 0. Now, session 0 is reserved exclusively for services and other applications not associated with an interactive user session. (The first user to log on is connected to session 1, the second user to log on is connected to session 2, and so on.) Session 0 does not support processes that interact with the user.<br/> This change means that a service cannot post or send a message to an application and an application cannot send or post a message to a service. In addition, services cannot display a user interface item such as a dialog box directly. A service can use the [**WTSSendMessage**](/windows/desktop/api/wtsapi32/nf-wtsapi32-wtssendmessagea) function to display a dialog box in another session.<br/> |



 

## Related topics

<dl> <dt>

[Services](services.md)
</dt> </dl>

 

