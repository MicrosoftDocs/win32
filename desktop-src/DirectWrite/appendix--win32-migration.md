---
title: Win32 Text API Comparison
description: For those developers that are migrating their Win32 application code, the following table lists the Win32 Text APIs and the approximate equivalent in DirectWrite.
ms.assetid: c679e31a-3825-4f59-9c5e-9cf770e1f237
keywords:
- DirectWrite,Win32 Text APIs
- Win32 Text APIs
ms.topic: article
ms.date: 05/31/2018
---

# Win32 Text API Comparison

For those developers that are migrating their Win32 application code, the following table lists the Win32 Text APIs and the approximate equivalent in DirectWrite.



| GDI Text calls                                             | Description                                                                                                           | DirectWrite Equivalent                                                                                                                                                                                                                                                                                                                                              |
|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**AddFontMemResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontmemresourceex)       | Adds an embedded font to the system font table.                                                                       | [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) + [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection)                                                                                                                                                                                             |
| [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea)                 | Adds a font resource to the system font table.                                                                        | There is no equivalent. [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) adds to the system font collection as part of the GDI font installation step. DirectWrite populates the system font collection upfront and automatically monitors updates to it, so no installation is ever needed.                                                                              |
| [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa)             | Adds a private or non-enumerable font to the system font table.                                                       | Same as above                                                                                                                                                                                                                                                                                                                                                       |
| [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta)                           | Creates a logical font.                                                                                               | Instead of logical font, applications can specify a set of font properties (for example family name, weight, style, stretch, and size) to create a [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat). Only apps requiring enumeration of the font will access a [**IDWriteFont**](/windows/win32/api/dwrite/nn-dwrite-idwritefont) through the [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection). |
| [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta)           | Creates a logical font from a structure.                                                                              | Same as above                                                                                                                                                                                                                                                                                                                                                       |
| [**CreateFontIndirectEx**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa)       | Creates a logical font from a structure.                                                                              | Same as above                                                                                                                                                                                                                                                                                                                                                       |
| [**DrawText**](/windows/win32/api/winuser/nf-winuser-drawtext)                               | Draws formatted text in a rectangle.                                                                                  | [**IDWriteTextLayout::Draw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**DrawTextEx**](/windows/win32/api/winuser/nf-winuser-drawtextexa)                           | Draws formatted text in a rectangle.                                                                                  | [**IDWriteTextLayout::Draw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**EnumFontFamExProc**](/previous-versions//dd162618(v=vs.85))             | An application-defined callback function used with [**EnumFontFamiliesEx**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesexa) to process fonts. | [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection) interface, through [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection)                                                                                                                                                                                                 |
| [**EnumFontFamiliesEx**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesexa)           | Enumerates all fonts in the system with certain characteristics.                                                      | [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection) interface, through [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection)                                                                                                                                                                                                 |
| [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta)                           | Draws a character string.                                                                                             | [**IDWriteTextLayout::Draw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw) or [**IDWriteRenderBitmapTarget::DrawGlyphRun**](/windows/win32/api/dwrite/nf-dwrite-idwritebitmaprendertarget-drawglyphrun)                                                                                                                                                                                                              |
| [**GetAspectRatioFilterEx**](/windows/win32/api/wingdi/nf-wingdi-getaspectratiofilterex)   | Gets the setting for the aspect-ratio filter.                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetCharABCWidths**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsa)               | Gets the widths of consecutive characters from the TrueType font.                                                     | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharABCWidthsFloat**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsfloata)     | Gets the widths of consecutive characters from the current font.                                                      | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharABCWidthsI**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsi)             | Gets the widths of consecutive glyph indices or an array of glyph indices from the TrueType font.                     | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharacterPlacement**](/windows/win32/api/wingdi/nf-wingdi-getcharacterplacementa)     | Gets information about a character string.                                                                            | [**IDWriteTextAnalyzer**](/windows/win32/api/dwrite/nn-dwrite-idwritetextanalyzer)                                                                                                                                                                                                                                                                                                                  |
| [**GetCharWidth32**](/windows/win32/api/wingdi/nf-wingdi-getcharwidth32a)                   | Gets the widths of consecutive characters from the current font.                                                      | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics) or [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetCharWidthFloat**](/windows/win32/api/wingdi/nf-wingdi-getcharwidthfloata)             | Gets the fractional widths of consecutive characters from the current font.                                           | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics) or [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetCharWidthI**](/windows/win32/api/wingdi/nf-wingdi-getcharwidthi)                     | Gets the widths of consecutive glyph indices or an array of glyph indices from the current font.                      | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics) or [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetFontData**](/windows/win32/api/wingdi/nf-wingdi-getfontdata)                         | Gets metric data for a TrueType font.                                                                                 | [**IDWriteFontFace::TryGetFontTable**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-trygetfonttable)                                                                                                                                                                                                                                                                                         |
| [**GetFontLanguageInfo**](/windows/win32/api/wingdi/nf-wingdi-getfontlanguageinfo)         | Returns information about the selected font for a display context.                                                    | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetFontUnicodeRanges**](/windows/win32/api/wingdi/nf-wingdi-getfontunicoderanges)       | Tells which Unicode characters are supported by a font.                                                               | loop of [**IDWriteFont::HasCharacter**](/windows/win32/api/dwrite/nf-dwrite-idwritefont-hascharacter)                                                                                                                                                                                                                                                                                               |
| [**GetGlyphIndices**](/windows/win32/api/wingdi/nf-wingdi-getglyphindicesa)                 | Translates a string into an array of glyph indices.                                                                   | [**IDWriteFontFace::GetGlyphIndices**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getglyphindices)                                                                                                                                                                                                                                                                                         |
| [**GetGlyphOutline**](/windows/win32/api/wingdi/nf-wingdi-getglyphoutlinea)                 | Gets the outline or bitmap for a character in the TrueType font.                                                      | glyph metrics -- [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics), actual outline information --[**IDwriteFontFace::GetGlyphRunOutline**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getglyphrunoutline), if you want glyph bitmaps, [**IDWriteRenderBitmapRenderTarget::DrawGlyphRun**](/windows/win32/api/dwrite/nf-dwrite-idwritebitmaprendertarget-drawglyphrun)                |
| [**GetKerningPairs**](/windows/win32/api/wingdi/nf-wingdi-getkerningpairsa)                 | Gets the character-kerning pairs for a font.                                                                          | Kerning allowed via typographic properties of the layout (DirectWrite does kerning itself, so there is no method to return this information).                                                                                                                                                                                                                       |
| [**GetOutlineTextMetrics**](/windows/win32/api/wingdi/nf-wingdi-getoutlinetextmetricsa)     | Gets text metrics for TrueType fonts.                                                                                 | [**IDWriteFontFace::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefont-getmetrics)                                                                                                                                                                                                                                                                                                       |
| [**GetRasterizerCaps**](/windows/win32/api/wingdi/nf-wingdi-getrasterizercaps)             | Tells whether TrueType fonts are installed.                                                                           | (TrueType fonts are installed on Windows Vista and Windows 7 by default.)                                                                                                                                                                                                                                                                                           |
| [**GetTabbedTextExtent**](/windows/win32/api/winuser/nf-winuser-gettabbedtextextenta)         | Computes the width and height of a character string, including tabs.                                                  | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-gettextalign)                       | Gets the text-alignment setting for a device context.                                                                 | [**IDWriteTextFormat::GetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-gettextalignment)                                                                                                                                                                                                                                                                                   |
| [**GetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-gettextcharacterextra)     | Gets the current inter character spacing for a device context.                                                        | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetTextColor**](/windows/win32/api/wingdi/nf-wingdi-gettextcolor)                       | Gets the text color for a device context.                                                                             | N/A. (DirectWrite is independent of rendering and hence does not know the color. Applications need to keep track of it themselves.)                                                                                                                                                                                                                                 |
| [**GetTextExtentExPoint**](/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointa)       | Gets the number of characters in a string that will fit within a space.                                               | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentExPointI**](/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointi)     | Gets the number of glyph indices that will fit within a space.                                                        | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentPoint32**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpoint32a)       | Computes the width and height of a string of text.                                                                    | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentPointI**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpointi)         | Computes the width and height of an array of glyph indices.                                                           | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextFace**](/windows/win32/api/wingdi/nf-wingdi-gettextfacea)                         | Gets the name of the font that is selected into a device context.                                                     | [**IDWriteFont::GetFaceNames**](/windows/win32/api/dwrite/nf-dwrite-idwritefont-getfacenames) (Returns all of the names)                                                                                                                                                                                                                                                                            |
| [**GetTextMetrics**](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)                   | Fills a buffer with the metrics for a font.                                                                           | [**IDWriteFontFace::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getmetrics)                                                                                                                                                                                                                                                                                                   |
| [**PolyTextOut**](/windows/win32/api/wingdi/nf-wingdi-polytextouta)                         | Draws several strings using the font and text colors in a device context.                                             | N/A; create several layout objects                                                                                                                                                                                                                                                                                                                                  |
| [**RemoveFontMemResourceEx**](/windows/win32/api/wingdi/nf-wingdi-removefontmemresourceex) | Removes a font whose source was embedded in a document from the system font table.                                    | [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) on the associated object                                                                                                                                                                                                                                                                              |
| [**RemoveFontResource**](/windows/win32/api/wingdi/nf-wingdi-removefontresourcea)           | Removes the fonts in a file from the system font table                                                                | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**RemoveFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-removefontresourceexa)       | Removes a private or non-enumerable font from the system font table.                                                  | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetMapperFlags**](/windows/win32/api/wingdi/nf-wingdi-setmapperflags)                   | Alters the algorithm used to map logical fonts to physical fonts.                                                     | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-settextalign)                       | Sets the text-alignment flags for a device context.                                                                   | [**IDWriteTextFormat::SetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-settextalignment)                                                                                                                                                                                                                                                                                   |
| [**SetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-settextcharacterextra)     | Sets the inter-character spacing.                                                                                     | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetTextColor**](/windows/win32/api/wingdi/nf-wingdi-settextcolor)                       | Sets the text color for a device context.                                                                             | An application has to take care of specifying the color in one of the [**Draw**](/windows/win32/api/dwrite/nf-dwrite-idwriteinlineobject-draw) calls.                                                                                                                                                                                                                                       |
| [**SetTextJustification**](/windows/win32/api/wingdi/nf-wingdi-settextjustification)       | Specifies the amount of space the system should add to the break characters in a string.                              | N/A. Justification and character spacing are not supported in this release.                                                                                                                                                                                                                                                                                         |
| [**TabbedTextOut**](/windows/win32/api/winuser/nf-winuser-tabbedtextouta)                     | Writes a character string at a location, expanding tabs to specified values.                                          | [**IDWriteTextLayout::Draw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**TextOut**](/windows/win32/api/wingdi/nf-wingdi-textouta)                                 | Writes a character string at a location                                                                               | [**IDWriteTextLayout::Draw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |



 

 

 