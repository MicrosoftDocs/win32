---
description: Windows GDI+ exposes a flat API that consists of about 600 functions. These flat API functions are wrapped by the Pen C++ class.
ms.assetid: e523339d-639e-4e8e-b0cb-0c9464eeee03
title: Pen Functions (GDI+)
ms.topic: article
ms.date: 05/31/2018
---

# Pen Functions (GDI+)

Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h. The functions in the GDI+ flat API are wrapped by a collection of about 40 C++ classes. It is recommended that you do not directly call the functions in the flat API. Whenever you make calls to GDI+, you should do so by calling the methods and functions provided by the C++ wrappers. Microsoft Product Support Services will not provide support for code that calls the flat API directly. For more information on using these wrapper methods, see [GDI+ Flat API](-gdiplus-flatapi-flat.md).

The following flat API functions are wrapped by the [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) C++ class.

## Pen Functions and Corresponding Wrapper Methods



| Flat function                                                                                                                | Wrapper method                                                                                                                                                              | Remarks                                                                                                                                                                                                                                                                                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GpStatus WINGDIPAPI GdipCreatePen1(ARGB color, REAL width, GpUnit unit, GpPen \*\*pen)<br/>                            | [**Pen::Pen(IN const Color& color, IN REAL width = 1.0f)**](/windows/win32/api/gdipluspen/nf-gdipluspen-pen-pen(inconstcolor__inreal))<br/>                                                             | Creates a [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object that uses a specified color and width. <br/> The *unit* parameter of the flat function is a member of the [**Unit**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-unit) enumeration that specifies the unit of measure for the width of the pen.<br/>                                                         |
| GpStatus WINGDIPAPI GdipCreatePen2(GpBrush \*brush, REAL width, GpUnit unit, GpPen \*\*pen)<br/>                       | [**Pen::Pen(IN const Brush\* brush, IN REAL width = 1.0f)**](/windows/win32/api/gdipluspen/nf-gdipluspen-pen-pen(inconstbrush_inreal))<br/>                                                            | Creates a [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object that uses the attributes of a brush and a real number to set the width of this **Pen** object. <br/> The *unit* parameter of the flat function is a member of the [**Unit**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-unit) enumeration that specifies the unit of measure for the width of the pen.<br/> |
| GpStatus WINGDIPAPI GdipClonePen(GpPen \*pen, GpPen \*\*clonepen)<br/>                                                 | [**Pen\* Pen::Clone() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-clone)<br/>                                                                                                    | Copies a Pen object.                                                                                                                                                                                                                                                                                                                                    |
| GpStatus WINGDIPAPI GdipDeletePen(GpPen \*pen)<br/>                                                                    | Pen::~Pen() <br/>                                                                                                                                                     | Releases resources used by the [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipSetPenWidth(GpPen \*pen, REAL width)<br/>                                                      | [**Status Pen::SetWidth(IN REAL width)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setwidth)<br/>                                                                                | Sets the width for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                                 |
| GpStatus WINGDIPAPI GdipGetPenWidth(GpPen \*pen, REAL \*width)<br/>                                                    | [**REAL Pen::GetWidth() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getwidth)<br/>                                                                                               | Gets the width currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                   |
| GpStatus WINGDIPAPI GdipSetPenUnit(GpPen \*pen, GpUnit unit)<br/>                                                      | Not called by wrapper methods.<br/>                                                                                                                                   | This function sets the unit of measure for the pen specified by the *pen* parameter to the value specified by the *unit* parameter. The *unit* parameter is a member of the [**Unit**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-unit) enumeration that specifies the unit of measure for the width of the pen.<br/>                                                      |
| GpStatus WINGDIPAPI GdipGetPenUnit(GpPen \*pen, GpUnit \*unit)<br/>                                                    | Not called by wrapper methods.<br/>                                                                                                                                   | This function gets the unit of measure for the pen specified by the *pen* parameter. The *unit* parameter receives a member of the [**Unit**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-unit) enumeration that indicates the unit of measure for the width of the pen.<br/>                                                                                               |
| GpStatus WINGDIPAPI GdipSetPenLineCap197819(GpPen \*pen, GpLineCap startCap, GpLineCap endCap, GpDashCap dashCap)<br/> | [**Status Pen::SetLineCap(IN LineCap startCap, IN LineCap endCap, IN DashCap dashCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setlinecap)<br/>             | Sets the cap styles for the start, end, and dashes in a line drawn with this pen.                                                                                                                                                                                                                                                                       |
| GpStatus WINGDIPAPI GdipSetPenStartCap(GpPen \*pen, GpLineCap startCap)<br/>                                           | [**Status Pen::SetStartCap(IN LineCap startCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setstartcap)<br/>                                                                 | Sets the start cap for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipSetPenEndCap(GpPen \*pen, GpLineCap endCap)<br/>                                               | [**Status Pen::SetEndCap(IN LineCap endCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setendcap)<br/>                                                                         | Sets the end cap for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipSetPenDashCap197819(GpPen \*pen, GpDashCap dashCap)<br/>                                       | [**Status Pen::SetDashCap(IN DashCap dashCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setdashcap)<br/>                                                                     | Sets the dash cap style for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipGetPenStartCap(GpPen \*pen, GpLineCap \*startCap)<br/>                                         | [**LineCap Pen::GetStartCap()const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getstartcap)<br/>                                                                                       | Gets the start cap currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipGetPenEndCap(GpPen \*pen, GpLineCap \*endCap)<br/>                                             | [**LineCap Pen::GetEndCap()const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getendcap)<br/>                                                                                           | Gets the end cap currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                 |
| GpStatus WINGDIPAPI GdipGetPenDashCap197819(GpPen \*pen, GpDashCap \*dashCap)<br/>                                     | [**DashCap Pen::GetDashCap() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getdashcap)<br/>                                                                                        | Gets the dash cap style currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipSetPenLineJoin(GpPen \*pen, GpLineJoin lineJoin)<br/>                                          | [**Status Pen::SetLineJoin(IN LineJoin lineJoin)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setlinejoin)<br/>                                                                | Sets the line join for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipGetPenLineJoin(GpPen \*pen, GpLineJoin \*lineJoin)<br/>                                        | [**LineJoin Pen::GetLineJoin() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getlinejoin)<br/>                                                                                     | Gets the line join for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipSetPenCustomStartCap(GpPen \*pen, GpCustomLineCap\* customCap)<br/>                            | [**Status Pen::SetCustomStartCap(IN const CustomLineCap\* customCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setcustomstartcap)<br/>                                     | Sets the custom start cap for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                      |
| GpStatus WINGDIPAPI GdipGetPenCustomStartCap(GpPen \*pen, GpCustomLineCap\*\* customCap)<br/>                          | [**Pen::GetCustomStartCap(OUT CustomLineCap\* customCap) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getcustomstartcap)<br/>                                           | Gets the custom start cap for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                      |
| GpStatus WINGDIPAPI GdipSetPenCustomEndCap(GpPen \*pen, GpCustomLineCap\* customCap)<br/>                              | [**Status Pen::SetCustomEndCap(IN const CustomLineCap\* customCap)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setcustomendcap)<br/>                                         | Sets the custom end cap currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object                                                                                                                                                                                                                                                           |
| GpStatus WINGDIPAPI GdipGetPenCustomEndCap(GpPen \*pen, GpCustomLineCap\*\* customCap)<br/>                            | [**Status Pen::GetCustomEndCap(OUT CustomLineCap\* customCap) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getcustomendcap)<br/>                                        | Gets the custom end cap currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object                                                                                                                                                                                                                                                           |
| GpStatus WINGDIPAPI GdipSetPenMiterLimit(GpPen \*pen, REAL miterLimit)<br/>                                            | [**Status Pen::SetMiterLimit(IN REAL miterLimit)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setmiterlimit)<br/>                                                            | Sets the miter length currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                            |
| GpStatus WINGDIPAPI GdipGetPenMiterLimit(GpPen \*pen, REAL \*miterLimit)<br/>                                          | [**REAL Pen::GetMiterLimit() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getmiterlimit)<br/>                                                                                     | Gets the miter length currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                            |
| GpStatus WINGDIPAPI GdipSetPenMode(GpPen \*pen, GpPenAlignment penMode)<br/>                                           | [**Status Pen::SetAlignment(IN PenAlignment penAlignment)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setalignment)<br/>                                                  | Sets the alignment currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipGetPenMode(GpPen \*pen, GpPenAlignment \*penMode)<br/>                                         | [**PenAlignment Pen::GetAlignment() const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getalignment)<br/>                                                                      | Sets the alignment currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipSetPenTransform(GpPen \*pen, GpMatrix \*matrix)<br/>                                           | [**Status Pen::SetTransform(IN const Matrix\* matrix)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-settransform)<br/>                                                            | Sets the world transformation matrix currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipGetPenTransform(GpPen \*pen, GpMatrix \*matrix)<br/>                                           | [**Pen::GetTransform(OUT Matrix\* matrix) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-gettransform)<br/>                                                                  | Gets the world transformation matrix currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipResetPenTransform(GpPen \*pen)<br/>                                                            | [**Status Pen::ResetTransform()**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-resettransform)<br/>                                                                                       | Sets the world transformation matrix of this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object to the identity matrix.                                                                                                                                                                                                                                     |
| GpStatus WINGDIPAPI GdipMultiplyPenTransform(GpPen \*pen, GDIPCONST GpMatrix \*matrix, GpMatrixOrder order)<br/>       | [**Status Pen::MultiplyTransform(IN const Matrix\* matrix, IN MatrixOrder order = MatrixOrderPrepend)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-multiplytransform)<br/> | Updates the world transformation matrix of this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object with the product of itself and another matrix.                                                                                                                                                                                                           |
| GpStatus WINGDIPAPI GdipTranslatePenTransform(GpPen \*pen, REAL dx, REAL dy, GpMatrixOrder order)<br/>                 | [**Status Pen::TranslateTransform(GpPen *pen, Real dx, REAL dy, GpMatrixOrder order)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-multiplytransform)<br/>          | Updates the world transformation matrix of this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object with the product of itself and another matrix.                                                                                                                                                                                                           |
| GpStatus WINGDIPAPI GdipScalePenTransform(GpPen \*pen, REAL sx, REAL sy, GpMatrixOrder order)<br/>                     | [**Status Pen::ScaleTransform(IN REAL sx, IN REAL sy, IN MatrixOrder order = MatrixOrderPrepend)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-scaletransform)<br/>          | Sets the [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object's world transformation matrix equal to the product of itself and a scaling matrix.                                                                                                                                                                                                              |
| GpStatus WINGDIPAPI GdipRotatePenTransform(GpPen \*pen, REAL angle, GpMatrixOrder order)<br/>                          | [**Status Pen::RotateTransform(IN REAL angle, IN MatrixOrder order = MatrixOrderPrepend)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-rotatetransform)<br/>                 | Updates the world transformation matrix of this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object with the product of itself and a rotation matrix.                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipSetPenColor(GpPen \*pen, ARGB argb)<br/>                                                       | [**Status Pen::SetColor(IN const Color& color)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setcolor)<br/>                                                                        | Sets the color for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                                 |
| GpStatus WINGDIPAPI GdipGetPenColor(GpPen \*pen, ARGB \*argb)<br/>                                                     | [**Status Pen::GetColor(OUT Color\* color) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getcolor)<br/>                                                                      | Gets the color for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                                 |
| GpStatus WINGDIPAPI GdipSetPenBrushFill(GpPen \*pen, GpBrush \*brush)<br/>                                             | [**Status Pen::SetBrush(IN const Brush\* brush)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setbrush)<br/>                                                                       | Sets the [**Brush**](/windows/desktop/api/gdiplusbrush/nl-gdiplusbrush-brush) object that a pen uses to fill a line.                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipGetPenBrushFill(GpPen \*pen, GpBrush \*\*brush)<br/>                                           | [**Brush\* Pen::GetBrush() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getbrush)<br/>                                                                                            | Gets the [**Brush**](/windows/desktop/api/gdiplusbrush/nl-gdiplusbrush-brush) object that a pen uses to fill a line.                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipGetPenFillType(GpPen \*pen, GpPenType\* type)<br/>                                             | [**PenType Pen::GetPenType() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getpentype)<br/>                                                                                        | Gets the type currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                                    |
| GpStatus WINGDIPAPI GdipGetPenDashStyle(GpPen \*pen, GpDashStyle \*dashstyle)<br/>                                     | [**DashStyle Pen::GetDashStyle() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getdashstyle)<br/>                                                                                  | Gets the dash style currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                              |
| GpStatus WINGDIPAPI GdipSetPenDashStyle(GpPen \*pen, GpDashStyle dashstyle)<br/>                                       | [**Status Pen::SetDashStyle(IN DashStyle dashStyle)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setdashstyle)<br/>                                                           | Sets the dash style currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                              |
| GpStatus WINGDIPAPI GdipGetPenDashOffset(GpPen \*pen, REAL \*offset)<br/>                                              | [**REAL Pen::GetDashOffset() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getdashoffset)<br/>                                                                                     | Gets the distance from the start of the line to the start of the first space in a dashed line.                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipSetPenDashOffset(GpPen \*pen, REAL offset)<br/>                                                | [**Status Pen::SetDashOffset(IN REAL dashOffset)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setdashoffset)<br/>                                                            | Sets the distance from the start of the line to the start of the first space in a dashed line.                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipGetPenDashCount(GpPen \*pen, INT \*count)<br/>                                                 | [**INT Pen::GetDashPatternCount() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getdashpatterncount)<br/>                                                                          | Gets the number of elements in a dash pattern array.                                                                                                                                                                                                                                                                                                    |
| GpStatus WINGDIPAPI GdipSetPenDashArray(GpPen \*pen, GDIPCONST REAL \*dash, INT count)<br/>                            | [**Status Pen::SetDashPattern(IN const REAL\* dashArray, IN INT count)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setdashpattern)<br/>                                | Sets an array of custom dashes and spaces currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipGetPenDashArray(GpPen \*pen, REAL \*dash, INT count)<br/>                                      | [**Status Pen::GetDashPattern(OUT REAL\* dashArray, IN INT count) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getdashpattern)<br/>                               | Gets an array of custom dashes and spaces currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipGetPenCompoundCount(GpPen \*pen, INT \*count)<br/>                                             | [**INT Pen::GetCompoundArrayCount() const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getcompoundarraycount)<br/>                                                                      | Gets the number of elements in a compound array.                                                                                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipSetPenCompoundArray(GpPen \*pen, GDIPCONST REAL \*dash, INT count)<br/>                        | [**Status Pen::SetCompoundArray(IN const REAL\* compoundArray, IN INT count)**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-setcompoundarray)<br/>                    | Sets the compound array currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipGetPenCompoundArray(GpPen \*pen, REAL \*dash, INT count)<br/>                                  | [**Status Pen::GetCompoundArray(OUT REAL\* compoundArray, IN INT count) const**](/windows/desktop/api/Gdipluspen/nf-gdipluspen-pen-getcompoundarray)<br/>                   | Gets the compound array currently set for this [**Pen**](/windows/desktop/api/gdipluspen/nl-gdipluspen-pen) object.                                                                                                                                                                                                                                                          |
