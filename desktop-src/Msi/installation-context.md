---
description: 'Windows Installer can install a package on a computer into two installation contexts: per-machine and per-user.'
ms.assetid: '20e7be9f-d9dc-4f43-86d7-b1a881126925'
title: Installation Context
ms.topic: article
ms.date: 05/31/2018
---

# Installation Context

Windows Installer can install a package on a computer into two installation contexts: per-machine and per-user. A per-machine installation of the package is required to enable all users of the computer to access and use the application. Because a per-machine installation makes changes to the system that affect all users, standard users having limited privileges may be prevented from installing a package into the per-machine context without first obtaining permission.

You can specify installation context by authoring the package for per-user or per-machine installation and using the [**ALLUSERS**](allusers.md) and [**MSIINSTALLPERUSER**](msiinstallperuser.md) properties. Based on these properties, Windows Installer automatically redirects the values of folder properties and registrations to locations for the per-user or per-machine context.

> [!Note]  
> The [**MSIINSTALLPERUSER**](msiinstallperuser.md) property, available beginning with Windows Installer 5.0 and Windows Server 2008 R2 and Windows 7, can facilitate the development of a single package capable of being installed in either the per-machine or per-user context. For information about developing a dual-purpose package that gives the user the capability to choose the installation context at installation time, see [Single Package Authoring](single-package-authoring.md). Windows Installer ignores the **MSIINSTALLPERUSER** property if the value of [**ALLUSERS**](allusers.md) is not 2. Windows Installer always resets the value of **ALLUSERS** to 1 when it installs in the per-machine context and resets the value of **ALLUSERS** to an empty string ("") when it installs in the per-user context.

 

## Shortcut Redirection

The following table compares the locations of shortcuts for per-machine and per-user installation contexts.



| Per-Machine Installation Context (ALLUSERS=1)                                                             | Per-User Installation Context (ALLUSERS="")                                                                                     |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| Applications appear under Add/Remove Programs on Control Panel for all users of the computer. <br/> | Applications appear only under Add/Remove Programs on Control Panel for users that have installed the applications. <br/> |
| Shortcuts are installed to the All Users profile.<br/>                                              | Shortcuts are installed only to that user's profile.<br/>                                                                 |
| Icons and transforms are stored in %WINDOWS%\\Installer\\{ProductCode}.<br/>                        | Icons and transforms are stored in %USERPROFILE%\\Application Data\\Microsoft\\Installer\\{ProductCode GUID}<br/>         |



 

## Registry Redirection

The following table compares the locations of registry entries for the per-machine and per-user installation contexts.



| Per-Machine Installation Context (ALLUSERS=1)                                                                                                                                                                                                                                           | Per-User Installation Context (ALLUSERS="")                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Windows Installer writes or removes registry values entered in the [Registry](registry-table.md) table and [RemoveRegistry](removeregistry-table.md) table, with the value -1 in the Root column, under HKEY\_LOCAL\_MACHINE. <br/>                                             | Windows Installer writes or removes registry values entered in the [Registry](registry-table.md) table and [RemoveRegistry](removeregistry-table.md) table, with the value -1 in the Root column, under HKEY\_CURRENT\_USER. <br/>                                               |
| Windows Installer writes or removes registry values entered in the [Registry](registry-table.md) table and [RemoveRegistry](removeregistry-table.md) table, with the value msidbRegistryRootClassesRoot (0) in the Root column, under **HKLM**\\**Software**\\**Classes**.<br/> | Windows Installer writes or removes registry values entered in the [Registry](registry-table.md) table and [RemoveRegistry](removeregistry-table.md) table, with the value msidbRegistryRootClassesRoot (0) in the Root column, under **HKCU**\\**Software**\\**Classes**. <br/> |
| COM registration is written to **HKLM**\\**Software**\\**Classes**.<br/>                                                                                                                                                                                                          | COM registration is written to **HKCU**\\**Software**\\**Classes**.<br/>                                                                                                                                                                                                           |



 

## Folder Redirection

Windows Installer sets the values of the folder properties to the full path of the respective folder for the installation context.

> [!Note]  
> Folders are identified by their [**KNOWNFOLDERID**](../shell/knownfolderid.md) and [**CSIDL**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) constants. Beginning with Windows Vista, applications should use the [**SHGetKnownFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath) function and the **KNOWNFOLDERID** to determine the full path to the special folders. Existing applications that use the **SHGetFolderPath** function and constant special item IDs ([**CSIDL**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha)) will continue to work.

 

The following table compares the locations of folders that are used when Windows Installer installs the package in the per-machine or per-user installation contexts.



| Per-Machine Installation Context (ALLUSERS=1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Per-User Installation Context (ALLUSERS="")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**DesktopFolder**](desktopfolder.md)The full path of the Desktop folder for all users.<br/> **FOLDERID\_PublicDesktop** (**CSIDL\_COMMON\_DESKTOPDIRECTORY**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [**DesktopFolder**](desktopfolder.md)The full path of the Desktop folder for the current user.<br/> **FOLDERID\_Desktop** (**CSIDL\_DESKTOP**, **CSIDL\_DESKTOPDIRECTORY**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**ProgramMenuFolder**](programmenufolder.md)The full path of the Program Menu folder for all users.<br/> **FOLDERID\_CommonPrograms** (**CSIDL\_COMMON\_PROGRAMS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [**ProgramMenuFolder**](programmenufolder.md)The full path of the Program Menu folder for the current user.<br/> **FOLDERID\_Programs** (**CSIDL\_PROGRAMS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**StartMenuFolder**](startmenufolder.md)The full path of the Start Menu folder for the all users.<br/> **FOLDERID\_CommonStartMenu** (**CSIDL\_COMMON\_STARTMENU**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [**StartMenuFolder**](startmenufolder.md)The full path of the Start Menu folder for the current user.<br/> **FOLDERID\_StartMenu** (**CSIDL\_STARTMENU**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**StartUpFolder**](startupfolder.md)The full path of the Start Up folder for all users.<br/> **FOLDERID\_CommonStartup** (**CSIDL\_COMMON\_STARTUP**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [**StartUpFolder**](startupfolder.md)The full path of the Start Up folder for the current user.<br/> **FOLDERID\_Startup** (**CSIDL\_STARTUP**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**TemplateFolder**](templatefolder.md)The full path of the Templates folder for all users.<br/> **FOLDERID\_CommonTemplates** (**CSIDL\_COMMON\_TEMPLATES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | [**TemplateFolder**](templatefolder.md)The full path of the Templates folder for the current user.<br/> **FOLDERID\_Templates** (**CSIDL\_TEMPLATES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**AdminToolsFolder**](admintoolsfolder.md)The full path of the Admin Tools folder for all users.<br/> **FOLDERID\_CommonAdminTools** (**CSIDL\_COMMON\_ADMINTOOLS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | [**AdminToolsFolder**](admintoolsfolder.md)The full path of the Admin Tools folder for the current user.<br/> **FOLDERID\_AdminTools** (**CSIDL\_ADMINTOOLS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**AppDataFolder**](appdatafolder.md)The full path of the Program Menu folder.<br/> **Windows Vista and later:** The full path of the Roaming folder.<br/> <br/> **FOLDERID\_RoamingAppData** (**CSIDL\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [**AppDataFolder**](appdatafolder.md)The full path of the Program Menu folder.<br/> **Windows Vista and later:** The full path of the Roaming folder.<br/> <br/> **FOLDERID\_RoamingAppData** (**CSIDL\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**CommonAppDataFolder**](commonappdatafolder.md)The full path of the folder that contains application data for all users.<br/> **FOLDERID\_ProgramData** (**CSIDL\_COMMON\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [**CommonAppDataFolder**](commonappdatafolder.md)The full path of the folder that contains application data for all users.<br/> **FOLDERID\_ProgramData** (**CSIDL\_COMMON\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**FavoritesFolder**](favoritesfolder.md)The full path of the Favorites folder for the current user.<br/> **FOLDERID\_Favorites** (**CSIDL\_FAVORITES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | [**FavoritesFolder**](favoritesfolder.md)The full path of the Favorites folder for the current user.<br/> **FOLDERID\_Favorites** (**CSIDL\_FAVORITES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**PersonalFolder**](personalfolder.md)The full path of the My Documents folder or Personal folder for the current user.<br/> **Windows Vista and later:** The full path of the Documents folder for the current user.<br/> <br/> **FOLDERID\_Documents** (**CSIDL\_PERSONAL**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [**PersonalFolder**](personalfolder.md)The full path of the My Documents folder or Personal folder for the current user.<br/> **Windows Vista and later:** The full path of the Documents folder for the current user.<br/> <br/> **FOLDERID\_Documents** (**CSIDL\_PERSONAL**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**SendToFolder**](sendtofolder.md)The full path of the SendTo folder.<br/> **FOLDERID\_SendTo** (**CSIDL\_SENDTO**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [**SendToFolder**](sendtofolder.md)The full path of the SendTo folder.<br/> **FOLDERID\_SendTo** (**CSIDL\_SENDTO**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**FontsFolder**](fontsfolder.md)The full path of the System Fonts folder.<br/> **FOLDERID\_Fonts** (**CSIDL\_FONTS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [**FontsFolder**](fontsfolder.md)The full path of the System Fonts folder.<br/> **FOLDERID\_Fonts** (**CSIDL\_FONTS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**ProgramFilesFolder**](programfilesfolder.md)**32-bit version of Windows:** The property value is the full path to the Program Files folder for all users (for example, %ProgramFiles%.) The identifier for this folder is **FOLDERID\_ProgramFiles** (**CSIDL\_PROGRAM\_FILES**.) The identifiers **FOLDERID\_ProgramFiles** and **FOLDERID\_ProgramFilesX86** represent the same folder. Files in this folder can be accessed by all users.<br/> **64-bit version of Windows:** The property value is the full path to the Program Files (x86) folder for all users (for example, %ProgramFiles(x86)%.) The identifier for this folder is **FOLDERID\_ProgramFilesX86** (**CSIDL\_PROGRAM\_FILESX86**.) Files in this folder can be accessed by all users.<br/>                                                           | [**ProgramFilesFolder**](programfilesfolder.md)**Windows Server 2008 R2 and Windows 7:** The property value is the full path of the Programs folder for the current user (for example, %LocalAppData%\\Programs.) The identifier for this folder is **FOLDERID\_UserProgramFiles** on 32-bit and 64-bit systems. There is no equivalent CSIDL identifier for **FOLDERID\_UserProgramFiles**. Files in this folder can be accessed only by the user that installed this folder.<br/> **Windows Server 2008 and earlier, and Windows Vista and earlier:** No per-user capable folder is available. The path is the same as for the per-machine context (for example, %ProgramFiles% or %ProgramFiles(x86)%.) Files in this folder can be accessed by all users.<br/> <br/>                                            |
| [**CommonFilesFolder**](commonfilesfolder.md)**32-bit version of Windows:** The property value is the full path to the Common Files folder for all users (for example, %ProgramFiles%\\Common Files.) The identifier for this folder is **FOLDERID\_ProgramFilesCommon** (**CSIDL\_PROGRAM\_FILES\_COMMON**.) The identifiers **FOLDERID\_ProgramFilesCommon** and **FOLDERID\_ProgramFilesCommonX86** represent the same folder. Files in this folder can be accessed by all users.<br/> **64-bit version of Windows:** The property value is the full path to the Common Files folder for all users (for example, %ProgramFiles(x86)%\\Common Files.) The identifier for this folder is **FOLDERID\_ProgramFilesCommonX86** (**CSIDL\_PROGRAM\_FILES\_COMMONX86**.) Files in this folder can be accessed by all users.<br/> | [**CommonFilesFolder**](commonfilesfolder.md)**Windows Server 2008 R2 and Windows 7:** The property value is the full path of the Common folder for the current user (for example, %LocalAppData%\\Programs\\Common.) The identifier for this folder is **FOLDERID\_UserProgramFilesCommon** on 32-bit and 64-bit systems. There is no equivalent CSIDL identifier for **FOLDERID\_UserProgramFilesCommon**. Files in this folder can be accessed only by the user that installed this folder.<br/> **Windows Server 2008 and earlier, and Windows Vista and earlier:** No per-user capable folder is available. The path is the same as in the per-machine context (for example, %ProgramFiles%\\Common Files or %ProgramFiles(x86)%\\Common Files.) Files in this folder can be accessed by all users.<br/> <br/> |
| [**ProgramFiles64Folder**](programfiles64folder.md)The property value is the full path to the Program Files folder for all users (for example, %ProgramFiles%.) The identifier for this folder is **FOLDERID\_ProgramFilesX64**. There is no equivalent CSIDL identifier to **FOLDERID\_ProgramFilesX64**. This is the pre-defined folder for 64-bit components and applies to 64-bit systems. Files in this folder can be accessed by all users.<br/>                                                                                                                                                                                                                                                                                                                                                                              | [**ProgramFiles64Folder**](programfiles64folder.md)**Windows Server 2008 R2 and Windows 7:** The property value is the full path of the Programs folder for the current user (for example, %LocalAppData%\\Programs.) The identifier for this folder is **FOLDERID\_UserProgramFiles**. There is no equivalent CSIDL identifier for **FOLDERID\_UserProgramFiles**. Files in this folder can be accessed only by the user that installed this folder.<br/> **Windows Server 2008 and earlier, and Windows Vista and earlier:** No per-user capable folder is available. The path is the same as for the per-machine context (for example, %ProgramFiles%.) Files in this folder can be accessed by all users.<br/> <br/>                                                                                            |
| [**CommonFiles64Folder**](commonfiles64folder.md)The property value is the full path to the Common Files folder for all users (for example, %ProgramFiles%\\Common Files.) This is the pre-defined folder for 64-bit components and applies to 64-bit systems. The identifier for this folder is **FOLDERID\_ProgramFilesCommonX64**. There is no equivalent CSIDL identifier to **FOLDERID\_ProgramFilesCommonX64**. Files in this folder can be accessed by all users.<br/>                                                                                                                                                                                                                                                                                                                                                       | [**CommonFiles64Folder**](commonfiles64folder.md)**Windows Server 2008 R2 and Windows 7:** The property value is the full path of the Common folder for the current user (for example, %LocalAppData%\\Programs\\Common.) The identifier for this folder is **FOLDERID\_UserProgramFilesCommon**. There is no equivalent CSIDL identifier for **FOLDERID\_UserProgramFilesCommon**. Files in this folder can be accessed only by the user that installed this folder.<br/> **Windows Server 2008 and earlier, and Windows Vista and earlier:** No per-user capable folder is available. The path is the same as for the per-machine context (for example, %ProgramFiles%\\Common Files.) Files in this folder can be accessed by all users.<br/> <br/>                                                              |
| [**WindowsFolder**](windowsfolder.md)The full path of the Windows folder.<br/> **FOLDERID\_Windows** (**CSIDL\_WINDOWS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | [**WindowsFolder**](windowsfolder.md)The full path of the Windows folder.<br/> **FOLDERID\_Windows** (**CSIDL\_WINDOWS**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**SystemFolder**](systemfolder.md)The full path of the System folder.<br/> **FOLDERID\_SystemX86** (**CSIDL\_SYSTEMX86**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | [**SystemFolder**](systemfolder.md)The full path of the System folder.<br/> **FOLDERID\_SystemX86** (**CSIDL\_SYSTEMX86**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**LocalAppDataFolder**](localappdatafolder.md)The full path of the folder that contains local (nonroaming) applications. <br/> **FOLDERID\_LocalAppData** (**CSIDL\_LOCAL\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [**LocalAppDataFolder**](localappdatafolder.md)The full path of the folder that contains local (nonroaming) applications. <br/> **FOLDERID\_LocalAppData** (**CSIDL\_LOCAL\_APPDATA**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**MyPicturesFolder**](mypicturesfolder.md)The full path of the Pictures or My Pictures folder.<br/> **FOLDERID\_Pictures** (**CSIDL\_MYPICTURES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [**MyPicturesFolder**](mypicturesfolder.md)The full path of the Pictures or My Pictures folder.<br/> **FOLDERID\_Pictures** (**CSIDL\_MYPICTURES**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**PrintHoodFolder**](printhoodfolder.md)The full path of the PrintHood folder.<br/> **FOLDERID\_PrintHood** (**CSIDL\_PRINTHOOD**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [**PrintHoodFolder**](printhoodfolder.md)The full path of the PrintHood folder.<br/> **FOLDERID\_PrintHood** (**CSIDL\_PRINTHOOD**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**NetHoodFolder**](nethoodfolder.md)The full path of the NetHood folder.<br/> **FOLDERID\_NetHood** (**CSIDL\_NETHOOD**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | [**NetHoodFolder**](nethoodfolder.md)The full path of the NetHood folder.<br/> **FOLDERID\_NetHood** (**CSIDL\_NETHOOD**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**RecentFolder**](recentfolder.md)The full path of the Recent folder.<br/> **FOLDERID\_Recent** (**CSIDL\_RECENT**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [**RecentFolder**](recentfolder.md)The full path of the Recent folder.<br/> **FOLDERID\_Recent** (**CSIDL\_RECENT**)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |



 

> [!Note]  
> An application can call the [**MsiEnumProducts**](/windows/desktop/api/Msi/nf-msi-msienumproductsa) or [**MsiEnumProductsEx**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) functions to enumerate all the products installed on the system. The application can then retrieve information about the installation context of these products by calling the [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) or [**MsiGetProductInfo**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoa) functions. For information see [Determining Installation Context](determining-installation-context.md).

 

 

 
