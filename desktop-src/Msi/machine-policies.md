---
description: Machine system policies used with the Windows Installer.
ms.assetid: af47dc84-2190-4e73-9d87-d5ddb0584ce7
title: Machine Policies
ms.topic: article
ms.date: 05/31/2018
---

# Machine Policies

The following machine policies can be configured under:

**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Policies**\\**Microsoft**\\**Windows**\\**Installer**



| Policy                                                                                    | Value data type           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|-------------------------------------------------------------------------------------------|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [AlwaysInstallElevated](alwaysinstallelevated.md)<br/>                             | **REG\_DWORD**<br/> | If this policy value is set to 1 and the corresponding user value is also set, the installer always installs with elevated privileges.<br/> Otherwise, the installer uses elevated privileges to install managed applications and uses the current user's privilege level for unmanaged applications.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [AllowLockdownBrowse](allowlockdownbrowse.md)<br/>                                 | **REG\_DWORD**<br/> | If this policy value is set to 1, non-administrative users can browse for new sources while running an installation at elevated privileges. The default is that only administrators can browse for sources during an elevated installation. Setting this policy also enables non-administrative users to run programs at LocalSystem privileges during an elevated installation.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [AllowLockdownMedia](allowlockdownmedia.md)<br/>                                   | **REG\_DWORD**<br/> | If this policy value is set to 1, non-administrative users can use media sources, such as a CD-ROM, while running an installation at elevated privileges. The default is that only administrators can use media sources during an elevated installation. Setting this policy also enables non-administrative users to run programs at LocalSystem privileges during an elevated installation.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [AllowLockdownPatch](allowlockdownpatch.md)<br/>                                   | **REG\_DWORD**<br/> | If this per-machine system policy value is not set, only administrators can patch existing products that were installed at elevated privileges. If this policy value is set to 1, non-administrative users can, in some cases, apply patches to products while running an installation using elevated privileges. With the policy set, the patch can install [minor upgrades](minor-upgrades.md) while running an installation using elevated privileges; the patch cannot install [major upgrades](major-upgrades.md). Setting this policy also enables non-administrative users to run programs at LocalSystem privileges during an elevated installation.<br/>                                                                                                                                                                                                                                                                                      |
| [Debug](debug.md)<br/>                                                             | **REG\_DWORD**<br/> | If this policy value exists and is set to 1, the installer writes common debugging messages to the debugger using the [**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) function. If this value exists and is set to 2, the installer writes all valid debugging messages to the debugger using the **OutputDebugString** function.<br/> This policy is for debugging purposes only and may not be supported in future versions of Windows Installer.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md)<br/> | **REG\_DWORD**<br/> | If this policy value exists and is set to 1, Windows Installer does not interact with [Restart Manager](../rstmgr/restart-manager-portal.md) but will use the [FilesInUse Dialog](filesinuse-dialog.md) functionality.<br/> **[Windows Installer 3.1 and earlier](not-supported-in-windows-installer-version-3-1.md):** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [DisableBrowse](disablebrowse.md)<br/>                                             | **REG\_DWORD**<br/> | If this policy value exists and is set to 1, users are prevented from browsing to locate installer sources. The **Use feature from** combo box for direct input is locked and the **Browse** button is disabled. For more information about source browsing, see [Source Resiliency](source-resiliency.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableFlyWeightPatching](disableflyweightpatching.md)<br/>                       | **REG\_DWORD**<br/> | If this per-machine system policy value is set to 1, all [Patch Optimization](patch-optimization.md) options are turned off during the installation.<br/> **Windows Installer 2.0:** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [DisableLUAPatching](disableluapatching.md)<br/>                                   | **REG\_DWORD**<br/> | If this per-machine system policy value is set to 1, the installer prevents non-administrators from using least-privileged account (LUA) patching to any application installed on the computer. When this value is not set or 0, non-administrators can apply LUA patches to LUA-enabled application.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [DisableMSI](disablemsi.md)<br/>                                                   | **REG\_DWORD**<br/> | If this policy value is set to 0, is absent, or any number other than 1 or 2, the effect on the Windows Installer depends on the operating system. On Windows Server 2003, Windows Installer is enabled for managed applications and disabled for unmanaged application installs. On Windows XP the Windows Installer is enabled for all applications.<br/> If this policy value is set to 0, Windows Installer is enabled for all applications. All install operations are allowed.<br/> If this policy value is set to 1, Windows Installer is disabled for unmanaged applications but is still enabled for managed applications. Non-elevated per-user installations are blocked. Per-user elevated and per-machine installs are allowed.<br/> If this policy value is set to 2, Windows Installer is always disabled for all applications. No installs are allowed including repairs, reinstalls, or on-demand installations.<br/> |
| [DisablePatch](disablepatch.md)<br/>                                               | **REG\_DWORD**<br/> | If this policy value is set to 1 the installer does not apply patches. This policy can be used to provide security in environments where patching must be restricted.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [DisablePatchUninstall](disablepatchuninstall.md)<br/>                             | **REG\_DWORD**<br/> | If this policy value is set to 1, patches cannot be removed from the computer by a user or an administrator. The Windows Installer can still remove patches that are no longer applicable to a product.<br/> **Windows Installer 2.0:** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableRollback](disablerollback.md)<br/>                                         | **REG\_DWORD**<br/> | If this policy value is set to 1, the installer does not store rollback files during installation, disabling installation rollback. By default, rollback is enabled. Administrators are advised not to use this policy unless it is absolutely essential.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [DisableSharedComponent](disablesharedcomponent.md)<br/>                           | **REG\_DWORD**<br/> | If this per-machine [system policy](system-policy.md) is set to 1, no package on the system gets the shared component functionality enabled by the **msidbComponentAttributesShared** attribute in the [Component table](component-table.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [DisableUserInstalls](disableuserinstalls.md)<br/>                                 | **REG\_DWORD**<br/> | If this policy value is not set, the installer searches the registry for products in the following order: managed products that are registered as per-user, unmanaged products that are registered as per-user, and finally products that are registered as per-machine.<br/> If this policy value is set to 1, the installer ignores all products that are registered as per-user and only searches for products that are registered as per-machine. An attempt to perform a per-user installation causes the installer to display an error message and stops the installation.<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [EnforceUpgradeComponentRules](enforceupgradecomponentrules.md)<br/>               | **REG\_DWORD**<br/> | Set this policy value to 1 to apply upgrade component rules during [small updates](small-updates.md) and [minor upgrades](minor-upgrades.md) of all products on the computer.<br/> **Windows Installer 2.0:** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [EnableAdminTSRemote](enableadmintsremote.md)<br/>                                 | **REG\_DWORD**<br/> | Setting this policy enables administrators to perform installations from a client session of a server running the Terminal Server role service.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [EnableUserControl](enableusercontrol.md)<br/>                                     | **REG\_DWORD**<br/> | If this policy value is set to 1, then the installer can pass all [public properties](public-properties.md) to the server side during a managed installation using elevated privileges. Setting this policy has the same effect as setting the [**EnableUserControl**](-enableusercontrol.md) property.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [LimitSystemRestoreCheckpointing](limitsystemrestorecheckpointing.md)<br/>         | **REG\_DWORD**<br/> | This policy turns off the creation of checkpoints by Windows Installer.<br/> If the policy value is set to 0 or absent, Windows Installer does normal checkpointing for install or uninstall.<br/> If the policy value is set to 1, Windows Installer creates no checkpoints.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [Logging](logging.md)<br/>                                                         | **REG\_SZ**<br/>    | This policy value is used only if logging has not been enabled by the "/L" command-line option or [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga). If a policy is set in this case, a log file is created in the temp directory with the random name: MSI\*.LOG. Specify the logging mode by setting the policy value to a string of characters. Use the same characters to specify logging mode policy as used by the "/L" command-line option. For more information, see [Command Line Options](command-line-options.md). Note that you cannot use "+" and "\*" for the policy.<br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [MaxPatchCacheSize](maxpatchcachesize.md)<br/>                                     | **REG\_DWORD**<br/> | If this policy value is set to a value greater than 0, Windows Installer saves old versions of patched files in a cache. Set the value to the maximum percentage of disk space that can be used for the file cache. For example, a value of 15 and sets the maximum to 15%. Set to 0 to save no files. When this policy is not set, the default is 10%.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [MsiDisableEmbeddedUI](msidisableembeddedui.md)<br/>                               | **REG\_DWORD**<br/> | To disable embedded UI handlers on the computer, set this policy value to 1.<br/> **[Windows Installer 4.0 and earlier](not-supported-in-windows-installer-4-0.md):** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [SafeForScripting](safeforscripting.md)<br/>                                       | **REG\_DWORD**<br/> | If this policy value is set to 1, users are not prompted when scripts use installer automation within a Web page. This may be useful for Web-based tools but can allow silent installations of applications without user knowledge or consent.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [TransformsSecure policy](transformssecure-policy.md)<br/>                         | **REG\_DWORD**<br/> | Setting the [TransformsSecure policy](transformssecure-policy.md) value to 1 informs the installer that transforms are to be cached locally on the user's computer in a location where the user does not have write access.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableLoggingFromPackage](disableloggingfrompackage.md)<br/>                     | **REG\_DWORD**<br/> | Set this policy value to 1 to disable the logging specified for the package by the [**MsiLogging**](msilogging.md) property for all users of the computer.<br/> **Windows Installer 3.1 and earlier:** Not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [WinHttpAutoLogonLevel](winhttpautologonlevel.md)<br/>                             | **REG\_SZ**<br/>    | The automatic logon (auto-logon) policy determines when it is acceptable to include the default credentials in a request to the server. **Windows 8 and Windows Server 2012:** This policy requires Windows Installer running on the Windows 8 or Windows Server 2012 and is unavailable on all earlier versions of Windows.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |



 

 

 
