---
description: You can use the following option flags to specify the in-script execution of custom actions.
ms.assetid: 6c608151-cdbe-4424-9b16-6dbff28190ab
title: Custom Action In-Script Execution Options
ms.topic: article
ms.date: 05/31/2018
---

# Custom Action In-Script Execution Options

You can use the following option flags to specify the in-script execution of custom actions. These options copy the action code into the execution, rollback, or commit script. To set an option add the value in this table to the value in the Type field of the [CustomAction table](customaction-table.md).

Note that the **msidbCustomActionTypeInScript** must be included with each of these options.



| Term                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="_none_"></span><span id="_NONE_"></span>(none)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                      | Hexadecimal: 0x00000000<br/> Decimal: 0<br/> Immediate execution.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="msidbCustomActionTypeInScript"></span><span id="msidbcustomactiontypeinscript"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT"></span>**msidbCustomActionTypeInScript**<br/>                                                                                                                                                                                                                                                                                             | Hexadecimal: 0x00000400<br/> Decimal: 1024<br/> Queues for execution at scheduled point within script. This flag designates that this is a [deferred execution custom action](deferred-execution-custom-actions.md).<br/>                                                                                                                                                                                                                                                                                                                   |
| <span id="msidbCustomActionTypeInScript____msidbCustomActionTypeRollback"></span><span id="msidbcustomactiontypeinscript____msidbcustomactiontyperollback"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT____MSIDBCUSTOMACTIONTYPEROLLBACK"></span>**msidbCustomActionTypeInScript** + **msidbCustomActionTypeRollback**<br/>                                                                                                                                                      | Hexadecimal: 0x00000400 + 0x00000100<br/> Decimal: 1280<br/> Queues for execution at scheduled point within script. Executes only upon an installation rollback. This flag designates that this is a [rollback custom action](rollback-custom-actions.md).<br/>                                                                                                                                                                                                                                                                             |
| <span id="msidbCustomActionTypeInScript____msidbCustomActionTypeCommit"></span><span id="msidbcustomactiontypeinscript____msidbcustomactiontypecommit"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT____MSIDBCUSTOMACTIONTYPECOMMIT"></span>**msidbCustomActionTypeInScript** + **msidbCustomActionTypeCommit**<br/>                                                                                                                                                              | Hexadecimal: 0x00000400 + 0x00000200<br/> Decimal: 1536<br/> Queues for execution at scheduled point within script. Executes only upon install commit. This flag designates that this is a [commit custom action](commit-custom-actions.md).<br/>                                                                                                                                                                                                                                                                                           |
| <span id="msidbCustomActionTypeInScript___msidbCustomActionTypeNoImpersonate"></span><span id="msidbcustomactiontypeinscript___msidbcustomactiontypenoimpersonate"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT___MSIDBCUSTOMACTIONTYPENOIMPERSONATE"></span>**msidbCustomActionTypeInScript** + **msidbCustomActionTypeNoImpersonate**<br/>                                                                                                                                     | Hexadecimal: 0x00000400 + 0x00000800<br/> Decimal: 3072<br/> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context.<br/>                                                                                                                                                                                                                                                                                                                                                        |
| <span id="msidbCustomActionTypeInScript___msidbCustomActionTypeNoImpersonate___msidbCustomActionTypeRollback"></span><span id="msidbcustomactiontypeinscript___msidbcustomactiontypenoimpersonate___msidbcustomactiontyperollback"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT___MSIDBCUSTOMACTIONTYPENOIMPERSONATE___MSIDBCUSTOMACTIONTYPEROLLBACK"></span>**msidbCustomActionTypeInScript** + **msidbCustomActionTypeNoImpersonate** + **msidbCustomActionTypeRollback**<br/> | Hexadecimal: 0x00000400 + 0x00000800 + 0x00000100<br/> Decimal: 3328<br/> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context. This flag combination designates that this is a [rollback custom action](rollback-custom-actions.md).<br/>                                                                                                                                                                                                                                    |
| <span id="msidbCustomActionTypeInScript___msidbCustomActionTypeNoImpersonate___msidbCustomActionTypeCommit"></span><span id="msidbcustomactiontypeinscript___msidbcustomactiontypenoimpersonate___msidbcustomactiontypecommit"></span><span id="MSIDBCUSTOMACTIONTYPEINSCRIPT___MSIDBCUSTOMACTIONTYPENOIMPERSONATE___MSIDBCUSTOMACTIONTYPECOMMIT"></span>**msidbCustomActionTypeInScript** + **msidbCustomActionTypeNoImpersonate** + **msidbCustomActionTypeCommit**<br/>         | Hexadecimal: 0x00000400 + 0x00000800 + 0x00000200<br/> Decimal: 3584<br/> Queues for execution at scheduled point within script. Executes with no user impersonation. Runs in system context. This flag combination designates that this is a [commit custom action](commit-custom-actions.md).<br/>                                                                                                                                                                                                                                        |
| <span id="msidbCustomActionTypeTSAware___msidbCustomActionTypeInScript"></span><span id="msidbcustomactiontypetsaware___msidbcustomactiontypeinscript"></span><span id="MSIDBCUSTOMACTIONTYPETSAWARE___MSIDBCUSTOMACTIONTYPEINSCRIPT"></span>**msidbCustomActionTypeTSAware** + **msidbCustomActionTypeInScript**<br/>                                                                                                                                                             | Hexadecimal: 0x00000400 + 0x00004000<br/> Decimal: 17408<br/> Queues for execution at the scheduled point within script. Executes with user impersonation. Runs with user impersonation during per-machine installs on a server running the Terminal Server role service. Normal deferred execution custom actions, without this attribute, run with no user impersonation on a terminal server during per-machine installations. This attribute has no effect if the action also has the msidbCustomActionTypeNoImpersonate attribute.<br/> |
| <span id="msidbCustomActionTypeTSAware___msidbCustomActionTypeInScript___msidbCustomActionTypeRollback"></span><span id="msidbcustomactiontypetsaware___msidbcustomactiontypeinscript___msidbcustomactiontyperollback"></span><span id="MSIDBCUSTOMACTIONTYPETSAWARE___MSIDBCUSTOMACTIONTYPEINSCRIPT___MSIDBCUSTOMACTIONTYPEROLLBACK"></span>**msidbCustomActionTypeTSAware** + **msidbCustomActionTypeInScript** + **msidbCustomActionTypeRollback**<br/>                         | Hexadecimal: 0x00000400 + 0x00004000 + 0x00000100<br/> Decimal: 17664<br/> Queues for execution at the scheduled point within script. Run only upon an installation rollback. Execute with user impersonation. Runs with user impersonation during per-machine installs on a terminal server.<br/>                                                                                                                                                                                                                                           |
| <span id="msidbCustomActionTypeTSAware___msidbCustomActionTypeInScript___msidbCustomActionTypeCommit"></span><span id="msidbcustomactiontypetsaware___msidbcustomactiontypeinscript___msidbcustomactiontypecommit"></span><span id="MSIDBCUSTOMACTIONTYPETSAWARE___MSIDBCUSTOMACTIONTYPEINSCRIPT___MSIDBCUSTOMACTIONTYPECOMMIT"></span>**msidbCustomActionTypeTSAware** + **msidbCustomActionTypeInScript** + **msidbCustomActionTypeCommit**<br/>                                 | Hexadecimal: 0x00000400 + 0x00004000 + 0x00000200<br/> Decimal: 17920<br/> Queues for execution at the scheduled point within script. Runs only upon an install commit. Executes with user impersonation. Runs with user impersonation during per-machine installs on a terminal server.<br/>                                                                                                                                                                                                                                                |



 

For information about custom actions that run only when a patch is being uninstalled, see the [Custom Action Patch Uninstall Option](custom-action-patch-uninstall-option.md).

## Related topics

<dl> <dt>

[Custom Action Reference](custom-action-reference.md)
</dt> <dt>

[About Custom Actions](about-custom-actions.md)
</dt> <dt>

[Using Custom Actions](using-custom-actions.md)
</dt> </dl>

 

 




