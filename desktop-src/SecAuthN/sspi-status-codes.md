---
description: Status codes used in SSPI applications.
ms.assetid: b5f8ed5c-797a-46fa-8a73-a054ecc50265
title: SSPI Status Codes
ms.topic: article
ms.date: 05/31/2018
---

# SSPI Status Codes

The following status codes are used in SSPI applications and defined in Winerror.h.



| Status code                                        | Meaning                                                                                                                                                                                                                                                                                                                                           |
|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SEC\_E\_ALGORITHM\_MISMATCH<br/>             | The client and server cannot communicate because they do not possess a common algorithm.<br/>                                                                                                                                                                                                                                               |
| SEC\_E\_BAD\_BINDINGS<br/>                   | The SSPI channel bindings supplied by the client are incorrect.<br/>                                                                                                                                                                                                                                                                        |
| SEC\_E\_BAD\_PKGID<br/>                      | The requested package identifier does not exist.<br/>                                                                                                                                                                                                                                                                                       |
| SEC\_E\_BUFFER\_TOO\_SMALL<br/>              | The buffers supplied to the function are not large enough to contain the information.<br/>                                                                                                                                                                                                                                                  |
| SEC\_E\_CANNOT\_INSTALL<br/>                 | The [*security package*](../secgloss/s-gly.md) cannot initialize successfully and should not be installed.<br/>                                                                                                                                                                     |
| SEC\_E\_CANNOT\_PACK<br/>                    | The package is unable to pack the context.<br/>                                                                                                                                                                                                                                                                                             |
| SEC\_E\_CERT\_EXPIRED<br/>                   | The received certificate has expired.<br/>                                                                                                                                                                                                                                                                                                  |
| SEC\_E\_CERT\_UNKNOWN<br/>                   | An unknown error occurred while processing the certificate.<br/>                                                                                                                                                                                                                                                                            |
| SEC\_E\_CERT\_WRONG\_USAGE<br/>              | The certificate is not valid for the requested usage.<br/>                                                                                                                                                                                                                                                                                  |
| SEC\_E\_CONTEXT\_EXPIRED<br/>                | The application is referencing a context that has already been closed. A properly written application should not receive this error.<br/>                                                                                                                                                                                                   |
| SEC\_E\_CROSSREALM\_DELEGATION\_FAILURE<br/> | The server attempted to make a Kerberos-constrained delegation request for a target outside the server's realm.<br/>                                                                                                                                                                                                                        |
| SEC\_E\_CRYPTO\_SYSTEM\_INVALID<br/>         | The cryptographic system or checksum function is not valid because a required function is unavailable.<br/>                                                                                                                                                                                                                                 |
| SEC\_E\_DECRYPT\_FAILURE<br/>                | The specified data could not be decrypted.<br/>                                                                                                                                                                                                                                                                                             |
| SEC\_E\_DELEGATION\_REQUIRED<br/>            | The requested operation cannot be completed. The computer must be trusted for delegation, and the current user account must be configured to allow delegation.<br/>                                                                                                                                                                         |
| SEC\_E\_DOWNGRADE\_DETECTED<br/>             | The system detected a possible attempt to compromise security. Verify that the server that authenticated you can be contacted.<br/>                                                                                                                                                                                                         |
| SEC\_E\_ENCRYPT\_FAILURE<br/>                | The specified data could not be encrypted.<br/>                                                                                                                                                                                                                                                                                             |
| SEC\_E\_ILLEGAL\_MESSAGE<br/>                | The message received was unexpected or badly formatted.<br/>                                                                                                                                                                                                                                                                                |
| SEC\_E\_INCOMPLETE\_CREDENTIALS<br/>         | The credentials supplied were not complete and could not be verified. The context could not be initialized.<br/>                                                                                                                                                                                                                            |
| SEC\_E\_INCOMPLETE\_MESSAGE<br/>             | The message supplied was incomplete. The signature was not verified.<br/>                                                                                                                                                                                                                                                                   |
| SEC\_E\_INSUFFICIENT\_MEMORY<br/>            | Not enough memory is available to complete the request.<br/>                                                                                                                                                                                                                                                                                |
| SEC\_E\_INTERNAL\_ERROR<br/>                 | An error occurred that did not map to an SSPI error code.<br/>                                                                                                                                                                                                                                                                              |
| SEC\_E\_INVALID\_HANDLE<br/>                 | The handle passed to the function is not valid.<br/>                                                                                                                                                                                                                                                                                        |
| SEC\_E\_INVALID\_TOKEN<br/>                  | The token passed to the function is not valid.<br/>                                                                                                                                                                                                                                                                                         |
| SEC\_E\_ISSUING\_CA\_UNTRUSTED<br/>          | An untrusted [*certification authority*](../secgloss/c-gly.md) (CA) was detected while processing the smart card certificate used for authentication.<br/>                                                                                                            |
| SEC\_E\_ISSUING\_CA\_UNTRUSTED\_KDC<br/>     | An untrusted CA was detected while processing the domain controller certificate used for authentication. The system event log contains additional information.<br/>                                                                                                                                                                         |
| SEC\_E\_KDC\_CERT\_EXPIRED<br/>              | The domain controller certificate used for smart card logon has expired.<br/>                                                                                                                                                                                                                                                               |
| SEC\_E\_KDC\_CERT\_REVOKED<br/>              | The domain controller certificate used for smart card logon has been revoked.<br/>                                                                                                                                                                                                                                                          |
| SEC\_E\_KDC\_INVALID\_REQUEST<br/>           | A request that is not valid was sent to the KDC.<br/>                                                                                                                                                                                                                                                                                       |
| SEC\_E\_KDC\_UNABLE\_TO\_REFER<br/>          | The KDC was unable to generate a referral for the service requested.<br/>                                                                                                                                                                                                                                                                   |
| SEC\_E\_KDC\_UNKNOWN\_ETYPE<br/>             | The requested encryption type is not supported by the KDC.<br/>                                                                                                                                                                                                                                                                             |
| SEC\_E\_LOGON\_DENIED<br/>                   | This status code is obsolete.<br/>                                                                                                                                                                                                                                                                                                          |
| SEC\_E\_MAX\_REFERRALS\_EXCEEDED<br/>        | The number of maximum ticket referrals has been exceeded.<br/>                                                                                                                                                                                                                                                                              |
| SEC\_E\_MESSAGE\_ALTERED<br/>                | The message supplied for verification has been altered.<br/>                                                                                                                                                                                                                                                                                |
| SEC\_E\_MULTIPLE\_ACCOUNTS<br/>              | The received certificate was mapped to multiple accounts.<br/>                                                                                                                                                                                                                                                                              |
| SEC\_E\_MUST\_BE\_KDC<br/>                   | The local computer must be a Kerberos domain controller (KDC), but it is not.<br/>                                                                                                                                                                                                                                                          |
| SEC\_E\_NO\_AUTHENTICATING\_AUTHORITY<br/>   | No authority could be contacted for authentication.<br/>                                                                                                                                                                                                                                                                                    |
| SEC\_E\_NO\_CREDENTIALS<br/>                 | No credentials are available.<br/>                                                                                                                                                                                                                                                                                                          |
| SEC\_E\_NO\_IMPERSONATION<br/>               | No impersonation is allowed for this context.<br/>                                                                                                                                                                                                                                                                                          |
| SEC\_E\_NO\_IP\_ADDRESSES<br/>               | Unable to accomplish the requested task because the local computer does not have any IP addresses.<br/>                                                                                                                                                                                                                                     |
| SEC\_E\_NO\_KERB\_KEY<br/>                   | No Kerberos key was found.<br/>                                                                                                                                                                                                                                                                                                             |
| SEC\_E\_NO\_PA\_DATA<br/>                    | Policy administrator (PA) data is needed to determine the encryption type, but cannot be found.<br/>                                                                                                                                                                                                                                        |
| SEC\_E\_NO\_S4U\_PROT\_SUPPORT<br/>          | The Kerberos subsystem encountered an error. A service for user protocol request was made against a domain controller which does not support service for a user.<br/>                                                                                                                                                                       |
| SEC\_E\_NO\_TGT\_REPLY<br/>                  | The client is trying to negotiate a context and the server requires a user-to-user connection, but did not send a TGT reply.<br/>                                                                                                                                                                                                           |
| SEC\_E\_NOT\_OWNER<br/>                      | The caller of the function does not own the credentials.<br/>                                                                                                                                                                                                                                                                               |
| SEC\_E\_NOT\_SUPPORTED<br/>                  | The request is not supported.<br/>                                                                                                                                                                                                                                                                                                          |
| SEC\_E\_OK<br/>                              | The operation completed successfully.<br/>                                                                                                                                                                                                                                                                                                  |
| SEC\_E\_OUT\_OF\_SEQUENCE<br/>               | The message supplied for verification is out of sequence.<br/>                                                                                                                                                                                                                                                                              |
| SEC\_E\_PKINIT\_CLIENT\_FAILURE<br/>         | The smart card certificate used for authentication is not trusted.<br/>                                                                                                                                                                                                                                                                     |
| SEC\_E\_PKINIT\_NAME\_MISMATCH<br/>          | The client certificate does not contain a valid UPN or does not match the client name in the logon request.<br/>                                                                                                                                                                                                                            |
| SEC\_E\_QOP\_NOT\_SUPPORTED<br/>             | The quality of protection attribute is not supported by this package.<br/>                                                                                                                                                                                                                                                                  |
| SEC\_E\_REVOCATION\_OFFLINE\_C<br/>          | The revocation status of the smart card certificate used for authentication could not be determined.<br/>                                                                                                                                                                                                                                   |
| SEC\_E\_REVOCATION\_OFFLINE\_KDC<br/>        | The revocation status of the domain controller certificate used for smart card authentication could not be determined. The system event log contains additional information.<br/>                                                                                                                                                           |
| SEC\_E\_SECPKG\_NOT\_FOUND<br/>              | The security package was not recognized.<br/>                                                                                                                                                                                                                                                                                               |
| SEC\_E\_SECURITY\_QOS\_FAILED<br/>           | The security context could not be established due to a failure in the requested quality of service (for example, mutual authentication or delegation).<br/>                                                                                                                                                                                 |
| SEC\_E\_SHUTDOWN\_IN\_PROGRESS<br/>          | A system shutdown is in progress.<br/>                                                                                                                                                                                                                                                                                                      |
| SEC\_E\_SMARTCARD\_CERT\_EXPIRED<br/>        | The smart card certificate used for authentication has expired.<br/>                                                                                                                                                                                                                                                                        |
| SEC\_E\_SMARTCARD\_CERT\_REVOKED<br/>        | The smart card certificate used for authentication has been revoked. Additional information may exist in the event log.<br/>                                                                                                                                                                                                                |
| SEC\_E\_SMARTCARD\_LOGON\_REQUIRED<br/>      | Smart card logon is required and was not used.<br/>                                                                                                                                                                                                                                                                                         |
| SEC\_E\_STRONG\_CRYPTO\_NOT\_SUPPORTED<br/>  | The other end of the security negotiation requires strong cryptography, but it is not supported on the local machine.<br/>                                                                                                                                                                                                                  |
| SEC\_E\_TARGET\_UNKNOWN<br/>                 | The target was not recognized.<br/>                                                                                                                                                                                                                                                                                                         |
| SEC\_E\_TIME\_SKEW<br/>                      | The clocks on the client and server computers do not match.<br/>                                                                                                                                                                                                                                                                            |
| SEC\_E\_TOO\_MANY\_PRINCIPALS<br/>           | The KDC reply contained more than one principal name.<br/>                                                                                                                                                                                                                                                                                  |
| SEC\_E\_UNFINISHED\_CONTEXT\_DELETED<br/>    | A security context was deleted before the context was completed. This is considered a logon failure.<br/>                                                                                                                                                                                                                                   |
| SEC\_E\_UNKNOWN\_CREDENTIALS<br/>            | The credentials provided were not recognized.<br/>                                                                                                                                                                                                                                                                                          |
| SEC\_E\_UNSUPPORTED\_FUNCTION<br/>           | The requested function is not supported.<br/>                                                                                                                                                                                                                                                                                               |
| SEC\_E\_UNSUPPORTED\_PREAUTH<br/>            | An unsupported preauthentication mechanism was presented to the Kerberos package.<br/>                                                                                                                                                                                                                                                      |
| SEC\_E\_UNTRUSTED\_ROOT<br/>                 | The certificate chain was issued by an authority that is not trusted.<br/>                                                                                                                                                                                                                                                                  |
| SEC\_E\_WRONG\_CREDENTIAL\_HANDLE<br/>       | The supplied credential handle does not match the credential associated with the security context.<br/>                                                                                                                                                                                                                                     |
| SEC\_E\_WRONG\_PRINCIPAL<br/>                | The target principal name is incorrect.<br/>                                                                                                                                                                                                                                                                                                |
| SEC\_I\_COMPLETE\_AND\_CONTINUE<br/>         | The function completed successfully, but the application must call both [**CompleteAuthToken**](/windows/desktop/api/Sspi/nf-sspi-completeauthtoken) and then either [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) or [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) again to complete the context.<br/> |
| SEC\_I\_COMPLETE\_NEEDED<br/>                | The function completed successfully, but you must call the [**CompleteAuthToken**](/windows/desktop/api/Sspi/nf-sspi-completeauthtoken) function on the final message.<br/>                                                                                                                                                                                               |
| SEC\_I\_CONTEXT\_EXPIRED<br/>                | The message sender has finished using the connection and has initiated a shutdown. For information about initiating or recognizing a shutdown, see [Shutting Down an Schannel Connection](shutting-down-an-schannel-connection.md).<br/>                                                                                                   |
| SEC\_I\_CONTINUE\_NEEDED<br/>                | The function completed successfully, but you must call this function again to complete the context.<br/>                                                                                                                                                                                                                                    |
| SEC\_I\_INCOMPLETE\_CREDENTIALS<br/>         | The credentials supplied were not complete and could not be verified. Additional information can be returned from the context.<br/>                                                                                                                                                                                                         |
| SEC\_I\_LOCAL\_LOGON<br/>                    | The logon was completed, but no network authority was available. The logon was made using locally known information.<br/>                                                                                                                                                                                                                   |
| SEC\_I\_NO\_LSA\_CONTEXT<br/>                | There is no LSA mode context associated with this context.<br/>                                                                                                                                                                                                                                                                             |
| SEC\_I\_RENEGOTIATE<br/>                     | The context data must be renegotiated with the peer.<br/>                                                                                                                                                                                                                                                                                   |



 

 

 
