---
title: Presets
description: Presets
ms.assetid: 'fb2ccd8b-eda2-414a-870c-85b658f40eb9'
keywords:
- visualizations,presets
- custom visualizations,presets
- visualizations,Bar preset
- custom visualizations,Bar preset
- visualizations,Wave preset
- custom visualizations,Wave preset
- visualizations,Render function
- custom visualizations,Render function
- Render function,presets
- visualizations,GetPresetTitle function
- custom visualizations,GetPresetTitle function
- GetPresetTitle function
- enumerations,visualization presets
- visualizations,enumerations
- custom visualizations,enumerations
- visualizations,resource header and strings
- custom visualizations,resource header and strings
- presets in visualizations,Bar preset
- presets in visualizations,Wave preset
- presets in visualizations,about
ms.topic: article
ms.date: 05/31/2018
---

# Presets

Presets are provided as a way to have different effects coming from the same visualization. For example, you could create a glow effect that was generated by one block of code, but use a preset to determine the color of the glow. Your preset names might be Red, Green, and Blue.

The wizard defines two presets for the code it generates. One is called Bars and the other is called Wave. The Bars preset displays bars that show the activity in the audio spectrum, and use the waveform data. The Wave preset displays a wiggling line that shows the audio power of the waveform.

If you change any of the preset information, you must also change the following parts of the generated code.

## Render function

The **IWMPEffects::Render** function is in the file *projectname*.cpp, where *projectname* is the project name you chose when you ran the wizard.

The generated code in the **Render** function uses a switch statement to choose between two presets. The current preset is whatever the user selects in Windows Media Player. If you want to change which code runs for a particular preset or add or subtract a preset, modify the switch statement accordingly.

The two presets are defined by the **PRESET\_BARS** and **PRESET\_SCOPE** enumerations. The choice of which preset will be called is defined by m\_nPreset.

## GetPresetTitle

The **IWMPEffects::GetPresetTitle** function is in the file *projectname*.cpp, where *projectname* is the project name you chose when you ran the wizard.

The **GetPresetTitle** function sets up the relationships between the preset enumerations and the string resources. The enumerations **PRESET\_BARS** and **PRESET\_SCOPE** are generated by the wizard and are using the string resources IDS\_BARSPRESETNAME and IDS\_SCOPEPRESETNAME.

You need to change the enumerations and string resources if you add, subtract, or change presets.

## Preset Enumerations

The preset enumeration is defined in the file *projectname*.h, where *projectname* is the project name you chose when you ran the wizard.

The enumeration defines the current two presets and the count. If you add or subtract presets or change the enumeration, be sure you change this enumeration so that the count and order of presets is correct. This enumeration is used to make sure that you call the correct preset in the **Render** function.

## Resource Header

You must set the resources for names of your preset in the resource.h header file. The current presets are defined as:


```C++
#define IDS_BARSPRESETNAME              102
#define IDS_SCOPEPRESETNAME             103
```



If you add or subtract presets, you must change the resource header and the numbers for them.

## Resource Strings

The actual names of the presets are defined in the resource file *projectname* dll.rc, where *projectname* is the project name you chose when you ran the wizard. You can edit this file by hand or use the resource editor included with Microsoft Visual C++.

The names generated are the name of the visualization plus the specific preset. The resource file for the generated code will define them as:


```C++
IDS_BARSPRESETNAME      "projectname Bars"
IDS_SCOPEPRESETNAME     "projectname Wave"
```



where *projectname* is the name of the project name you chose when you ran the wizard. This is where you will change the actual names of the presets and this is how they will be referred to and displayed by Windows Media Player.

## Related topics

<dl> <dt>

[**Implementing Your Code**](implementing-your-code.md)
</dt> </dl>

 

 




