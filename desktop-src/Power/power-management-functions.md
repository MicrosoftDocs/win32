---
description: The following functions are used with power management.
ms.assetid: eae96a9e-ced2-4e13-b250-33c5acbbae48
title: Power Management Functions
ms.topic: article
ms.date: 05/31/2018
---

# Power Management Functions

The following functions are used with power management.

| Function                                                                                           | Description                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CallNtPowerInformation**](/windows/desktop/api/Powerbase/nf-powerbase-callntpowerinformation)                                           | Sets or retrieves power information.                                                                                                                                                                                                    |
| [**DevicePowerClose**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowerclose)                                                       | Frees all nodes in the device list and destroys the device list.                                                                                                                                                                        |
| [**DevicePowerEnumDevices**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowerenumdevices)                                           | Enumerates devices on the system that meet the specified criteria.                                                                                                                                                                      |
| [**DevicePowerOpen**](/windows/desktop/api/PowrProf/nf-powrprof-devicepoweropen)                                                         | Initializes a device list by querying all the devices.                                                                                                                                                                                  |
| [**DevicePowerSetDeviceState**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowersetdevicestate)                                     | Modifies the specified data on the specified device.                                                                                                                                                                                    |
| [**EFFECTIVE_POWER_MODE_CALLBACK**](/windows/desktop/api/powersetting/nf-powersetting-effective_power_mode_callback)                                     | Function class for effective power mode callback.                                                                                                                                                                                    |
| [**GetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-getactivepwrscheme)                                         | Retrieves the index of the active power scheme.                                                                                                                                                                                     |
| [**GetCurrentPowerPolicies**](/windows/desktop/api/PowrProf/nf-powrprof-getcurrentpowerpolicies)                                         | Retrieves the current system power policy settings.                                                                                                                                                                                     |
| [**GetDevicePowerState**](/windows/desktop/api/Winbase/nf-winbase-getdevicepowerstate)                                                 | Retrieves the current power state of the specified device.                                                                                                                                                                              |
| [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                   | Retrieves information about the system power capabilities.                                                                                                                                                                              |
| [**GetSystemPowerStatus**](/windows/desktop/api/Winbase/nf-winbase-getsystempowerstatus)                                               | Retrieves the power status of the system.                                                                                                                                                                                               |
| [**IsSystemResumeAutomatic**](/windows/desktop/api/Winbase/nf-winbase-issystemresumeautomatic)                                         | Indicates the current state of the computer.                                                                                                                                                                                            |
| [**PowerCanRestoreIndividualDefaultPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powercanrestoreindividualdefaultpowerscheme) | Determines if the current user has access to the data for the specified power scheme so that it could be restored if necessary.                                                                                                         |
| [**PowerClearRequest**](/windows/desktop/api/winbase/nf-winbase-powerclearrequest)                                                     | Decrements the count of power requests of the specified type for a power request object.                                                                                                                                                |
| [**PowerCreatePossibleSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powercreatepossiblesetting)                                   | Creates a possible setting value for a specified power setting.                                                                                                                                                                         |
| [**PowerCreateRequest**](/windows/desktop/api/winbase/nf-winbase-powercreaterequest)                                                   | Creates a power request object.                                                                                                                                                                                                         |
| [**PowerCreateSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powercreatesetting)                                                   | Creates a setting value for a specified power setting.                                                                                                                                                                                  |
| [**PowerDeleteScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerdeletescheme)                                                     | Deletes a specified scheme from the database.                                                                                                                                                                                           |
| [**PowerDeterminePlatformRole**](/windows/desktop/api/PowrProf/nf-powrprof-powerdetermineplatformrole)                                   | Determines the computer role.                                                                                                                                                                                                           |
| [**PowerDuplicateScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerduplicatescheme)                                               | Duplicates an existing power scheme.                                                                                                                                                                                                    |
| [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate)                                                           | Enumerates the specified elements in a power scheme.                                                                                                                                                                                    |
| [**PowerGetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powergetactivescheme)                                               | Retrieves the active power scheme.                                                                                                                                                                                                      |
| [**PowerImportPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerimportpowerscheme)                                           | Imports a power scheme from a file.                                                                                                                                                                                                     |
| [**PowerIsSettingRangeDefined**](/windows/desktop/api/Powrprof/nf-powrprof-powerissettingrangedefined)                                   | Queries whether the specified power setting represents a range of possible values.                                                                                                                                                      |
| [**PowerReadACDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadacdefaultindex)                                         | Retrieves the default AC index of the specified power setting.                                                                                                                                                                          |
| [**PowerReadACValue**](/windows/desktop/api/Powersetting/nf-powersetting-powerreadacvalue)                                                       | Retrieves the AC power value for the specified power setting.                                                                                                                                                                           |
| [**PowerReadACValueIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadacvalueindex)                                             | Retrieves the AC index of the specified power setting.                                                                                                                                                                                  |
| [**PowerReadDCDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddcdefaultindex)                                         | Retrieves the default DC index of the specified power setting.                                                                                                                                                                          |
| [**PowerReadDCValue**](/windows/desktop/api/Powersetting/nf-powersetting-powerreaddcvalue)                                                       | Retrieves the DC power value for the specified power setting.                                                                                                                                                                           |
| [**PowerReadDCValueIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddcvalueindex)                                             | Retrieves the DC value index of the specified power setting.                                                                                                                                                                            |
| [**PowerReadDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddescription)                                               | Retrieves the description for the specified power setting, subgroup, or scheme.                                                                                                                                                         |
| [**PowerReadFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadfriendlyname)                                             | Retrieves the friendly name for the specified power setting, subgroup, or scheme.                                                                                                                                                       |
| [**PowerReadIconResourceSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadiconresourcespecifier)                           | Retrieves the icon resource for the specified power setting, subgroup, or scheme.                                                                                                                                                       |
| [**PowerReadPossibleDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossibledescription)                               | Retrieves the description for one of the possible choices of a power setting value.                                                                                                                                                     |
| [**PowerReadPossibleFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossiblefriendlyname)                             | Retrieves the friendly name for one of the possible choices of a power setting value.                                                                                                                                                   |
| [**PowerReadPossibleValue**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossiblevalue)                                           | Retrieves the value for a possible value of a power setting.                                                                                                                                                                            |
| [**PowerReadSettingAttributes**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadsettingattributes)                                   | Returns the current attribute of the specified power setting.                                                                                                                                                                           |
| [**PowerReadValueIncrement**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvalueincrement)                                         | Retrieves the increment for valid values between the power settings minimum and maximum.                                                                                                                                                |
| [**PowerReadValueMax**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvaluemax)                                                     | Retrieves the maximum value for the specified power setting.                                                                                                                                                                            |
| [**PowerReadValueMin**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvaluemin)                                                     | Retrieves the minimum value for the specified power setting.                                                                                                                                                                            |
| [**PowerReadValueUnitsSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvalueunitsspecifier)                               | Reads the string used to describe the units of a power setting that supports a range of values.                                                                                                                                         |
| [**PowerRegisterForEffectivePowerModeNotifications**](/windows/desktop/api/powersetting/nf-powersetting-powerregisterforeffectivepowermodenotifications)                               | Registers a callback to receive effective power mode change notifications.                                                                                                                                         |
| [**PowerRegisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerregistersuspendresumenotification)           | Registers to receive notification when the system is suspended or resumed.                                                                                                                                                              |
| [**PowerRemovePowerSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powerremovepowersetting)                                         | Deletes the specified power setting.                                                                                                                                                                                                    |
| [**PowerReplaceDefaultPowerSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-powerreplacedefaultpowerschemes)                         | Replaces the power schemes for the default user with the current user's power schemes.                                                                                                                                                  |
| [**PowerRestoreDefaultPowerSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-powerrestoredefaultpowerschemes)                         | Replaces the power schemes for the current user with ones for the default user.                                                                                                                                                         |
| [**PowerRestoreIndividualDefaultPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerrestoreindividualdefaultpowerscheme)       | Replaces a specific power scheme for the current user with one from the default user.                                                                                                                                                   |
| [**PowerSetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powersetactivescheme)                                               | Sets the active power scheme for the current user.                                                                                                                                                                                      |
| [**PowerSetRequest**](/windows/desktop/api/winbase/nf-winbase-powersetrequest)                                                         | Increments the count of power requests of the specified type for a power request object.                                                                                                                                                |
| [**PowerSettingAccessCheck**](/windows/desktop/api/PowrProf/nf-powrprof-powersettingaccesscheck)                                         | Queries for a group policy override for specified power settings.                                                                                                                                                                       |
| [**PowerSettingAccessCheckEx**](/windows/desktop/api/Powrprof/nf-powrprof-powersettingaccesscheckex)                                     | Queries for a group policy override for specified power settings and specifies the requested access for the setting.                                                                                                                    |
| [**PowerSettingRegisterNotification**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingregisternotification)                       | Registers to receive notification when a power setting changes.                                                                                                                                                                         |
| [**PowerSettingUnregisterNotification**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingunregisternotification)                   | Cancels a registration to receive notification when a power setting changes.                                                                                                                                                            |
| [**PowerUnregisterFromEffectivePowerModeNotifications**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingunregisternotification)                   | Unregisters from effective power mode change notifications.                                                                                                                                                             |
| [**PowerUnregisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerunregistersuspendresumenotification)       | Cancels a registration to receive notification when the system is suspended or resumed.                                                                                                                                                 |
| [**PowerWriteACDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerwriteacdefaultindex)                                       | Sets the default AC index of the specified power setting.                                                                                                                                                                               |
| [**PowerWriteACValueIndex**](/windows/desktop/api/Powersetting/nf-powersetting-powerwriteacvalueindex)                                           | Sets the AC value index of the specified power setting.                                                                                                                                                                                 |
| [**PowerWriteDCDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritedcdefaultindex)                                       | Sets the default DC index of the specified power setting.                                                                                                                                                                               |
| [**PowerWriteDCValueIndex**](/windows/desktop/api/Powersetting/nf-powersetting-powerwritedcvalueindex)                                           | Sets the DC index of the specified power setting.                                                                                                                                                                                       |
| [**PowerWriteDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritedescription)                                             | Sets the description for the specified power setting, subgroup, or scheme.                                                                                                                                                              |
| [**PowerWriteFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritefriendlyname)                                           | Sets the friendly name for the specified power setting, subgroup, or scheme.                                                                                                                                                            |
| [**PowerWriteIconResourceSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerwriteiconresourcespecifier)                         | Sets the icon resource for the specified power setting, subgroup, or scheme.                                                                                                                                                            |
| [**PowerWritePossibleDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossibledescription)                             | Sets the description for one of the possible choices of a power setting value.                                                                                                                                                          |
| [**PowerWritePossibleFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossiblefriendlyname)                           | Sets the friendly name for the specified possible setting of a power setting.                                                                                                                                                           |
| [**PowerWritePossibleValue**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossiblevalue)                                         | Sets the value for a possible value of a power setting.                                                                                                                                                                                 |
| [**PowerWriteSettingAttributes**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritesettingattributes)                                 | Sets the power attributes of a power key.                                                                                                                                                                                               |
| [**PowerWriteValueIncrement**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevalueincrement)                                       | Sets the increment for valid values between the power settings minimum and maximum.                                                                                                                                                     |
| [**PowerWriteValueMax**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevaluemax)                                                   | Sets the maximum value for the specified power setting.                                                                                                                                                                                 |
| [**PowerWriteValueMin**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevaluemin)                                                   | Sets the minimum value for the specified power setting.                                                                                                                                                                                 |
| [**PowerWriteValueUnitsSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevalueunitsspecifier)                             | Writes the string used to describe the units of a power setting that supports a range of values.                                                                                                                                        |
| [**RegisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-registerpowersettingnotification)                       | Registers the application to receive power setting notifications for the specific power setting event.                                                                                                                                  |
| [**RegisterSuspendResumeNotification**](/windows/desktop/api/Winuser/nf-winuser-registersuspendresumenotification)                     | Registers to receive notification when the system is suspended or resumed. Similar to [**PowerRegisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerregistersuspendresumenotification), but operates in user mode and can take a window handle. |
| [**SetSuspendState**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate)                                                         | Sets the system suspend state.                                                                                                                                                                                                          |
| [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate)                                         | Enables applications to inform the system that it is in use.                                                                                                                                                                            |
| [**UnregisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-unregisterpowersettingnotification)                   | Unregisters the power setting notification.                                                                                                                                                                                             |
| [**UnregisterSuspendResumeNotification**](/windows/desktop/api/Winuser/nf-winuser-unregistersuspendresumenotification)                 | Cancels a registration to receive notification when the system is suspended or resumed. Similar to [**PowerUnregisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerunregistersuspendresumenotification) but operates in user mode.              |



 

## Power Management Functions: Windows Server 2003 and Earlier

The following functions are supported in Windows Server 2008, Windows Vista, and later versions of Windows for compatibility with earlier versions of Windows. Applications written for Windows Server 2008, Windows Vista and later should use the alternatives listed in this table.



| Windows Server 2003 and earlier                            | Description                                                                           | Windows Server 2008 and Windows Vista                                                                                                                                           |
|------------------------------------------------------------|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CanUserWritePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-canuserwritepwrscheme)     | Determines whether the current user has sufficient privilege to write a power scheme. | [**PowerSettingAccessCheck**](/windows/desktop/api/PowrProf/nf-powrprof-powersettingaccesscheck)                                                                                                                      |
| [**DeletePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-deletepwrscheme)                 | Deletes the specified power scheme.                                                   | [**PowerDeleteScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerdeletescheme)                                                                                                                                  |
| [**EnumPwrSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-enumpwrschemes)                   | Enumerates all power schemes.                                                         | [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate)                                                                                                                                        |
| [**GetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-getactivepwrscheme)           | Retrieves the index of the active power scheme.                                       | [**PowerGetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powergetactivescheme)                                                                                                                            |
| [**GetPwrDiskSpindownRange**](/windows/desktop/api/PowrProf/nf-powrprof-getpwrdiskspindownrange) | Retrieves the disk spindown range.                                                    | Controlled through the GUID\_DISK\_SUBGROUP power settings subgroup. Use the [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) function to enumerate individual settings.                |
| [**IsPwrHibernateAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrhibernateallowed)     | Determines whether the computer supports hibernation.                                 | [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                                                                                                |
| [**IsPwrShutdownAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrshutdownallowed)       | Determines whether the computer supports the soft off power state.                    | Not applicable. Starting with Windows Vista, computers must support soft off.                                                                                                   |
| [**IsPwrSuspendAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrsuspendallowed)         | Determines whether the computer supports the sleep states.                            | [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                                                                                                |
| [**ReadGlobalPwrPolicy**](/windows/desktop/api/PowrProf/nf-powrprof-readglobalpwrpolicy)         | Retrieves the current global power policy settings.                                   | Power read functions                                                                                                                                                            |
| [**ReadProcessorPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-readprocessorpwrscheme)   | Retrieves the processor power policy settings for the specified power scheme.         | Controlled through the GUID\_PROCESSOR\_SETTINGS\_SUBGROUP power settings subgroup. Use the [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) function to enumerate individual settings. |
| [**ReadPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-readpwrscheme)                     | Retrieves the power policy settings that are unique to the specified power scheme.    | Power read functions                                                                                                                                                            |
| [**RequestWakeupLatency**](/windows/desktop/api/WinBase/nf-winbase-requestwakeuplatency)       | Specifies roughly how quickly the computer should enter the working state.            | Not applicable.                                                                                                                                                                 |
| [**SetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-setactivepwrscheme)           | Sets the active power scheme.                                                         | [**PowerSetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powersetactivescheme)                                                                                                                            |
| [**SetSystemPowerState**](/windows/desktop/api/WinBase/nf-winbase-setsystempowerstate)         | Suspends the system by shutting power down.                                           | [**SetSuspendState**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate)                                                                                                                                      |
| [**WriteGlobalPwrPolicy**](/windows/desktop/api/PowrProf/nf-powrprof-writeglobalpwrpolicy)       | Writes global power policy settings.                                                  | Power write functions                                                                                                                                                           |
| [**WriteProcessorPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-writeprocessorpwrscheme) | Writes processor power policy settings for the specified power scheme.                | Controlled through the GUID\_PROCESSOR\_SETTINGS\_SUBGROUP power settings subgroup. Use the [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) function to enumerate individual settings. |
| [**WritePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-writepwrscheme)                   | Writes policy settings that are unique to the power scheme.                           | Power write functions                                                                                                                                                           |



 

 

 



