---
title: Tree View
description: This section contains information about the programming elements used with tree-view controls.
ms.assetid: ee942d66-fbbe-4da0-af5f-4fbc5854c58d
ms.topic: article
ms.date: 05/31/2018
---

# Tree View

This section contains information about the programming elements used with tree-view controls.

### Overviews



| Topic                                              | Contents                                                                                                                                                                                    |
|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [About Tree-View Controls](tree-view-controls.md) | A tree-view control is a window that displays a hierarchical list of items, such as the headings in a document, the entries in an index, or the files and directories on a disk.<br/> |
| [Using Tree-View Controls](using-treeview.md)     | This section contains implementation details and example code for working with tree-view controls.<br/>                                                                               |



 

### Macros



| Topic                                                                     | Contents                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**TreeView\_CreateDragImage**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_createdragimage)             | Creates a dragging bitmap for the specified item in a tree-view control. The macro also creates an image list for the bitmap and adds the bitmap to the image list. An application can display the image when dragging the item by using the image list functions. You can use this macro or send the [**TVM\_CREATEDRAGIMAGE**](tvm-createdragimage.md) message explicitly. <br/>                                                                                                           |
| [**TreeView\_DeleteAllItems**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_deleteallitems)               | Deletes all items from a tree-view control. <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**TreeView\_DeleteItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_deleteitem)                       | Removes an item and all its descendants from a tree-view control. You can also send the [**TVM\_DELETEITEM**](tvm-deleteitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                   |
| [**TreeView\_EditLabel**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_editlabel)                         | Begins in-place editing of the specified item's text, replacing the text of the item with a single-line edit control containing the text. This macro implicitly selects and focuses the specified item. You can use this macro or send the [**TVM\_EDITLABEL**](tvm-editlabel.md) message explicitly. <br/>                                                                                                                                                                                  |
| [**TreeView\_EndEditLabelNow**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_endeditlabelnow)             | Ends the editing of a tree-view item's label. You can use this macro or send the [**TVM\_ENDEDITLABELNOW**](tvm-endeditlabelnow.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                |
| [**TreeView\_EnsureVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_ensurevisible)                 | Ensures that a tree-view item is visible, expanding the parent item or scrolling the tree-view control, if necessary. You can use this macro or send the [**TVM\_ENSUREVISIBLE**](tvm-ensurevisible.md) message explicitly. <br/>                                                                                                                                                                                                                                                            |
| [**TreeView\_Expand**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_expand)                               | The [**TreeView\_Expand**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_expand) macro expands or collapses the list of child items associated with the specified parent item, if any. You can use this macro or send the [**TVM\_EXPAND**](tvm-expand.md) message explicitly. <br/>                                                                                                                                                                                                                                          |
| [**TreeView\_GetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getbkcolor)                       | Retrieves the current background color of the control. You can use this macro or send the [**TVM\_GETBKCOLOR**](tvm-getbkcolor.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                                                                  |
| [**TreeView\_GetCheckState**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getcheckstate)                 | Gets the check state of the specified item. You can also use the [**TVM\_GETITEMSTATE**](tvm-getitemstate.md) message directly. <br/>                                                                                                                                                                                                                                                                                                                                                        |
| [**TreeView\_GetChild**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getchild)                           | Retrieves the first child item of the specified tree-view item. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_CHILD flag. <br/>                                                                                                                                                                                                                                                                                   |
| [**TreeView\_GetCount**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getcount)                           | Retrieves a count of the items in a tree-view control. You can use this macro or send the [**TVM\_GETCOUNT**](tvm-getcount.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**TreeView\_GetDropHilight**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getdrophilight)               | Retrieves the tree-view item that is the target of a drag-and-drop operation. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_DROPHILITE flag. <br/>                                                                                                                                                                                                                                                                |
| [**TreeView\_GetEditControl**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_geteditcontrol)               | Retrieves the handle to the edit control being used to edit a tree-view item's text. You can use this macro or send the [**TVM\_GETEDITCONTROL**](tvm-geteditcontrol.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                           |
| [**TreeView\_GetExtendedStyle**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getextendedstyle)           | Retrieves the extended style for a specified tree-view control. Use this macro or send the [**TVM\_GETEXTENDEDSTYLE**](tvm-getextendedstyle.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                    |
| [**TreeView\_GetFirstVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getfirstvisible)             | Retrieves the first visible item in a tree-view control window. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_FIRSTVISIBLE flag. <br/>                                                                                                                                                                                                                                                                            |
| [**TreeView\_GetImageList**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getimagelist)                   | Retrieves the handle to the normal or state image list associated with a tree-view control. You can use this macro or send the [**TVM\_GETIMAGELIST**](tvm-getimagelist.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                        |
| [**TreeView\_GetIndent**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getindent)                         | Retrieves the amount, in pixels, that child items are indented relative to their parent items. You can use this macro or send the [**TVM\_GETINDENT**](tvm-getindent.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                           |
| [**TreeView\_GetInsertMarkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getinsertmarkcolor)       | Retrieves the color used to draw the insertion mark for the tree view. You can use this macro or send the [**TVM\_GETINSERTMARKCOLOR**](tvm-getinsertmarkcolor.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                 |
| [**TreeView\_GetISearchString**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getisearchstring)           | Retrieves the incremental search string for a tree-view control. The tree-view control uses the incremental search string to select an item based on characters typed by the user. You can use this macro or send the [**TVM\_GETISEARCHSTRING**](tvm-getisearchstring.md) message explicitly. <br/>                                                                                                                                                                                         |
| [**TreeView\_GetItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitem)                             | Retrieves some or all of a tree-view item's attributes. You can use this macro or send the [**TVM\_GETITEM**](tvm-getitem.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                                                                       |
| [**TreeView\_GetItemHeight**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemheight)                 | Retrieves the current height of the tree-view items. You can use this macro or send the [**TVM\_GETITEMHEIGHT**](tvm-getitemheight.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                             |
| [**TreeView\_GetItemPartRect**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitempartrect)             | Retrieves the largest possible bounding rectangle that constitutes the "hit zone" for a specified part of an item. Use this macro or send the [**TVM\_GETITEMPARTRECT**](tvm-getitempartrect.md) message explicitly.<br/>                                                                                                                                                                                                                                                                    |
| [**TreeView\_GetItemRect**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemrect)                     | Retrieves the bounding rectangle for a tree-view item and indicates whether the item is visible. You can use this macro or send the [**TVM\_GETITEMRECT**](tvm-getitemrect.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                     |
| [**TreeView\_GetItemState**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemstate)                   | Retrieves some or all of a tree-view item's state attributes. You can use this macro or send the [**TVM\_GETITEMSTATE**](tvm-getitemstate.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                      |
| [**TreeView\_GetLastVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getlastvisible)               | Retrieves the last expanded item in a tree-view control. This does not retrieve the last item visible in the tree-view window. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_LASTVISIBLE flag. <br/>                                                                                                                                                                                                              |
| [**TreeView\_GetLineColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getlinecolor)                   | Gets the current line color. You can also use the [**TVM\_GETLINECOLOR**](tvm-getlinecolor.md) message directly. <br/>                                                                                                                                                                                                                                                                                                                                                                       |
| [**TreeView\_GetNextItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextitem)                     | Retrieves the tree-view item that bears the specified relationship to a specified item. You can use this macro, use one of the **TreeView\_Get** macros described below, or send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message explicitly. <br/>                                                                                                                                                                                                                                    |
| [**TreeView\_GetNextSelected**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextselected)             | Retrieves the tree-view item that bears the TVGN\_NEXTSELECTED relationship to a specified tree item.<br/>                                                                                                                                                                                                                                                                                                                                                                                    |
| [**TreeView\_GetNextSibling**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextsibling)               | Retrieves the next sibling item of a specified item in a tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_NEXT flag. <br/>                                                                                                                                                                                                                                                                        |
| [**TreeView\_GetNextVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextvisible)               | Retrieves the next visible item that follows a specified item in a tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_NEXTVISIBLE flag. <br/>                                                                                                                                                                                                                                                       |
| [**TreeView\_GetParent**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getparent)                         | Retrieves the parent item of the specified tree-view item. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_PARENT flag. <br/>                                                                                                                                                                                                                                                                                       |
| [**TreeView\_GetPrevSibling**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevsibling)               | Retrieves the previous sibling item of a specified item in a tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_PREVIOUS flag. <br/>                                                                                                                                                                                                                                                                |
| [**TreeView\_GetPrevVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getprevvisible)               | Retrieves the first visible item that precedes a specified item in a tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_PREVIOUSVISIBLE flag. <br/>                                                                                                                                                                                                                                                 |
| [**TreeView\_GetRoot**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getroot)                             | Retrieves the topmost or very first item of the tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_ROOT flag. <br/>                                                                                                                                                                                                                                                                                 |
| [**TreeView\_GetScrollTime**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getscrolltime)                 | Retrieves the maximum scroll time for the tree-view control. You can use this macro or send the [**TVM\_GETSCROLLTIME**](tvm-getscrolltime.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                     |
| [**TreeView\_GetSelectedCount**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getselectedcount)           | Not implemented.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**TreeView\_GetSelection**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getselection)                   | Retrieves the currently selected item in a tree-view control. You can use this macro, or you can explicitly send the [**TVM\_GETNEXTITEM**](tvm-getnextitem.md) message with the TVGN\_CARET flag. <br/>                                                                                                                                                                                                                                                                                     |
| [**TreeView\_GetTextColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_gettextcolor)                   | Retrieves the current text color of the control. You can use this macro or send the [**TVM\_GETTEXTCOLOR**](tvm-gettextcolor.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                   |
| [**TreeView\_GetToolTips**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_gettooltips)                     | Retrieves the handle to the child tooltip control used by a tree-view control. You can use this macro or send the [**TVM\_GETTOOLTIPS**](tvm-gettooltips.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                       |
| [**TreeView\_GetUnicodeFormat**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getunicodeformat)           | Retrieves the Unicode character format flag for the control. You can use this macro or send the [**TVM\_GETUNICODEFORMAT**](tvm-getunicodeformat.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                               |
| [**TreeView\_GetVisibleCount**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getvisiblecount)             | Obtains the number of items that can be fully visible in the client window of a tree-view control. You can use this macro or send the [**TVM\_GETVISIBLECOUNT**](tvm-getvisiblecount.md) message explicitly. <br/>                                                                                                                                                                                                                                                                           |
| [**TreeView\_HitTest**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_hittest)                             | Determines the location of the specified point relative to the client area of a tree-view control. You can use this macro or send the [**TVM\_HITTEST**](tvm-hittest.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                           |
| [**TreeView\_InsertItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_insertitem)                       | Inserts a new item in a tree-view control. You can use this macro or send the [**TVM\_INSERTITEM**](tvm-insertitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                             |
| [**TreeView\_MapAccIDToHTREEITEM**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_mapaccidtohtreeitem)     | Maps an accessibility ID to an **HTREEITEM**. You can use this macro or send the [**TVM\_MAPACCIDTOHTREEITEM**](tvm-mapaccidtohtreeitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                        |
| [**TreeView\_MapHTREEITEMtoAccID**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_maphtreeitemtoaccid)     | Maps an **HTREEITEM** to an accessibility ID. You can use this macro or send the [**TVM\_MAPHTREEITEMTOACCID**](tvm-maphtreeitemtoaccid.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                        |
| [**TreeView\_Select**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_select)                               | Selects the specified tree-view item, scrolls the item into view, or redraws the item in the style used to indicate the target of a drag-and-drop operation. You can use this macro or the [**TreeView\_SelectItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectitem), [**TreeView\_SelectSetFirstVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectsetfirstvisible), or [**TreeView\_SelectDropTarget**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectdroptarget) macros, or you can send the [**TVM\_SELECTITEM**](tvm-selectitem.md) message explicitly. <br/> |
| [**TreeView\_SelectDropTarget**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectdroptarget)           | Redraws a specified tree-view control item in the style used to indicate the target of a drag-and-drop operation. You can use this macro or the [**TreeView\_Select**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_select) macro, or you can send the [**TVM\_SELECTITEM**](tvm-selectitem.md) message explicitly. <br/>                                                                                                                                                                                                    |
| [**TreeView\_SelectItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectitem)                       | Selects the specified tree-view item. You can use this macro or the [**TreeView\_Select**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_select) macro, or you can send the [**TVM\_SELECTITEM**](tvm-selectitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                |
| [**TreeView\_SelectSetFirstVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectsetfirstvisible) | Scrolls the tree-view control vertically to ensure that the specified item is visible. If possible, the specified item becomes the first visible item at the top of the control's window. You can use this macro or the [**TreeView\_Select**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_select) macro, or you can send the [**TVM\_SELECTITEM**](tvm-selectitem.md) message explicitly. <br/>                                                                                                                            |
| [**TreeView\_SetAutoScrollInfo**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setautoscrollinfo)         | Sets information used to determine auto-scroll characteristics. Use this macro or send the [**TVM\_SETAUTOSCROLLINFO**](tvm-setautoscrollinfo.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                                                   |
| [**TreeView\_SetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setbkcolor)                       | Sets the background color of the control. You can use this macro or send the [**TVM\_SETBKCOLOR**](tvm-setbkcolor.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                              |
| [**TreeView\_SetBorder**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setborder)                         | **Intended for internal use; not recommended for use in applications.**<br/> Sets the size of the border for the items in a tree-view control. You can use this macro or send the [**TVM\_SETBORDER**](tvm-setborder.md) message explicitly.<br/>                                                                                                                                                                                                                                      |
| [**TreeView\_SetCheckState**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setcheckstate)                 | Sets the item's state image to "checked" or "unchecked." You can also use the [**TVM\_SETITEM**](tvm-setitem.md) message directly.<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**TreeView\_SetExtendedStyle**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setextendedstyle)           | Sets the extended style for a specified TreeView control. Use this macro or send the [**TVM\_SETEXTENDEDSTYLE**](tvm-setextendedstyle.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                                                           |
| [**TreeView\_SetHot**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sethot)                               | **Intended for internal use; not recommended for use in applications.**<br/> Sets the hot item for a tree-view control. You can use this macro or send the [**TVM\_SETHOT**](tvm-sethot.md) message explicitly.<br/>                                                                                                                                                                                                                                                                   |
| [**TreeView\_SetImageList**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setimagelist)                   | Sets the normal or state image list for a tree-view control and redraws the control using the new images. You can use this macro or send the [**TVM\_SETIMAGELIST**](tvm-setimagelist.md) message explicitly. <br/>                                                                                                                                                                                                                                                                          |
| [**TreeView\_SetIndent**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setindent)                         | Sets the width of indentation for a tree-view control and redraws the control to reflect the new width. You can use this macro or send the [**TVM\_SETINDENT**](tvm-setindent.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                   |
| [**TreeView\_SetInsertMark**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setinsertmark)                 | Sets the insertion mark in a tree-view control. You can use this macro or send the [**TVM\_SETINSERTMARK**](tvm-setinsertmark.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                  |
| [**TreeView\_SetInsertMarkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setinsertmarkcolor)       | Sets the color used to draw the insertion mark for the tree view. You can use this macro or send the [**TVM\_SETINSERTMARKCOLOR**](tvm-setinsertmarkcolor.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                      |
| [**TreeView\_SetItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitem)                             | The [**TreeView\_SetItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitem) macro sets some or all of a tree-view item's attributes. You can use this macro or send the [**TVM\_SETITEM**](tvm-setitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                   |
| [**TreeView\_SetItemHeight**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitemheight)                 | Sets the height of the tree-view items. You can use this macro or send the [**TVM\_SETITEMHEIGHT**](tvm-setitemheight.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                          |
| [**TreeView\_SetItemState**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitemstate)                   | Sets a tree-view item's state attributes. You can use this macro or send the [**TVM\_SETITEM**](tvm-setitem.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**TreeView\_SetLineColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setlinecolor)                   | Sets the current line color. You can also use the [**TVM\_SETLINECOLOR**](tvm-setlinecolor.md) message directly. <br/>                                                                                                                                                                                                                                                                                                                                                                       |
| [**TreeView\_SetScrollTime**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setscrolltime)                 | Sets the maximum scroll time for the tree-view control. You can use this macro or send the [**TVM\_SETSCROLLTIME**](tvm-setscrolltime.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                          |
| [**TreeView\_SetTextColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_settextcolor)                   | Sets the text color of the control. You can use this macro or send the [**TVM\_SETTEXTCOLOR**](tvm-settextcolor.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                                |
| [**TreeView\_SetToolTips**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_settooltips)                     | Sets a tree-view control's child tooltip control. You can use this macro or send the [**TVM\_SETTOOLTIPS**](tvm-settooltips.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                                                    |
| [**TreeView\_SetUnicodeFormat**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setunicodeformat)           | Sets the Unicode character format flag for the control. This message allows you to change the character set used by the control at run time rather than having to re-create the control. You can use this macro or send the [**TVM\_SETUNICODEFORMAT**](tvm-setunicodeformat.md) message explicitly. <br/>                                                                                                                                                                                   |
| [**TreeView\_ShowInfoTip**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_showinfotip)                     | Shows the infotip for a specified item in a tree-view control. Use this macro or send the [**TVM\_SHOWINFOTIP**](tvm-showinfotip.md) message explicitly.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**TreeView\_SortChildren**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sortchildren)                   | Sorts the child items of the specified parent item in a tree-view control. You can use this macro or send the [**TVM\_SORTCHILDREN**](tvm-sortchildren.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                                         |
| [**TreeView\_SortChildrenCB**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sortchildrencb)               | Sorts tree-view items using an application-defined callback function that compares the items. You can use this macro or send the [**TVM\_SORTCHILDRENCB**](tvm-sortchildrencb.md) message explicitly. <br/>                                                                                                                                                                                                                                                                                  |



 

### Messages



| Topic                                                       | Contents                                                                                                                                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**TVM\_CREATEDRAGIMAGE**](tvm-createdragimage.md)         | Creates a dragging bitmap for the specified item in a tree-view control. The message also creates an image list for the bitmap and adds the bitmap to the image list. An application can display the image when dragging the item by using the image list functions. You can send this message explicitly or by using the [**TreeView\_CreateDragImage**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_createdragimage) macro. <br/> |
| [**TVM\_DELETEITEM**](tvm-deleteitem.md)                   | Removes an item and all its descendants from a tree-view control. You can send this message explicitly or by using the [**TreeView\_DeleteItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_deleteitem) macro. <br/>                                                                                                                                                                                                              |
| [**TVM\_EDITLABEL**](tvm-editlabel.md)                     | Begins in-place editing of the specified item's text, replacing the text of the item with a single-line edit control containing the text. This message implicitly selects and focuses the specified item. You can send this message explicitly or by using the [**TreeView\_EditLabel**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_editlabel) macro. <br/>                                                                        |
| [**TVM\_ENDEDITLABELNOW**](tvm-endeditlabelnow.md)         | Ends the editing of a tree-view item's label. You can send this message explicitly or by using the [**TreeView\_EndEditLabelNow**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_endeditlabelnow) macro. <br/>                                                                                                                                                                                                                        |
| [**TVM\_ENSUREVISIBLE**](tvm-ensurevisible.md)             | Ensures that a tree-view item is visible, expanding the parent item or scrolling the tree-view control, if necessary. You can send this message explicitly or by using the [**TreeView\_EnsureVisible**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_ensurevisible) macro. <br/>                                                                                                                                                    |
| [**TVM\_EXPAND**](tvm-expand.md)                           | The [**TVM\_EXPAND**](tvm-expand.md) message expands or collapses the list of child items associated with the specified parent item, if any. You can send this message explicitly or by using the [**TreeView\_Expand**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_expand) macro. <br/>                                                                                                                                          |
| [**TVM\_GETBKCOLOR**](tvm-getbkcolor.md)                   | Retrieves the current background color of the control. You can send this message explicitly or by using the [**TreeView\_GetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getbkcolor) macro. <br/>                                                                                                                                                                                                                         |
| [**TVM\_GETCOUNT**](tvm-getcount.md)                       | Retrieves a count of the items in a tree-view control. You can send this message explicitly or by using the [**TreeView\_GetCount**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getcount) macro. <br/>                                                                                                                                                                                                                             |
| [**TVM\_GETEDITCONTROL**](tvm-geteditcontrol.md)           | Retrieves the handle to the edit control being used to edit a tree-view item's text. You can send this message explicitly or by using the [**TreeView\_GetEditControl**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_geteditcontrol) macro. <br/>                                                                                                                                                                                   |
| [**TVM\_GETEXTENDEDSTYLE**](tvm-getextendedstyle.md)       | Retrieves the extended style for a tree-view control. Send this message explicitly or by using the [**TreeView\_GetExtendedStyle**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getextendedstyle) macro. <br/>                                                                                                                                                                                                                      |
| [**TVM\_GETIMAGELIST**](tvm-getimagelist.md)               | Retrieves the handle to the normal or state image list associated with a tree-view control. You can send this message explicitly or by using the [**TreeView\_GetImageList**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getimagelist) macro. <br/>                                                                                                                                                                                |
| [**TVM\_GETINDENT**](tvm-getindent.md)                     | Retrieves the amount, in pixels, that child items are indented relative to their parent items. You can send this message explicitly or by using the [**TreeView\_GetIndent**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getindent) macro. <br/>                                                                                                                                                                                   |
| [**TVM\_GETINSERTMARKCOLOR**](tvm-getinsertmarkcolor.md)   | Retrieves the color used to draw the insertion mark for the tree view. You can send this message explicitly or by using the [**TreeView\_GetInsertMarkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getinsertmarkcolor) macro. <br/>                                                                                                                                                                                         |
| [**TVM\_GETISEARCHSTRING**](tvm-getisearchstring.md)       | Retrieves the incremental search string for a tree-view control. The tree-view control uses the incremental search string to select an item based on characters typed by the user. You can send this message explicitly or by using the [**TreeView\_GetISearchString**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getisearchstring) macro. <br/>                                                                                 |
| [**TVM\_GETITEM**](tvm-getitem.md)                         | Retrieves some or all of a tree-view item's attributes. You can send this message explicitly or by using the [**TreeView\_GetItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitem) macro.<br/>                                                                                                                                                                                                                               |
| [**TVM\_GETITEMHEIGHT**](tvm-getitemheight.md)             | Retrieves the current height of the each tree-view item. You can send this message explicitly or by using the [**TreeView\_GetItemHeight**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemheight) macro. <br/>                                                                                                                                                                                                                 |
| [**TVM\_GETITEMPARTRECT**](tvm-getitempartrect.md)         | Not implemented.<br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [**TVM\_GETITEMRECT**](tvm-getitemrect.md)                 | Retrieves the bounding rectangle for a tree-view item and indicates whether the item is visible. You can send this message explicitly or by using the [**TreeView\_GetItemRect**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemrect) macro. <br/>                                                                                                                                                                             |
| [**TVM\_GETITEMSTATE**](tvm-getitemstate.md)               | Retrieves some or all of a tree-view item's state attributes. You can send this message explicitly or by using the [**TreeView\_GetItemState**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitemstate) macro. <br/>                                                                                                                                                                                                              |
| [**TVM\_GETLINECOLOR**](tvm-getlinecolor.md)               | The [**TVM\_GETLINECOLOR**](tvm-getlinecolor.md) message gets the current line color. <br/>                                                                                                                                                                                                                                                                                                         |
| [**TVM\_GETNEXTITEM**](tvm-getnextitem.md)                 | Retrieves the tree-view item that bears the specified relationship to a specified item. You can send this message explicitly, by using the [**TreeView\_GetNextItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getnextitem) macro.<br/>                                                                                                                                                                                         |
| [**TVM\_GETSCROLLTIME**](tvm-getscrolltime.md)             | Retrieves the maximum scroll time for the tree-view control. You can send this message explicitly or by using the [**TreeView\_GetScrollTime**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getscrolltime) macro. <br/>                                                                                                                                                                                                             |
| [**TVM\_GETSELECTEDCOUNT**](tvm-getselectedcount.md)       | Not implemented.<br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [**TVM\_GETTEXTCOLOR**](tvm-gettextcolor.md)               | Retrieves the current text color of the control. You can send this message explicitly or by using the [**TreeView\_GetTextColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_gettextcolor) macro. <br/>                                                                                                                                                                                                                           |
| [**TVM\_GETTOOLTIPS**](tvm-gettooltips.md)                 | Retrieves the handle to the child tooltip control used by a tree-view control. You can send this message explicitly or by using the [**TreeView\_GetToolTips**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_gettooltips) macro. <br/>                                                                                                                                                                                               |
| [**TVM\_GETUNICODEFORMAT**](tvm-getunicodeformat.md)       | Retrieves the Unicode character format flag for the control. You can send this message explicitly or use the [**TreeView\_GetUnicodeFormat**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getunicodeformat) macro. <br/>                                                                                                                                                                                                            |
| [**TVM\_GETVISIBLECOUNT**](tvm-getvisiblecount.md)         | Obtains the number of items that can be fully visible in the client window of a tree-view control. You can send this message explicitly or by using the [**TreeView\_GetVisibleCount**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getvisiblecount) macro. <br/>                                                                                                                                                                   |
| [**TVM\_HITTEST**](tvm-hittest.md)                         | Determines the location of the specified point relative to the client area of a tree-view control. You can send this message explicitly or by using the [**TreeView\_HitTest**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_hittest) macro. <br/>                                                                                                                                                                                   |
| [**TVM\_INSERTITEM**](tvm-insertitem.md)                   | Inserts a new item in a tree-view control. You can send this message explicitly or by using the [**TreeView\_InsertItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_insertitem) macro. <br/>                                                                                                                                                                                                                                     |
| [**TVM\_MAPACCIDTOHTREEITEM**](tvm-mapaccidtohtreeitem.md) | Maps an accessibility ID to an **HTREEITEM**. <br/>                                                                                                                                                                                                                                                                                                                                                  |
| [**TVM\_MAPHTREEITEMTOACCID**](tvm-maphtreeitemtoaccid.md) | Maps an **HTREEITEM** to an accessibility ID.<br/>                                                                                                                                                                                                                                                                                                                                                   |
| [**TVM\_SELECTITEM**](tvm-selectitem.md)                   | Selects the specified tree-view item, scrolls the item into view, or redraws the item in the style used to indicate the target of a drag-and-drop operation. You can send this message explicitly or by using the [**TreeView\_Select**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_select), [**TreeView\_SelectItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectitem), or [**TreeView\_SelectDropTarget**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_selectdroptarget) macro. <br/>  |
| [**TVM\_SETAUTOSCROLLINFO**](tvm-setautoscrollinfo.md)     | Sets information used to determine auto-scroll characteristics. You can send this message explicitly or by using the [**TreeView\_SetAutoScrollInfo**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setautoscrollinfo) macro. <br/>                                                                                                                                                                                                  |
| [**TVM\_SETBKCOLOR**](tvm-setbkcolor.md)                   | Sets the background color of the control. You can send this message explicitly or by using the [**TreeView\_SetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setbkcolor) macro. <br/>                                                                                                                                                                                                                                      |
| [**TVM\_SETBORDER**](tvm-setborder.md)                     | **Intended for internal use; not recommended for use in applications.**<br/> Sets the size of the border for the items in a tree-view control. You can send the message explicitly or by using the [**TreeView\_SetBorder**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setborder) macro.<br/>                                                                                                                               |
| [**TVM\_SETEXTENDEDSTYLE**](tvm-setextendedstyle.md)       | Informs the tree-view control to set extended styles. Send this message or use the macro [**TreeView\_SetExtendedStyle**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setextendedstyle).<br/>                                                                                                                                                                                                                                       |
| [**TVM\_SETHOT**](tvm-sethot.md)                           | **Intended for internal use; not recommended for use in applications.**<br/> Sets the hot item for a tree-view control. You can send this message explicitly or by using the [**TreeView\_SetHot**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sethot) macro.<br/>                                                                                                                                                           |
| [**TVM\_SETIMAGELIST**](tvm-setimagelist.md)               | Sets the normal or state image list for a tree-view control and redraws the control using the new images. You can send this message explicitly or by using the [**TreeView\_SetImageList**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setimagelist) macro. <br/>                                                                                                                                                                  |
| [**TVM\_SETINDENT**](tvm-setindent.md)                     | Sets the width of indentation for a tree-view control and redraws the control to reflect the new width. You can send this message explicitly or by using the [**TreeView\_SetIndent**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setindent) macro. <br/>                                                                                                                                                                          |
| [**TVM\_SETINSERTMARK**](tvm-setinsertmark.md)             | Sets the insertion mark in a tree-view control. You can send this message explicitly or by using the [**TreeView\_SetInsertMark**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setinsertmark) macro. <br/>                                                                                                                                                                                                                          |
| [**TVM\_SETINSERTMARKCOLOR**](tvm-setinsertmarkcolor.md)   | Sets the color used to draw the insertion mark for the tree view. You can send this message explicitly or by using the [**TreeView\_SetInsertMarkColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setinsertmarkcolor) macro. <br/>                                                                                                                                                                                              |
| [**TVM\_SETITEM**](tvm-setitem.md)                         | The [**TVM\_SETITEM**](tvm-setitem.md) message sets some or all of a tree-view item's attributes. You can send this message explicitly or by using the [**TreeView\_SetItem**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitem) macro.<br/>                                                                                                                                                                                    |
| [**TVM\_SETITEMHEIGHT**](tvm-setitemheight.md)             | Sets the height of the tree-view items. You can send this message explicitly or by using the [**TreeView\_SetItemHeight**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setitemheight) macro. <br/>                                                                                                                                                                                                                                  |
| [**TVM\_SETLINECOLOR**](tvm-setlinecolor.md)               | The [**TVM\_SETLINECOLOR**](tvm-setlinecolor.md) message sets the current line color. <br/>                                                                                                                                                                                                                                                                                                         |
| [**TVM\_SETSCROLLTIME**](tvm-setscrolltime.md)             | Sets the maximum scroll time for the tree-view control. You can send this message explicitly or by using the [**TreeView\_SetScrollTime**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setscrolltime) macro. <br/>                                                                                                                                                                                                                  |
| [**TVM\_SETTEXTCOLOR**](tvm-settextcolor.md)               | Sets the text color of the control. You can send this message explicitly or by using the [**TreeView\_SetTextColor**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_settextcolor) macro. <br/>                                                                                                                                                                                                                                        |
| [**TVM\_SETTOOLTIPS**](tvm-settooltips.md)                 | Sets a tree-view control's child tooltip control. You can send this message explicitly or by using the [**TreeView\_SetToolTips**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_settooltips) macro. <br/>                                                                                                                                                                                                                            |
| [**TVM\_SETUNICODEFORMAT**](tvm-setunicodeformat.md)       | Sets the Unicode character format flag for the control. This message allows you to change the character set used by the control at run time rather than having to re-create the control. You can send this message explicitly or use the [**TreeView\_SetUnicodeFormat**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_setunicodeformat) macro. <br/>                                                                                |
| [**TVM\_SHOWINFOTIP**](tvm-showinfotip.md)                 | Shows the infotip for a specified item in a tree-view control. You can send this message explicitly or by using the [**TreeView\_ShowInfoTip**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_showinfotip) macro..<br/>                                                                                                                                                                                                               |
| [**TVM\_SORTCHILDREN**](tvm-sortchildren.md)               | Sorts the child items of the specified parent item in a tree-view control. You can send this message explicitly or by using the [**TreeView\_SortChildren**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sortchildren) macro.<br/>                                                                                                                                                                                                  |
| [**TVM\_SORTCHILDRENCB**](tvm-sortchildrencb.md)           | Sorts tree-view items using an application-defined callback function that compares the items. You can send this message explicitly or by using the [**TreeView\_SortChildrenCB**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_sortchildrencb) macro. <br/>                                                                                                                                                                          |



 

### Notifications



| Topic                                                     | Contents                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [NM\_CLICK (tree view)](nm-click-tree-view.md)           | Notifies the parent window of a tree-view control that the user has clicked the left mouse button within the control. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                  |
| [NM\_CUSTOMDRAW (tree view)](nm-customdraw-tree-view.md) | Sent by a tree-view control to notify its parent window about drawing operations. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                                                      |
| [NM\_DBLCLK (tree view)](nm-dblclk-tree-view.md)         | Notifies the parent window of a tree-view control that the user has double-clicked the left mouse button within the control. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                           |
| [NM\_KILLFOCUS (tree view)](nm-killfocus-tree-view.md)   | Notifies a tree-view control's parent window that the control has lost the input focus. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                                               |
| [NM\_RCLICK (tree view)](nm-rclick-tree-view.md)         | Notifies the parent window of a tree-view control that the user has clicked the right mouse button within the control. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                 |
| [NM\_RDBLCLK (tree view)](nm-rdblclk-tree-view.md)       | Notifies the parent of a tree-view control that the user has double-clicked the right mouse button within the control. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                 |
| [NM\_RETURN (tree view)](nm-return-tree-view-.md)        | Notifies a tree-view control's parent window that the control has the input focus and that the user has pressed the key. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                              |
| [NM\_SETCURSOR (tree view)](nm-setcursor-tree-view-.md)  | Notifies a tree-view control's parent window that the control is setting the cursor in response to a [**WM\_SETCURSOR**](/windows/desktop/menurc/wm-setcursor) message. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                |
| [NM\_SETFOCUS (tree view)](nm-setfocus-tree-view-.md)    | Notifies a tree-view control's parent window that the control has received the input focus. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                                           |
| [TVN\_ASYNCDRAW](tvn-asyncdraw.md)                       | Sent by a tree-view control to its parent when the drawing of a icon or overlay has failed. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                                       |
| [TVN\_BEGINDRAG](tvn-begindrag.md)                       | Notifies a tree-view control's parent window that a drag-and-drop operation involving the left mouse button is being initiated. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                  |
| [TVN\_BEGINLABELEDIT](tvn-beginlabeledit.md)             | Notifies a tree-view control's parent window about the start of label editing for an item. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                                       |
| [TVN\_BEGINRDRAG](tvn-beginrdrag.md)                     | Notifies a tree-view control's parent window about the initiation of a drag-and-drop operation involving the right mouse button. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                 |
| [TVN\_DELETEITEM](tvn-deleteitem.md)                     | Notifies a tree-view control's parent window that an item is being deleted. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                                                      |
| [TVN\_ENDLABELEDIT](tvn-endlabeledit.md)                 | Notifies a tree-view control's parent window about the end of label editing for an item. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                                         |
| [TVN\_GETDISPINFO](tvn-getdispinfo.md)                   | Requests that a tree-view control's parent window provide information needed to display or sort an item. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                         |
| [TVN\_GETINFOTIP](tvn-getinfotip.md)                     | Sent by a tree-view control that has the [**TVS\_INFOTIP**](tree-view-control-window-styles.md) style. This notification is sent when the control is requesting additional text information to be displayed in a tooltip. The notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/> |
| [TVN\_ITEMCHANGED](tvn-itemchanged.md)                   | Notifies a tree-view control's parent window that item attributes have changed. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                                                   |
| [TVN\_ITEMCHANGING](tvn-itemchanging.md)                 | Notifies a tree-view control's parent window that item attributes are about to change. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                                                                                                                            |
| [TVN\_ITEMEXPANDED](tvn-itemexpanded.md)                 | Notifies a tree-view control's parent window that a parent item's list of child items has expanded or collapsed. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                 |
| [TVN\_ITEMEXPANDING](tvn-itemexpanding.md)               | Notifies a tree-view control's parent window that a parent item's list of child items is about to expand or collapse. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                            |
| [TVN\_KEYDOWN](tvn-keydown.md)                           | Notifies a tree-view control's parent window that the user pressed a key and the tree-view control has the input focus. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                          |
| [TVN\_SELCHANGED](tvn-selchanged.md)                     | Notifies a tree-view control's parent window that the selection has changed from one item to another. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                            |
| [TVN\_SELCHANGING](tvn-selchanging.md)                   | Notifies a tree-view control's parent window that the selection is about to change from one item to another. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                     |
| [TVN\_SETDISPINFO](tvn-setdispinfo.md)                   | Notifies a tree-view control's parent window that it must update the information it maintains about an item. This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message. <br/>                                                                                                                     |
| [TVN\_SINGLEEXPAND](tvn-singleexpand.md)                 | Sent by a tree-view control with the [**TVS\_SINGLEEXPAND**](tree-view-control-window-styles.md) style when the user opens or closes a tree item using a single click of the mouse. This notification is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.<br/>                                  |



 

### Structures



| Topic                                                    | Contents                                                                                                                                                                                                                                                                                                                                                            |
|----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**NMTREEVIEW**](/windows/win32/api/commctrl/ns-commctrl-nmtreeviewa)                         | Contains information about a tree-view notification code. This structure is identical to the **NM\_TREEVIEW** structure, but it has been renamed to follow current naming conventions. <br/>                                                                                                                                                                  |
| [**NMTVASYNCDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmtvasyncdraw)                   | Contains an explanation of why the draw of an icon or overlay tree item failed. This structure is sent on a [TVN\_ASYNCDRAW](tvn-asyncdraw.md) notification. Set the **dwRetFlags** member to indicate what action the control should take. Note that a draw can fail if there is no image; in other words, when the icon image has not been extracted.<br/> |
| [**NMTVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw)                 | Contains information specific to an [NM\_CUSTOMDRAW (tree view)](nm-customdraw-tree-view.md) notification code sent by a tree-view control. <br/>                                                                                                                                                                                                            |
| [**NMTVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoa)                     | Contains and receives display information for a tree-view item. This structure is identical to the **TV\_DISPINFO** structure, but it has been renamed to follow current naming conventions. <br/>                                                                                                                                                            |
| [**NMTVDISPINFOEX**](/windows/win32/api/commctrl/ns-commctrl-nmtvdispinfoexa)                 | Contains information pertaining to extended TreeView notification information.<br/>                                                                                                                                                                                                                                                                           |
| [**NMTVGETINFOTIP**](/windows/win32/api/commctrl/ns-commctrl-nmtvgetinfotipa)                 | Contains and receives tree-view item information needed to display a tooltip for an item. This structure is used with the [TVN\_GETINFOTIP](tvn-getinfotip.md) notification code. <br/>                                                                                                                                                                      |
| [**NMTVITEMCHANGE**](/windows/win32/api/commctrl/ns-commctrl-nmtvitemchange)                 | Contains information on a tree-view item change. This structure is sent with the [TVN\_ITEMCHANGED](tvn-itemchanged.md) and [TVN\_ITEMCHANGING](tvn-itemchanging.md) notifications. <br/>                                                                                                                                                                   |
| [**NMTVITEMRECT**](/previous-versions/windows/desktop/legacy/bb773428(v=vs.85))                     | Not currently supported.<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**NMTVKEYDOWN**](/windows/win32/api/commctrl/ns-commctrl-nmtvkeydown)                       | Contains information about a keyboard event in a tree-view control. This structure is used with the [TVN\_KEYDOWN](tvn-keydown.md) notification code. The structure is identical to the **TV\_KEYDOWN** structure, but it has been renamed to follow current naming conventions. <br/>                                                                       |
| [**NMTVSTATEIMAGECHANGING**](/windows/win32/api/commctrl/ns-commctrl-nmtvstateimagechanging) | Contains information about a tree-view state image changing notification code.<br/>                                                                                                                                                                                                                                                                           |
| [**TVGETITEMPARTRECTINFO**](/windows/win32/api/commctrl/ns-commctrl-tvgetitempartrectinfo)   | Contains information for identifying the "hit zone" for a specified part of a tree item. The structure is used with the [**TVM\_GETITEMPARTRECT**](tvm-getitempartrect.md) message and the [**TreeView\_GetItemPartRect**](/windows/desktop/api/Commctrl/nf-commctrl-treeview_getitempartrect) macro.<br/>                                                                                         |
| [**TVHITTESTINFO**](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)                   | Contains information used to determine the location of a point relative to a tree-view control. This structure is used with the [**TVM\_HITTEST**](tvm-hittest.md) message. The structure is identical to the **TV\_HITTESTINFO** structure, but it has been renamed to follow current naming conventions. <br/>                                             |
| [**TVINSERTSTRUCT**](/windows/win32/api/commctrl/ns-commctrl-tvinsertstructa)                 | Contains information used to add a new item to a tree-view control. This structure is used with the [**TVM\_INSERTITEM**](tvm-insertitem.md) message. The structure is identical to the **TV\_INSERTSTRUCT** structure, but it has been renamed to follow current naming conventions. <br/>                                                                  |
| [**TVITEM**](/windows/win32/api/commctrl/ns-commctrl-tvitema)                                 | Specifies or receives attributes of a tree-view item. This structure is identical to the **TV\_ITEM** structure, but it has been renamed to follow current naming conventions. New applications should use this structure.<br/>                                                                                                                               |
| [**TVITEMEX**](/windows/win32/api/commctrl/ns-commctrl-tvitemexa)                             | Specifies or receives attributes of a tree-view item. This structure is an enhancement to the [**TVITEM**](/windows/win32/api/commctrl/ns-commctrl-tvitema) structure. New applications should use this structure where appropriate.<br/>                                                                                                                                                          |
| [**TVSORTCB**](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)                             | Contains information used to sort child items in a tree-view control. This structure is used with the [**TVM\_SORTCHILDRENCB**](tvm-sortchildrencb.md) message. This structure is identical to the **TV\_SORTCB** structure, but it has been renamed to follow current naming conventions. <br/>                                                             |



 

### Constants



| Topic                                                                             | Contents                                                                                                                                                    |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Tree-View Control Extended Styles](tree-view-control-window-extended-styles.md) | This section lists extended styles used when creating tree-view controls. The value of extended styles is a bitwise combination of these styles.<br/> |
| [Tree-View Control Item States](tree-view-control-item-states.md)                | This section lists the item state flags used to indicate the state of an item in a tree-view control. <br/>                                           |
| [Tree-View Control Window Styles](tree-view-control-window-styles.md)            | This section lists window styles used when creating tree-view controls. <br/>                                                                         |



 

 

