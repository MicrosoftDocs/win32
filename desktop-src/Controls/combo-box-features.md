---
title: Combo Box Features
description: This document discusses features of the combo box.
ms.assetid: 7102beff-7f67-4e4e-a32b-9ccae1522ebd
ms.topic: article
ms.date: 05/31/2018
---

# Combo Box Features

This document discusses features of the combo box. For more information, see the following topics:

-   [Special Features](#special-features)
    -   [Directory Lists](#directory-lists)
    -   [Data Associated with List Items](#data-associated-with-list-items)
    -   [The Extended User Interface](#the-extended-user-interface)
    -   [Cue Banners](#cue-banners)
-   [Combo Box Notifications](#combo-box-notifications)
-   [Default Combo Box Behavior](#default-combo-box-behavior)

## Special Features

There are special-purpose messages and functions that enable an application to display a directory listing in a combo box, associate data with list items in a combo box, and change the keyboard interface for a drop-down combo box or drop-down list box.

-   [Directory Lists](#directory-lists)
-   [Data Associated with List Items](#data-associated-with-list-items)
-   [The Extended User Interface](#the-extended-user-interface)
-   [Cue Banners](#cue-banners)

### Directory Lists

An application can add the names of files or subdirectories to a combo box by sending the [**CB\_DIR**](cb-dir.md) message to it. The *wParam* parameter for this message specifies the attributes of the files to add, and the *lParam* parameter is a pointer to the text string that defines the file specification.

You can use the [**DlgDirListComboBox**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlistcomboboxa) function to replace the contents of a combo box in a dialog box. The function fills the combo box with the names of drives, directories, and files that match a specified set of criteria. The [**DlgDirSelectComboBoxEx**](/windows/desktop/api/Winuser/nf-winuser-dlgdirselectcomboboxexa) function retrieves the current selection in a combo box initialized by **DlgDirListComboBox**. These functions make it possible for the user to select a drive, directory, or file from a combo box without typing the location and name of the file.

The [**DlgDirListComboBox**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlistcomboboxa) and [**DlgDirSelectComboBoxEx**](/windows/desktop/api/Winuser/nf-winuser-dlgdirselectcomboboxexa) functions and the [**CB\_DIR**](cb-dir.md) message are similar to the [**DlgDirList**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlista) and [**DlgDirSelectEx**](/windows/desktop/api/Winuser/nf-winuser-dlgdirselectexa) functions and the [**LB\_DIR**](lb-dir.md) message used with list boxes.

### Data Associated with List Items

An application can associate data with the list items in a combo box. The [**CB\_SETITEMDATA**](cb-setitemdata.md) message associates a **DWORD** value with a list item, and the [**CB\_GETITEMDATA**](cb-getitemdata.md) retrieves the value associated with a list item.

The example in [Creating an Owner Drawn Combo Box](using-combo-boxes.md) uses item data to associate a constant with each item in a drop-down list box. Such a unique value identifies each item independent of its sorted position.

Other applications might use item data to associate a handle or pointer with a list item. If so, an application can process a [**WM\_DELETEITEM**](wm-deleteitem.md) message to delete or free the specified object when the list item is deleted.

### The Extended User Interface

Drop-down combo boxes and drop-down list boxes support an alternative keyboard interface called the *extended user interface*. By default, the F4 key opens or closes the list, and the DOWN ARROW changes the current selection. In a combo box with the extended user interface, however, the F4 key is disabled and pressing the DOWN ARROW key opens the drop-down list. In addition, the mouse wheel, which normally scrolls through the items in the list, does not have any function when the extended UI is set.

To select the user interface for a combo box, an application can send the [**CB\_SETEXTENDEDUI**](cb-setextendedui.md) message to the combo box. A **TRUE** value for the *wParam* parameter enables the extended user interface; a **FALSE** value sets the default user interface. To determine whether a combo box uses the extended user interface, an application can send the [**CB\_GETEXTENDEDUI**](cb-getextendedui.md) message to the combo box.

### Cue Banners

Cue banners are a new feature of edit controls and combo boxes. The purpose of a cue banner is to provide a hint to the user as to the purpose of an edit control or combo box. The following screen shot shows an edit control with the cue text "Search".

![screen shot of an edit control with the cue text "search"](images/cue-banner.png)

The text of a cue banner is displayed when an edit control has no text or a combo box has no selection. When the user enters text into the edit control or makes a selection in a combo box, the cue banner disappears. By default, the cue banner also disappears when the edit control or combo box receives focus.

## Combo Box Notifications

Messages from combo boxes are sent as notification codes in the form of [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages. The notification code is stored in the high word of the *wParam* parameter, and an application can process the following combo box notification codes.



| Notification code                         | Description                                                                                                                                                            |
|-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [CBN\_CLOSEUP](cbn-closeup.md)           | Indicates the list in a drop-down combo box or drop-down list box is about to close.                                                                                   |
| [CBN\_DBLCLK](cbn-dblclk.md)             | Indicates the user has double-clicked a list item in a simple combo box.                                                                                               |
| [CBN\_DROPDOWN](cbn-dropdown.md)         | Indicates the list in a drop-down combo box or drop-down list box is about to open.                                                                                    |
| [CBN\_EDITCHANGE](cbn-editchange.md)     | Indicates the user has changed the text in the edit control of a simple or drop-down combo box. This notification code is sent *after* the altered text is displayed.  |
| [CBN\_EDITUPDATE](cbn-editupdate.md)     | Indicates the user has changed the text in the edit control of a simple or drop-down combo box. This notification code is sent *before* the altered text is displayed. |
| [CBN\_ERRSPACE](cbn-errspace.md)         | Indicates the combo box cannot allocate enough memory to carry out a request, such as adding a list item.                                                              |
| [CBN\_KILLFOCUS](cbn-killfocus.md)       | Indicates the combo box is about to lose the input focus.                                                                                                              |
| [CBN\_SELCHANGE](cbn-selchange.md)       | Indicates the current selection has changed.                                                                                                                           |
| [CBN\_SELENDCANCEL](cbn-selendcancel.md) | Indicates that the selection made in the drop down list, while it was dropped down, should be ignored.                                                                 |
| [CBN\_SELENDOK](cbn-selendok.md)         | Indicates that the selection made drop down list, while it was dropped down, should be accepted.                                                                       |
| [CBN\_SETFOCUS](cbn-setfocus.md)         | Indicates the combo box has received the input focus.                                                                                                                  |



 

## Default Combo Box Behavior

This following table describes the messages specifically handled by the predefined COMBOBOX class window procedure.



| Message                                                       | Description                                                                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CB\_ADDSTRING**](cb-addstring.md)                         | Sends an [**LB\_ADDSTRING**](lb-addstring.md) message to the list window to add a list item.                                                                                                                                                                                                                                                                                        |
| [**CB\_DELETESTRING**](cb-deletestring.md)                   | Sends an [**LB\_DELETESTRING**](lb-deletestring.md) message to the list window to delete a list item.                                                                                                                                                                                                                                                                               |
| [**CB\_DIR**](cb-dir.md)                                     | Adds the file names matching the specified attributes and path to the list.                                                                                                                                                                                                                                                                                                          |
| [**CB\_FINDSTRING**](cb-findstring.md)                       | Sends an [**LB\_FINDSTRING**](lb-findstring.md) message to the list window. This message returns the index of the first list item that begins with the specified text.                                                                                                                                                                                                              |
| [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md)             | Sends an [**LB\_FINDSTRING**](lb-findstring.md) message to the list window. This message returns the index of the first list item exactly matching the specified text.                                                                                                                                                                                                              |
| [**CB\_GETCOUNT**](cb-getcount.md)                           | Sends an [**LB\_GETCOUNT**](lb-getcount.md) message to the list window. It returns the number of list items.                                                                                                                                                                                                                                                                        |
| [**CB\_GETCURSEL**](cb-getcursel.md)                         | Sends an [**LB\_GETCURSEL**](lb-getcursel.md) message to the list window. It returns the index of the currently selected item, if any.                                                                                                                                                                                                                                              |
| [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) | Fills the specified rectangle structure with the screen coordinates of a drop-down list.                                                                                                                                                                                                                                                                                             |
| [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md)             | Returns **TRUE** if a drop-down list is open; otherwise, it returns **FALSE**.                                                                                                                                                                                                                                                                                                       |
| [**CB\_GETDROPPEDWIDTH**](cb-getdroppedwidth.md)             | Returns the minimum allowable width, in pixels, of the drop-down list.                                                                                                                                                                                                                                                                                                               |
| [**CB\_GETEDITSEL**](cb-geteditsel.md)                       | Sends an [**EM\_GETSEL**](em-getsel.md) message to the edit control, and it returns the starting and ending position of the current selection. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                       |
| [**CB\_GETEXTENDEDUI**](cb-getextendedui.md)                 | Returns **TRUE** if the combo box is a drop-down combo box or drop-down list box and the extend user-interface flag is set; otherwise, it returns **FALSE**.                                                                                                                                                                                                                         |
| [**CB\_GETHORIZONTALEXTENT**](cb-gethorizontalextent.md)     | Sends an [**LB\_GETHORIZONTALEXTENT**](lb-gethorizontalextent.md) message to the list window. It returns the scrollable width, in pixels, of the drop-down list.                                                                                                                                                                                                                    |
| [**CB\_GETITEMDATA**](cb-getitemdata.md)                     | Sends an [**LB\_GETITEMDATA**](lb-getitemdata.md) message to the list window. It returns the value associated with the specified list item.                                                                                                                                                                                                                                         |
| [**CB\_GETITEMHEIGHT**](cb-getitemheight.md)                 | Sends an [**LB\_GETITEMHEIGHT**](lb-getitemheight.md) message to the list window. It returns the height, in pixels, of the specified owner-drawn list item.                                                                                                                                                                                                                         |
| [**CB\_GETLBTEXT**](cb-getlbtext.md)                         | Sends an [**LB\_GETTEXT**](lb-gettext.md) message to the list window. It copies the specified list text to the specified buffer.                                                                                                                                                                                                                                                    |
| [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md)                   | Sends an [**LB\_GETTEXTLEN**](lb-gettextlen.md) message to the list window. It returns the length, in **TCHARs**, of the specified list text.                                                                                                                                                                                                                                       |
| [**CB\_GETLOCALE**](cb-getlocale.md)                         | Sends an [**LB\_GETLOCALE**](lb-getlocale.md) message to the list window. It returns the current locale for the list.                                                                                                                                                                                                                                                               |
| [**CB\_GETMINVISIBLE**](cb-getminvisible.md)                 | Gets the minimum number of visible items in the drop-down list of a combo box.                                                                                                                                                                                                                                                                                                       |
| [**CB\_GETTOPINDEX**](cb-gettopindex.md)                     | Sends an [**LB\_GETTOPINDEX**](lb-gettopindex.md) message to the list window. It returns the index of the first visible item in the drop-down list.                                                                                                                                                                                                                                 |
| [**CB\_INITSTORAGE**](cb-initstorage.md)                     | Sends an [**LB\_INITSTORAGE**](lb-initstorage.md) message to the list window. It initializes space for the specified number of items and the specified number of bytes for item strings.                                                                                                                                                                                            |
| [**CB\_INSERTSTRING**](cb-insertstring.md)                   | Sends an [**LB\_INSERTSTRING**](lb-insertstring.md) message to the list window. It inserts a list item at the specified position.                                                                                                                                                                                                                                                   |
| [**CB\_LIMITTEXT**](cb-limittext.md)                         | Sends an [**EM\_LIMITTEXT**](em-limittext.md) message to the edit control. It sets the maximum number of characters a user can enter in the edit control. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                            |
| [**CB\_RESETCONTENT**](cb-resetcontent.md)                   | Sends an [**LB\_RESETCONTENT**](lb-resetcontent.md) message to the list window, and it removes the contents of the list.                                                                                                                                                                                                                                                            |
| [**CB\_SELECTSTRING**](cb-selectstring.md)                   | Sends an [**LB\_SELECTSTRING**](lb-selectstring.md) message to the list window. It selects the first list item, if any, that begins with the characters in the specified text.                                                                                                                                                                                                      |
| [**CB\_SETCURSEL**](cb-setcursel.md)                         | Sends an [**LB\_SETCURSEL**](lb-setcursel.md) message to the list window, and it sets the current selection.                                                                                                                                                                                                                                                                        |
| [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md)             | Sets the minimum allowable width, in pixels, of the drop down list.                                                                                                                                                                                                                                                                                                                  |
| [**CB\_SETEDITSEL**](cb-seteditsel.md)                       | Sends an [**EM\_SETSEL**](em-setsel.md) message to the edit control. It selects the specified range of text. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                                                         |
| [**CB\_SETEXTENDEDUI**](cb-setextendedui.md)                 | Sets or clears the extended user-interface flag. This flag changes the keys that open and close the list in a drop-down combo box or drop-down list box. If the combo box is a simple combo box, the window procedure returns CB\_ERR.                                                                                                                                               |
| [**CB\_SETHORIZONTALEXTENT**](cb-sethorizontalextent.md)     | Sends an [**LB\_SETHORIZONTALEXTENT**](lb-sethorizontalextent.md) message to the list window. It sets the scrollable width, in pixels, of the drop down list.                                                                                                                                                                                                                       |
| [**CB\_SETITEMDATA**](cb-setitemdata.md)                     | Sends an [**LB\_SETITEMDATA**](lb-setitemdata.md) message to the list window. It associates the specified value with a list item.                                                                                                                                                                                                                                                   |
| [**CB\_SETITEMHEIGHT**](cb-setitemheight.md)                 | Sends an [**LB\_SETITEMHEIGHT**](lb-setitemheight.md) message to the list window. It sets the height of the specified owner-drawn list item or the selection field.                                                                                                                                                                                                                 |
| [**CB\_SETLOCALE**](cb-setlocale.md)                         | Sends an [**LB\_SETLOCALE**](lb-setlocale.md) message to the list window, and it sets the current locale for the list. The locale affects how the list is sorted if it has the [**CBS\_SORT**](combo-box-styles.md) style and strings are added using [**CB\_ADDSTRING**](cb-addstring.md).                                                                              |
| [**CB\_SETMINVISIBLE**](cb-setminvisible.md)                 | Sets the minimum number of visible items in the drop-down list of a combo box.                                                                                                                                                                                                                                                                                                       |
| [**CB\_SETTOPINDEX**](cb-settopindex.md)                     | Sends an [**LB\_SETTOPINDEX**](lb-settopindex.md) message to the list window. It scrolls the drop-down list so the specified item is at the top of the visible range.                                                                                                                                                                                                               |
| [**CB\_SHOWDROPDOWN**](cb-showdropdown.md)                   | Shows or hides the drop-down list. This message has no effect on simple combo boxes.                                                                                                                                                                                                                                                                                                 |
| [**WM\_CHAR**](/windows/desktop/inputdev/wm-char)                              | Processes character input. In drop-down list boxes, this message is passed to the list window, which moves the selection to the first item beginning with the specified character. In simple and drop-down combo boxes, this message is passed to the edit control.                                                                                                                  |
| [**WM\_CLEAR**](/windows/desktop/dataxchg/wm-clear)                            | Deletes the edit selection. In simple and drop-down combo boxes, the edit control processes this message. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                                                             |
| [**WM\_COMMAND**](/windows/desktop/menurc/wm-command)                          | Processes notification messages from the edit control and list window and sends corresponding combo box notification codes to the parent window.                                                                                                                                                                                                                                     |
|                                                               | For edit control notifications, the window procedure may update the list window's current selection, caret index, and top index. For list notification messages, the window procedure may update the content of the selection field.                                                                                                                                                 |
| [**WM\_COMPAREITEM**](wm-compareitem.md)                     | Passes the message to the parent window, enabling the application to specify the relative sort position of two owner-drawn list items. The combo box window receives this message from the list window.                                                                                                                                                                              |
| [**WM\_COPY**](/windows/desktop/dataxchg/wm-copy)                              | Copies the edit selection to the clipboard. In simple and drop-down combo boxes, the edit control processes this message. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                                             |
| [**WM\_CREATE**](/windows/desktop/winmsg/wm-create)                            | Initializes the combo box.                                                                                                                                                                                                                                                                                                                                                           |
| [**WM\_CUT**](/windows/desktop/dataxchg/wm-cut)                                | Deletes the edit selection and places it on the clipboard. In simple and drop-down combo boxes, the edit control processes this message. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                              |
| [**WM\_DELETEITEM**](wm-deleteitem.md)                       | Passes the message to the parent window, notifying the application that a list item has been deleted. The combo box window receives this message from the list window.                                                                                                                                                                                                               |
| [**WM\_DRAWITEM**](wm-drawitem.md)                           | Passes the message on to the parent window enabling the application to paint the specified list item. The combo box window receives this message from the list window. The window procedure can also originate this message to have the application paint the selection field of a drop-down list box.                                                                               |
| [**WM\_ENABLE**](/windows/desktop/winmsg/wm-enable)                            | Sets the state to enable or prohibit mouse and keyboard input.                                                                                                                                                                                                                                                                                                                       |
| [**WM\_ERASEBKGND**](/windows/desktop/winmsg/wm-erasebkgnd)                    | Returns 1, indicating that the background is erased.                                                                                                                                                                                                                                                                                                                                 |
| [**WM\_GETDLGCODE**](/windows/desktop/dlgbox/wm-getdlgcode)                    | Returns a combination of the DLG\_WANTCHARS and DLGC\_WANTARROWS values.                                                                                                                                                                                                                                                                                                             |
| [**WM\_GETFONT**](/windows/desktop/winmsg/wm-getfont)                          | Returns the handle to the current font with which the combo box will draw its text.                                                                                                                                                                                                                                                                                                  |
| [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext)                          | Copies the contents of the selection field to the specified buffer. In simple and drop-down combo boxes, the edit control processes this message.                                                                                                                                                                                                                                    |
| [**WM\_GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength)              | Returns the length, in characters, of the text in the selection field. In simple and drop-down combo boxes, the edit control processes this message.                                                                                                                                                                                                                                 |
| [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown)                        | Processes noncharacter keyboard input. In drop-down list boxes, this message is sent to the list window, which may show or hide itself, or change its current selection or caret index. In simple and drop-down combo boxes, this message is passed to the edit control. The edit control passes certain keys to the list window, such as the UP and DOWN ARROW keys and the F4 key. |
| [**WM\_KILLFOCUS**](/windows/desktop/inputdev/wm-killfocus)                    | Hides the highlight in the selection field and closes the drop-down list, if necessary. If the window receiving the input focus is part of the combo box (for example, the edit control), this message is ignored.                                                                                                                                                                   |
| [**WM\_LBUTTONDBLCLK**](/windows/desktop/inputdev/wm-lbuttondblclk)            | Same as [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown).                                                                                                                                                                                                                                                                                                                              |
| [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown)                | Sets the focus to the combo box and, for drop-down combo boxes and drop-down lists, can open or close the list. If it opens the list, the window procedure captures the mouse to enable selection by dragging and releasing the mouse button.                                                                                                                                        |
| [**WM\_LBUTTONUP**](/windows/desktop/inputdev/wm-lbuttonup)                    | Releases the mouse capture if the mouse opened the list.                                                                                                                                                                                                                                                                                                                             |
| [**WM\_MEASUREITEM**](wm-measureitem.md)                     | Posts the message to the parent window, enabling the application to modify the contents of the specified [**MEASUREITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-measureitemstruct) structure. The combo box window receives this message from the list window.                                                                                                                                                  |
| [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove)                    | Posts the message to the list window if the mouse has opened the list and the mouse button is still down. This enables a user to select an item by dragging the mouse pointer to a list item and then releasing the button.                                                                                                                                                          |
| [**WM\_NCCREATE**](/windows/desktop/winmsg/wm-nccreate)                        | Allocates an internal data structure used by the combo box window procedure.                                                                                                                                                                                                                                                                                                         |
| [**WM\_NCDESTROY**](/windows/desktop/winmsg/wm-ncdestroy)                      | Frees resources allocated in response to the [**WM\_NCCREATE**](/windows/desktop/winmsg/wm-nccreate) message.                                                                                                                                                                                                                                                                                         |
| [**WM\_PAINT**](/windows/desktop/gdi/wm-paint)                                 | Paints the invalid region of the combo box. If *wParam* is not **NULL**, it is assumed to be a device context (DC) handle passed from a subclass function. The window procedure uses the specified DC instead of calling [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) and [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint).                                                                                          |
| [**WM\_PASTE**](/windows/desktop/dataxchg/wm-paste)                            | Replaces the edit selection with the contents of the clipboard. In simple and drop-down combo boxes, the edit control processes this message. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                         |
| [**WM\_SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)                      | Sets the focus to the edit control or, in drop-down list boxes, inverts the selection field and turns on the caret in the list window.                                                                                                                                                                                                                                               |
| [**WM\_SETFONT**](/windows/desktop/winmsg/wm-setfont)                          | Saves the specified font handle in an internal structure, adjusts the dimensions of the selection field and list, and invalidates the combo box window. Text in the selection field and the list is displayed in the saved font.                                                                                                                                                     |
| [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw)                         | Sets or clears the redraw flag. If the redraw flag is cleared, the combo box is not repainted until the flag is set again.                                                                                                                                                                                                                                                           |
| [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext)                          | Sets the contents of the edit control. In simple and drop-down combo boxes, the edit control processes this message. In drop-down list boxes, the window procedure returns CB\_ERR.                                                                                                                                                                                                  |
| [**WM\_SIZE**](/windows/desktop/winmsg/wm-size)                                | Resizes the child windows, if necessary.                                                                                                                                                                                                                                                                                                                                             |
| [**WM\_SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown)                  | Opens or closes the drop-down list depending on which arrow key the user pressed.                                                                                                                                                                                                                                                                                                    |



 

All other messages are passed to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function for default processing.

 

 