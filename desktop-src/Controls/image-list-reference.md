---
title: Image Lists
description: This section contains information about the programming elements used with image lists.
ms.assetid: 8a2bdc59-747c-47bb-b125-9b0b97af205e
ms.topic: article
ms.date: 05/31/2018
---

# Image Lists

This section contains information about the programming elements used with image lists.

### Overviews



| Topic                          | Contents                                                                                                            |
|--------------------------------|---------------------------------------------------------------------------------------------------------------------|
| [Image Lists](image-lists.md) | An image list is a collection of images of the same size, each of which can be referred to by its index.<br/> |



 

### Functions



| Topic                                                                 | Contents                                                                                                                                                                                                                                                                             |
|-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**HIMAGELIST\_QueryInterface**](/windows/desktop/api/Commctrl/nf-commctrl-himagelist_queryinterface)       | Retrieves a pointer to an [**IImageList**](/windows/desktop/api/CommonControls/nn-commoncontrols-iimagelist) or [**IImageList2**](/windows/desktop/api/Commoncontrols/nn-commoncontrols-iimagelist2) object that corresponds to the image list's HIMAGELIST handle.<br/>                                                                                                           |
| [**ImageList\_Add**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_add)                               | Adds an image or images to an image list. <br/>                                                                                                                                                                                                                                |
| [**ImageList\_AddMasked**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_addmasked)                   | Adds an image or images to an image list, generating a mask from the specified bitmap.<br/>                                                                                                                                                                                    |
| [**ImageList\_BeginDrag**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_begindrag)                   | Begins dragging an image. <br/>                                                                                                                                                                                                                                                |
| [**ImageList\_CoCreateInstance**](/windows/desktop/api/CommonControls/nf-commoncontrols-imagelist_cocreateinstance)     | Creates a single instance of an imagelist and returns an interface pointer to it.<br/>                                                                                                                                                                                         |
| [**ImageList\_Copy**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_copy)                             | Copies images within a given image list. <br/>                                                                                                                                                                                                                                 |
| [**ImageList\_Create**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create)                         | Creates a new image list. <br/>                                                                                                                                                                                                                                                |
| [**ImageList\_Destroy**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_destroy)                       | Destroys an image list.<br/>                                                                                                                                                                                                                                                   |
| [**ImageList\_DragEnter**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_dragenter)                   | Displays the drag image at the specified position within the window. <br/>                                                                                                                                                                                                     |
| [**ImageList\_DragLeave**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_dragleave)                   | Unlocks the specified window and hides the drag image, allowing the window to be updated. <br/>                                                                                                                                                                                |
| [**ImageList\_DragMove**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_dragmove)                     | Moves the image that is being dragged during a drag-and-drop operation. This function is typically called in response to a [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) message. <br/>                                                                                           |
| [**ImageList\_DragShowNolock**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_dragshownolock)         | Shows or hides the image being dragged. <br/>                                                                                                                                                                                                                                  |
| [**ImageList\_Draw**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_draw)                             | Draws an image list item in the specified device context. <br/>                                                                                                                                                                                                                |
| [**ImageList\_DrawEx**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_drawex)                         | Draws an image list item in the specified device context. The function uses the specified drawing style and blends the image with the specified color. <br/>                                                                                                                   |
| [**ImageList\_DrawIndirect**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_drawindirect)             | Draws an image list image based on an [**IMAGELISTDRAWPARAMS**](/windows/win32/api/commctrl/ns-commctrl-imagelistdrawparams) structure. <br/>                                                                                                                                                                      |
| [**ImageList\_Duplicate**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_duplicate)                   | Creates a duplicate of an existing image list. <br/>                                                                                                                                                                                                                           |
| [**ImageList\_EndDrag**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_enddrag)                       | Ends a drag operation. <br/>                                                                                                                                                                                                                                                   |
| [**ImageList\_GetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_getbkcolor)                 | Retrieves the current background color for an image list. <br/>                                                                                                                                                                                                                |
| [**ImageList\_GetDragImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_getdragimage)             | Retrieves the temporary image list that is used for the drag image. The function also retrieves the current drag position and the offset of the drag image relative to the drag position. <br/>                                                                                |
| [**ImageList\_GetIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_geticon)                       | Creates an icon from an image and mask in an image list. <br/>                                                                                                                                                                                                                 |
| [**ImageList\_GetIconSize**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_geticonsize)               | Retrieves the dimensions of images in an image list. All images in an image list have the same dimensions. <br/>                                                                                                                                                               |
| [**ImageList\_GetImageCount**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_getimagecount)           | Retrieves the number of images in an image list. <br/>                                                                                                                                                                                                                         |
| [**ImageList\_GetImageInfo**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_getimageinfo)             | Retrieves information about an image. <br/>                                                                                                                                                                                                                                    |
| [**ImageList\_LoadImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_loadimagea)                   | Creates an image list from the specified bitmap.<br/>                                                                                                                                                                                                                          |
| [**ImageList\_Merge**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_merge)                           | Creates a new image by combining two existing images. The function also creates a new image list in which to store the image. <br/>                                                                                                                                            |
| [**ImageList\_Read**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_read)                             | Reads an image list from a stream. <br/>                                                                                                                                                                                                                                       |
| [**ImageList\_ReadEx**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_readex)                         | Reads an image list from a stream, and returns an interface to the image list. <br/>                                                                                                                                                                                           |
| [**ImageList\_Remove**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_remove)                         | Removes an image from an image list. <br/>                                                                                                                                                                                                                                     |
| [**ImageList\_Replace**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_replace)                       | Replaces an image in an image list with a new image. <br/>                                                                                                                                                                                                                     |
| [**ImageList\_ReplaceIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_replaceicon)               | Replaces an image with an icon or cursor.<br/>                                                                                                                                                                                                                                 |
| [**ImageList\_SetBkColor**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setbkcolor)                 | Sets the background color for an image list. This function only works if you add an icon or use [**ImageList\_AddMasked**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_addmasked) with a black and white bitmap. Without a mask, the entire image is drawn; hence the background color is not visible. <br/> |
| [**ImageList\_SetColorTable**](imagelist-setcolortable.md)           | Sets the color table for an image list.<br/>                                                                                                                                                                                                                                   |
| [**ImageList\_SetDragCursorImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setdragcursorimage) | Creates a new drag image by combining the specified image (typically a mouse cursor image) with the current drag image. <br/>                                                                                                                                                  |
| [**ImageList\_SetIconSize**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_seticonsize)               | Sets the dimensions of images in an image list and removes all images from the list. <br/>                                                                                                                                                                                     |
| [**ImageList\_SetImageCount**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setimagecount)           | Resizes an existing image list. <br/>                                                                                                                                                                                                                                          |
| [**ImageList\_SetOverlayImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setoverlayimage)       | Adds a specified image to the list of images to be used as overlay masks. An image list can have up to four overlay masks in version 4.70 and earlier and up to 15 in version 4.71. The function assigns an overlay mask index to the specified image. <br/>                   |
| [**ImageList\_Write**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_write)                           | Writes an image list to a stream. <br/>                                                                                                                                                                                                                                        |
| [**ImageList\_WriteEx**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_writeex)                       | Writes an image list to a stream. <br/>                                                                                                                                                                                                                                        |



 

### Macros



| Topic                                                   | Contents                                                                                                                                                                         |
|---------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**ImageList\_AddIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_addicon)         | Adds an icon or cursor to an image list. [**ImageList\_AddIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_addicon) calls the [**ImageList\_ReplaceIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_replaceicon) function. <br/> |
| [**ImageList\_ExtractIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_extracticon) | Calls the [**ImageList\_GetIcon**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_geticon) function to create an icon or cursor based on an image and mask in an image list. <br/>                          |
| [**ImageList\_LoadBitmap**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_loadbitmap)   | Calls the [**ImageList\_LoadImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_loadimagea) function to create an image list from the specified bitmap resource. <br/>                                   |
| [**ImageList\_RemoveAll**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_removeall)     | Calls the [**ImageList\_Remove**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_remove) function to remove all of the images from an image list. <br/>                                                     |
| [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask)        | Prepares the index of an overlay mask so that the [**ImageList\_Draw**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_draw) function can use it. <br/>                                                     |



 

### Interfaces



| Topic                            | Contents                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IImageList**](/windows/desktop/api/CommonControls/nn-commoncontrols-iimagelist) | Exposes methods that manipulate and interact with image lists. <br/> To use [**IImageList**](/windows/desktop/api/CommonControls/nn-commoncontrols-iimagelist), specify Comctl32.dll version 6 in the manifest. If you do not do this, Comctl32.dll version 5 will be used by default, with which **IImageList** could display unpredictable behavior. For more information on manifests, see [Enabling Visual Styles](cookbook-overview.md).<br/> |



 

### Methods



| Topic                                                       | Contents                                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Add**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-add)                               | Adds an image or images to an image list.<br/>                                                                                                                                                                                                                                                                |
| [**AddMasked**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-addmasked)                   | Adds an image or images to an image list, generating a mask from the specified bitmap. <br/>                                                                                                                                                                                                                  |
| [**BeginDrag**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-begindrag)                   | Begins dragging an image. <br/>                                                                                                                                                                                                                                                                               |
| [**Clone**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-clone)                           | Clones an existing image list. <br/>                                                                                                                                                                                                                                                                          |
| [**Copy**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-copy)                             | Copies images from a given image list. <br/>                                                                                                                                                                                                                                                                  |
| [**DragEnter**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-dragenter)                   | Locks updates to the specified window during a drag operation and displays the drag image at the specified position within the window. <br/>                                                                                                                                                                  |
| [**DragLeave**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-dragleave)                   | Unlocks the specified window and hides the drag image, which enables the window to update. <br/>                                                                                                                                                                                                              |
| [**DragMove**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-dragmove)                     | Moves the image that is being dragged during a drag-and-drop operation. This function is typically called in response to a [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) message. <br/>                                                                                                                          |
| [**DragShowNolock**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-dragshownolock)         | Shows or hides the image being dragged. <br/>                                                                                                                                                                                                                                                                 |
| [**Draw**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-draw)                             | Draws an image list item in the specified device context. <br/>                                                                                                                                                                                                                                               |
| [**EndDrag**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-enddrag)                       | Ends a drag operation. <br/>                                                                                                                                                                                                                                                                                  |
| [**GetBkColor**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getbkcolor)                 | Gets the current background color for an image list. <br/>                                                                                                                                                                                                                                                    |
| [**GetDragImage**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getdragimage)             | Gets the temporary image list that is used for the drag image. The function also retrieves the current drag position and the offset of the drag image relative to the drag position. <br/>                                                                                                                    |
| [**GetIcon**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-geticon)                       | Creates an icon from an image and a mask in an image list. <br/>                                                                                                                                                                                                                                              |
| [**GetIconSize**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-geticonsize)               | Gets the dimensions of images in an image list. All images in an image list have the same dimensions. <br/>                                                                                                                                                                                                   |
| [**GetImageCount**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getimagecount)           | Gets the number of images in an image list. <br/>                                                                                                                                                                                                                                                             |
| [**GetImageInfo**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getimageinfo)             | Gets information about an image. <br/>                                                                                                                                                                                                                                                                        |
| [**GetImageRect**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getimagerect)             | Gets an image's bounding rectangle. <br/>                                                                                                                                                                                                                                                                     |
| [**GetItemFlags**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getitemflags)             | Gets the flags of an image.<br/>                                                                                                                                                                                                                                                                              |
| [**GetOverlayImage**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getoverlayimage)       | Retrieves a specified image from the list of images used as overlay masks. <br/>                                                                                                                                                                                                                              |
| [**Merge**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-merge)                           | Creates a new image by combining two existing images. This method also creates a new image list in which to store the image. <br/>                                                                                                                                                                            |
| [**Remove**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-remove)                         | Removes an image from an image list. <br/>                                                                                                                                                                                                                                                                    |
| [**Replace**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-replace)                       | Replaces an image in an image list with a new image.<br/>                                                                                                                                                                                                                                                     |
| [**ReplaceIcon**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-replaceicon)               | Replaces an image with an icon or cursor. <br/>                                                                                                                                                                                                                                                               |
| [**SetBkColor**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-setbkcolor)                 | Sets the background color for an image list. This method only functions if you add an icon to the image list or use the [**IImageList::AddMasked**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-addmasked) method to add a black and white bitmap. Without a mask, the entire image draws, and the background color is not visible. <br/>  |
| [**SetDragCursorImage**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-setdragcursorimage) | Creates a new drag image by combining the specified image, which is typically a mouse cursor image, with the current drag image. <br/>                                                                                                                                                                        |
| [**SetIconSize**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-seticonsize)               | Sets the dimensions of images in an image list and removes all images from the list. <br/>                                                                                                                                                                                                                    |
| [**SetImageCount**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-setimagecount)           | Resizes an existing image list. <br/>                                                                                                                                                                                                                                                                         |
| [**SetOverlayImage**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-setoverlayimage)       | Adds a specified image to the list of images used as overlay masks. An image list can have up to four overlay masks in Common Controls [version 4.70](common-control-versions.md) and earlier, and up to 15 in version 4.71 or later. The method assigns an overlay mask index to the specified image. <br/> |



 

### Structures



| Topic                                              | Contents                                                                                                                                                                |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMAGEINFO**](/windows/win32/api/commctrl/ns-commctrl-imageinfo)                     | Contains information about an image in an image list. This structure is used with the [**IImageList::GetImageInfo**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-getimageinfo) function. <br/> |
| [**IMAGELISTDRAWPARAMS**](/windows/win32/api/commctrl/ns-commctrl-imagelistdrawparams) | Contains information about an image list draw operation and is used with the [**IImageList::Draw**](/windows/desktop/api/CommonControls/nf-commoncontrols-iimagelist-draw) function. <br/>                          |



 

 

